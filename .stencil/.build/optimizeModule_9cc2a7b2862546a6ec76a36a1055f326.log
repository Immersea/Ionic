import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s}from"./p-5d4a8e1f.js";import{l as d}from"./p-1af05547.js";import{S as o,a1 as r,t as n}from"./p-30358c9d.js";import{S as p}from"./p-a75993af.js";import{E as f}from"./p-a9f4af61.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-2578d979.js";import"./p-7ee16e8d.js";const c="modal-dive-certification-update ion-list{width:100%}";const l=c;const h=class{constructor(t){e(this,t);this.agencyId=undefined;this.diveCertification=undefined;this.validCert=false;this.newCert=false;this.updateView=false;this.titles=[{tag:"details"},{tag:"schedule"}];this.slider=undefined}async componentWillLoad(){this.newCert=!this.diveCertification.id;this.certGroups=o.systemPreferences.selectOptions.certificationGroups;if(this.diveCertification.activities)this.diveCertification.activities=this.diveCertification.activities.map((e=>{if(e.divePlan)e.divePlan=new r(e.divePlan);return e}))}async componentDidLoad(){this.slider=new p(".slider-dive-cert",{speed:400,spaceBetween:100,allowTouchMove:true,autoHeight:true});this.validateCert()}handleCertChange(e){if(e.detail.name=="maxDepth"||e.detail.name=="numberOfStudents"){this.diveCertification[e.detail.name]=d.exports.toNumber(e.detail.value)}else{this.diveCertification[e.detail.name]=e.detail.value}this.validateCert()}updateCertGroup(e){this.diveCertification.group=e;this.validateCert()}uniqueIdValid(e){this.validCert=this.validCert&&e.detail}updateImageUrls(e){const t=e.detail.type;const a=e.detail.url;if(t=="photo"){this.diveCertification.photoURL=a}else{this.diveCertification.coverURL=a}}validateCert(){this.validCert=d.exports.isString(this.diveCertification.id)&&d.exports.isString(this.diveCertification.name)&&this.diveCertification.numberOfStudents>0&&this.diveCertification.maxDepth>0}async save(){return s.dismiss(this.diveCertification)}async cancel(){return s.dismiss()}render(){return t(a,{key:"68fa20ee533b9a95ecd8baa7518110038cefb998"},t("ion-header",{key:"b7bfdf77e66e7dd3b25f3eef92fad58c7dd245e1"},this.diveCertification.id?t("app-upload-cover",{item:{collection:n,id:this.agencyId+"-"+this.diveCertification.id,photoURL:this.diveCertification.photoURL,coverURL:this.diveCertification.coverURL},onCoverUploaded:e=>this.updateImageUrls(e)}):undefined),t("app-header-segment-toolbar",{key:"b12ea638f9cbfa7f6d01b39bf1944cf77f39d50f",color:f.getAppColor(),swiper:this.slider,titles:this.titles}),t("ion-content",{key:"f0ebc6b2c2d75415cadcd47d60a4370723d774b3",class:"slides"},t("swiper-container",{key:"ef65810c3f871d0d0f16348e6fd94d17822f8b76",class:"slider-dive-cert swiper"},t("swiper-wrapper",{key:"68bde78882eb586114d94e6db5d444d86f0d3bbf",class:"swiper-wrapper"},t("swiper-slide",{key:"d1f02752bc46847c391798926661e061056f7970",class:"swiper-slide"},t("ion-list",{key:"d4f46379993b102e17b44b43cf0b4879996a4367"},t("app-form-item",{key:"7389a36fc9505246b78f6a833fdfb4ab255e8bf9","label-tag":"unique-id","label-text":"Unique ID",value:this.diveCertification.id,disabled:!this.newCert,name:"id","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),onIsValid:e=>this.uniqueIdValid(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"e4701499fb5bc91f7e3d8df3f1d1e46dd5f27a21","label-tag":"name","label-text":"Name",value:this.diveCertification.name,name:"name","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"f9d8adb57ab04a8166d755d2f492e96d5380c6eb","label-tag":"max-depth","label-text":"Max. Depth",value:d.exports.toString(this.diveCertification.maxDepth),name:"maxDepth","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"c29d875b2185ac0ab6d1d81ba9c128895bacfe40","label-tag":"max-students","label-text":"Max. number of students",value:d.exports.toString(this.diveCertification.numberOfStudents),name:"numberOfStudents","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("ion-item",{key:"f29a91b20add74b08d0096117be80bdae53da2ee"},t("ion-label",{key:"a844bfb8bfb94ae94d0622c356e224aa33448e4f"},"Certification Group"),t("ion-select",{key:"89c4aa14e89eded806fa3c51095c41d03c9b55ed",value:this.diveCertification.group,onIonChange:e=>this.updateCertGroup(e.detail.value),interface:"popover"},this.certGroups.map((e=>t("ion-select-option",{value:e.tag},e.text))))))),t("swiper-slide",{key:"c3528ee26e8ae202b27e3ea721aacaedc6b9b67e",class:"swiper-slide"},t("app-dive-course-activities",{key:"f233e3217464ac7a547ee2e6eb8cae814b053efb",schedule:this.diveCertification.activities,showDiveLocation:false,onScheduleEmit:e=>this.diveCertification.activities=e.detail,editable:true}))))),t("app-modal-footer",{key:"fe649a0a9db6f126983d3a02a8adc9d8be0a6c91",disableSave:!this.validCert,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};h.style=l;export{h as modal_dive_certification_update};