import{r as t,h as e,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{ah as c,ak as o,S as d,T as f}from"./p-30358c9d.js";import{E as l}from"./p-a9f4af61.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-2578d979.js";import"./p-7ee16e8d.js";const r="modal-project-quantityunit ion-list{width:100%}";const h=r;const b=class{constructor(e){t(this,e);this.index=0;this.quantityUnits=undefined;this.quantityUnit=undefined;this.updateView=true;this.validQuantityUnit=false}async componentWillLoad(){await this.loadQuantityUnits()}async loadQuantityUnits(){await c.downloadProjectSettings();this.quantityUnits=n.exports.cloneDeep(c.getQuantityUnits());if(this.quantityUnits&&this.quantityUnits.length>0){this.quantityUnit=this.quantityUnits[0]}else{this.addQuantityUnit()}this.validateProject()}selectType(t){this.quantityUnit=this.quantityUnits[t.detail.value];this.validateProject()}handleChange(t){const e=t.detail.name;let i=t.detail.value;if(e=="familyId"){i=i.replace(/\s+/g,"-").trim().toLowerCase()}this.quantityUnit[e]=i;this.validateProject()}validateProject(){this.validQuantityUnit=n.exports.isString(this.quantityUnit.quantityUnitId)&&n.exports.isString(this.quantityUnit.quantityUnitId);this.updateView=!this.updateView}addQuantityUnit(){this.quantityUnit=new o;this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}duplicateQuantityUnit(){this.quantityUnit=n.exports.cloneDeep(this.quantityUnit);this.quantityUnit.quantityUnitId=this.quantityUnit.quantityUnitId+"_rev.";this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}async deleteQuantityUnit(){try{this.quantityUnits.splice(this.index,1);this.index=0;this.quantityUnit=this.quantityUnits[0];this.validateProject()}catch(t){if(t)d.presentAlertError(t)}}async save(t=true){await c.uploadProjectSettings("quantityUnit",this.quantityUnits);return t?s.dismiss():true}async cancel(){return s.dismiss()}render(){return e(i,{key:"76e500a512bedad006fb2b618a5375e2bd428ca5"},e("ion-content",{key:"f0e646637dccf2271c8fff1934cf913058cdb0dd"},e("ion-grid",{key:"97c3e82f0485638296aeb94f62f8a7f34c6dc333"},e("ion-row",{key:"44a456e53be315fe86f9512a8b3a063ff1bf2deb"},e("ion-col",{key:"e62de1914077f05b686369e7fd23424a2d9619e7"},e("ion-item",{key:"a8ff9aca74f2a355161ac1f496d29f1140d7e842",lines:"none"},e("ion-select",{key:"92b33edaafabcf3665b8f0bcaff5c23f467efcbd",color:"trasteel",id:"selectType",interface:"action-sheet",label:f.getTransl("project_quantityunit","Project Quantity Unit"),disabled:!this.validQuantityUnit,"label-placement":"floating",onIonChange:t=>this.selectType(t),value:this.index?this.index:0},this.quantityUnits.map(((t,i)=>e("ion-select-option",{value:i},t.quantityUnitId+" | "+t.quantityUnitName.en)))))),e("ion-col",{key:"497090e730e0b79f96bd2640e1ca8fbc705ffd31",size:"1",class:"ion-text-center"},e("ion-button",{key:"7d4aa297707116576bf1fe80b233b28519f8f5b1",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.addQuantityUnit()},e("ion-icon",{key:"899cd57a6f6f25db752c3437fd7c7f9ce03de940",name:"add",slot:"start"}))),e("ion-col",{key:"f96919f9f7e35ee6f1c13dbfa27bc74f21782070",size:"1",class:"ion-text-center"},e("ion-button",{key:"95d6c6ebaf858fe98d0b4ca5cd87a1dfef1da3d6",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.duplicateQuantityUnit()},e("ion-icon",{key:"cfc7cd45d499895e7a2927fc1348babfb0971dcd",slot:"start",name:"duplicate"}))),e("ion-col",{key:"e45884b49c97ca8cd9d34b36d82e71f66a208ee7",size:"1",class:"ion-text-center"},e("ion-button",{key:"3ee65d36a2d46f031d3edf384f5bdcfecdacf486",fill:"clear",color:"danger",disabled:this.quantityUnits.length==0,onClick:()=>this.deleteQuantityUnit()},e("ion-icon",{key:"3237ac8fbefdab625c366a1662edb6bfcd5bf2bd",slot:"start",name:"trash"}))))),e("app-form-item",{key:"271bd53f7f6bda4df224c31125312869543e7c2a","label-text":"ID",value:this.quantityUnit.quantityUnitId,name:"quantityUnitId","input-type":"string",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required",{name:"uniqueid",options:{type:"list",index:"quantityUnitId",list:c.getQuantityUnits()}}]}),e("app-form-item",{key:"c7dc5b2db55e4ef21fa22c0503051f6b3624c83a","label-text":"Name",value:this.quantityUnit.quantityUnitName,name:"quantityUnitName","input-type":"text",multiLanguage:true,"text-rows":"1",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required"]})),e("app-modal-footer",{key:"b1baa1be1cd63dbcd2b5b4dc5b315a6ed4ec0534",color:l.getAppColor(),disableSave:!this.validQuantityUnit,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};b.style=h;export{b as modal_project_quantityunit};