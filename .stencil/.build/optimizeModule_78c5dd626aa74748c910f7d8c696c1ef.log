import{r as e,h as i}from"./p-cbe60c68.js";import{U as t,S as n,R as a,T as s,aR as c,q as o,m as l,aU as r,a4 as d,aF as h,a7 as u,p as f,ax as p,aS as b,a5 as m}from"./p-30358c9d.js";import{U as g,C as k}from"./p-7ee16e8d.js";import"./p-c7ee7cfe.js";import{b as y}from"./p-5d4a8e1f.js";import{l as w}from"./p-1af05547.js";import{B as x}from"./p-95685f30.js";import"./p-2578d979.js";import"./p-e9c4f463.js";import"./p-a9f4af61.js";import"./p-694b8ade.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const v="app-user-cards{width:100%}app-user-cards .card-margins{margin:10px 5px 5px 10px}";const C=v;const T=class{constructor(i){e(this,i);this.updateSlider=undefined;this.userCards=undefined;this.updateView=true;this.sysPref=undefined}async componentWillLoad(){this.userCardsSub$=t.userCards$.subscribe((e=>{this.userCards=new g(e);this.updateView=!this.updateView;this.updateSlider()}));this.sysPref=await n.getSystemPreferences()}componentDidLoad(){if(!this.userCards){t.initLocalUser()}}disconnectedCallback(){this.userCardsSub$.unsubscribe()}async addCard(e){const i=await a.openModal("modal-dive-card",{card:this.userCards.cards[e]?this.userCards.cards[e]:new k});i.onDidDismiss().then((i=>{i=i.data;if(i){if(this.userCards.cards[e]){this.userCards.cards[e]=new k(i)}else{this.userCards.cards.push(new k(i))}this.save()}}))}async removeCard(e,i){e.stopPropagation();const t=await y.create({header:s.getTransl("delete-card-header","Delete Dive Card?"),message:s.getTransl("delete-card-message","This dive card will be deleted! Are you sure?"),buttons:[{text:s.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:s.getTransl("ok","OK"),handler:()=>{this.userCards.cards.splice(i,1);this.save()}}]});t.present()}save(){t.updateUserCards(this.userCards);this.updateSlider()}render(){return i("div",{key:"cefbeed4f5adbdd091ad4e38af99a441c65a58b6",class:"slider-container"},i("div",{key:"f043d68f979cda50386bb1d90a1965fd71eec550",class:"slider-scrollable-container"},i("ion-grid",{key:"4ba0a85c224ac47267aee4c1bd5521871cc5e3cb",class:"ion-no-padding"},i("ion-row",{key:"73e42bc20195fb4a6a5dbd3edec415e0dcb2b3ab",class:"ion-text-start ion-no-padding"},this.userCards&&this.userCards.cards.length>0?this.userCards.cards.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding"},i("ion-card",{onClick:()=>this.addCard(t),class:"card-margins"},e.imgFront?i("img",{src:e.imgFront}):undefined,i("ion-card-header",null,i("ion-card-subtitle",null,i("ion-item",{class:"ion-no-padding",lines:"none"},i("ion-button",{"icon-only":true,slot:"end",color:"danger",fill:"clear",onClick:e=>this.removeCard(e,t)},i("ion-icon",{name:"trash-bin-outline"})),i("ion-label",null,i("h2",null,e.course.certificationId))),e.course.agencyName)),i("ion-card-content",null,e.number?i("p",null,"#",e.number):undefined,e.instructor?i("p",null,i("my-transl",{tag:"instructor",text:"Instructor"}),":"," ",e.instructor):undefined,e.certified?i("p",null,i("my-transl",{tag:"certified",text:"Certified"}),":"," ",c(e.certified,"date")):undefined,e.expiry?i("p",null,i("my-transl",{tag:"expiry",text:"Expiry"}),":"," ",c(e.expiry,"date")):undefined,e.comments?i("p",null,i("my-transl",{tag:"comments",text:"Comments"}),":"," ",e.comments):undefined))))):undefined,i("ion-col",{key:"2018cd7b9261c511780e65243fde3bcb6a9cd6a3","size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding"},i("ion-card",{key:"9b8671920a930e995173de992b9c8d32546ea436",onClick:()=>this.addCard()},i("ion-card-content",{key:"3e66bb14e1b7d12cc0519c9c3f0bfa7a5beb4d27",class:"ion-text-center"},i("ion-icon",{key:"3337e1b4a647502e42054066e1e4160d046631e7",name:"add-circle-outline",style:{fontSize:"100px"}}))))))))}};T.style=C;const z="app-user-configurations{width:100%}app-user-configurations .card-margins{margin:10px 5px 5px 10px}";const D=z;const j=class{constructor(i){e(this,i);this.stdConfigurations=[];this.userConfigurations=[]}componentWillLoad(){this.userSub$=t.userSettings$.subscribe((e=>{this.userSettings=new o(e);this.loadData()}))}componentDidLoad(){if(!this.userSettings){t.initLocalUser()}}async loadData(){if(!this.userSettings){this.userSettings=new o(await l.getLocalDocument(r))}this.stdConfigurations=d.getStdConfigurations();if(this.userSettings){this.userConfigurations=this.userSettings.userConfigurations}else{const e=await l.getLocalDocument("localconfigurations");if(e){this.stdConfigurations=[];e.forEach((e=>{const i=new h(e);this.userConfigurations.push(i)}))}else{this.userConfigurations=d.getDivePlansFromConfigurations(this.stdConfigurations);l.saveLocalDocument("localconfigurations",this.userConfigurations)}}}disconnectedCallback(){this.userSub$.unsubscribe()}async viewConfiguration(e){const i=await t.checkLicence("configs",true);if(i){const i=w.exports.cloneDeep(this.userConfigurations[e]);const t=new u;t.setConfiguration(i);const n=await a.openModal("modal-dive-configuration",{diveDataToShare:{divePlan:t}});n.onDidDismiss().then((i=>{i=i.data;if(i){this.userConfigurations[e]=new h(i);this.save()}}))}}async removeConfiguration(e,i){e.stopPropagation();const n=await t.checkLicence("configs",true);if(n){const e=await y.create({header:s.getTransl("delete-configuration-header","Delete configuration?"),message:s.getTransl("delete-configuration-message","This configuration will be deleted! Are you sure?"),buttons:[{text:s.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:s.getTransl("ok","OK"),handler:()=>{this.userConfigurations.splice(i,1);this.save()}}]});e.present()}}async addConfiguration(){const e=await t.checkLicence("configs",true);if(e){let e=[];w.exports.forEach(this.stdConfigurations,((i,t)=>{e.push({type:"radio",label:i.stdName+" (standard)",value:i,checked:t==0?true:false})}));w.exports.forEach(this.userConfigurations,(i=>{e.push({type:"radio",label:i.stdName,value:i,checked:false})}));const i=await y.create({header:s.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:s.getTransl("ok","OK"),handler:async e=>{let i=await t.checkLicence("configs",true);if(i){const i=new h(e);const t=new u;t.setConfiguration(i);const n=await a.openModal("modal-dive-configuration",{diveDataToShare:{divePlan:t}});n.onDidDismiss().then((e=>{e=e.data;if(e){this.userConfigurations.push(new h(e));this.save()}}))}}},{text:s.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});i.present()}}save(){t.updateUserConfigurations(this.userConfigurations)}render(){return i("div",{key:"46b0ef9d8f296206a74db4da6c48ccb396e2ff1a",class:"slider-container"},i("div",{key:"3c308462f73a52389cf933aaf02a47119f9c5e00",class:"slider-scrollable-container"},i("ion-grid",{key:"b35b850c59aa42981783e0f04d2014b91c1f6215",class:"ion-no-padding"},i("ion-row",{key:"7bd744c49ae275e2f7b92856a40fa670bf9b257d",class:"ion-text-start ion-no-padding"},this.userConfigurations.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding"},i("ion-card",{onClick:()=>this.viewConfiguration(t),class:"card-margins"},i("ion-card-header",null,i("ion-item",{class:"ion-no-padding",lines:"none"},i("ion-button",{"icon-only":true,slot:"end",color:"danger",fill:"clear",onClick:e=>this.removeConfiguration(e,t)},i("ion-icon",{name:"trash-bin-outline"})),i("ion-card-title",null,e.stdName)),i("ion-card-subtitle",null,i("my-transl",{tag:"max-depth",text:"Max Depth"}),":",e.maxDepth," ",e.parameters.depthUnit)),i("ion-card-content",null,e.configuration.bottom.length>0?i("p",null,i("my-transl",{tag:"bottom-tanks",text:"Bottom Tanks"}),":"):undefined,e.configuration.bottom.map((e=>i("p",null,e.name+"->"+e.gas.toString()))),e.configuration.deco.length>0?i("p",null,i("my-transl",{tag:"deco-tanks",text:"Deco Tanks"}),":"):undefined,e.configuration.deco.map((e=>i("p",null,e.name+"->"+e.gas.toString())))))))),i("ion-col",{key:"9c2b62698e5d22502fb53c521bb34fa02d73eaa6","size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding"},i("ion-card",{key:"2124485da34f87b7058f77095425139193fd5460",onClick:()=>this.addConfiguration()},i("ion-card-content",{key:"1113f6429100ce5ac6120390c8c14bdc9814ccdf",class:"ion-text-center"},i("ion-icon",{key:"ee3ee5dd9d3ee4bce3d9083aa7f199372aef16aa",name:"add-circle-outline",style:{fontSize:"100px"}}))))))))}};j.style=D;const S="app-user-licences{width:100%}";const L=S;const _=class{constructor(i){e(this,i);this.allowPurchase=true;this.userRoles=undefined;this.prices={};this.sysPref=undefined}async componentWillLoad(){this.userRolesSub$=t.userRoles$.subscribe((e=>{if(e&&e.uid){this.userRoles=new f(e)}}));this.sysPref=await n.getSystemPreferences();this.setProductPrices()}componentDidLoad(){if(!this.userRoles){t.initLocalUser()}}disconnectedCallback(){this.userRolesSub$.unsubscribe()}setProductPrices(){this.prices={rec1:{licence:"rec1",price:this.sysPref.productPrices.rec1},rec2:{licence:"rec2",price:this.sysPref.productPrices.rec2},rec3:{licence:"rec3",price:this.sysPref.productPrices.rec3},tech1:{licence:"tech1",price:this.sysPref.productPrices.tech1},tech2:{licence:"tech2",price:this.sysPref.productPrices.tech2},unlimited:{licence:"unlimited",price:this.sysPref.productPrices.unlimited}}}async showInfo(e){let i;switch(e){case"trimix":i=s.getTransl("licence-tmx-descr","This licence adds the possibility to select trimix gases in the dive plans.");break;case"tables":i=s.getTransl("licence-tables-descr","This licence shows dive plan tables with the possibility to vary the bottom time and depth.");break;case"rebreather":i=s.getTransl("licence-reb-descr","This licence adds the possibility to plan dives with CCR and pSCR rebreathers, including bailout options.");break;case"configurations":i=s.getTransl("licence-confs-descr","This licence adds the possibility to edit, add and delete dive configurations.");break;case"professional":i=s.getTransl("licence-pro-descr","This licence opens all the features of the app.");break;case"rec1":i=s.getTransl("licence-rec1-descr","This licence allows dives in the Rec1 range.");break;case"rec2":i=s.getTransl("licence-rec2-descr","This licence allows dives in the Rec2 range.");break;case"rec3":i=s.getTransl("licence-rec3-descr","This licence allows dives in the Rec3 range.");break;case"tech1":i=s.getTransl("licence-tech1-descr","This licence allows dives in the Tech1 range.");break;case"tech2":i=s.getTransl("licence-tech2-descr","This licence allows dives in the Tech2 range.");break;case"unlimited":i=s.getTransl("licence-unlimited-descr","This licence allows every kind of dive.");break}let t=[];t.push({text:s.getTransl("purchase","Purchase"),handler:()=>{this.purchase(e)}});t.push({text:s.getTransl("ok","OK")});let n=await y.create({header:s.getTransl("licence-info","Licence info"),message:i,buttons:t});n.present()}async activateTrial(){const e=this.userRoles.licences.trial.duration>0?this.userRoles.licences.trial.duration:15;let i=await y.create({header:s.getTransl("activate-trial","Start Trial"),message:s.getTransl("activate-trail-message","Do you want to start the UNLIMITED trial period of xxx days?",{xxx:e}),buttons:[{text:s.getTransl("ok","OK"),handler:async()=>{await p.startUserTrialPeriod()}},{role:"cancel",text:s.getTransl("cancel","Cancel")}]});i.present()}async purchase(e){let i=encodeURI("https://www.gue.com/store/software/decoplanner-4?uid="+t.userProfile.uid+"&email="+t.userProfile.email+"&licence="+e);await x.open({url:i})}render(){return this.userRoles&&this.userRoles.uid?i("ion-list",null,i("ion-list-header",{onClick:()=>this.purchase("unlimited")},i("my-transl",{tag:"purchase-dp4",text:"Purchase DecoPlanner 4"})),Object.keys(this.prices).map((e=>i("ion-item",null,i("ion-label",null,i("my-transl",{tag:e,text:w.exports.upperFirst(e)})),!this.userRoles.hasLicence(this.prices[e].licence,false)?[i("ion-button",{slot:"end",fill:"clear",onClick:()=>this.showInfo(e)},i("ion-icon",{name:"help-circle"}))]:i("ion-button",{slot:"end",fill:"clear"},i("ion-icon",{color:"secondary",name:"checkmark"}))))),!this.userRoles.licences.unlimited&&!this.userRoles.licences.hasLicence(this.userRoles.licences.trial.level,false)?i("ion-item",null,i("my-transl",{tag:"trial-period",text:"Trial Period",isLabel:true}),this.userRoles.licences.trial.level?i("ion-note",{slot:"end"}," ",this.userRoles.licences.trialDays()>0?i("span",null,i("my-transl",{tag:this.userRoles.licences.trial.level,text:w.exports.upperFirst(this.userRoles.licences.trial.level)})," ","- ",this.userRoles.licences.trialDays()," ",i("my-transl",{tag:"days-remaining",text:"days remaining"})):i("span",null,i("my-transl",{tag:"expired",text:"Expired"}))):i("ion-button",{slot:"end",fill:"outline",onClick:()=>this.activateTrial()},i("ion-label",null,i("my-transl",{tag:"activate-trial",text:"Start Trial"})))):undefined):undefined}};_.style=L;const O="app-user-tanks{width:100%}app-user-tanks .card-margins{margin:10px 5px 5px 10px}";const P=O;const R=class{constructor(i){e(this,i);this.stdTanks=[];this.hasUserTanks=true;this.userTanks=[]}componentWillLoad(){this.userSub$=t.userSettings$.subscribe((e=>{this.userSettings=new o(e);this.loadData()}))}componentDidLoad(){if(!this.userSettings){t.initLocalUser()}}async loadData(){if(!this.userSettings){this.userSettings=new o(await l.getLocalDocument(r))}this.userTanks=this.userSettings.userTanks;this.stdTanks=d.getStdTanks();if(w.exports.isEqual(this.userTanks,this.stdTanks))this.hasUserTanks=false}disconnectedCallback(){this.userSub$.unsubscribe()}async viewTank(e){const i=await t.checkLicence("configs",true);if(i){const i=w.exports.cloneDeep(this.userTanks[e]);const t=await a.openModal("modal-tank-configuration",{tank:i});t.onDidDismiss().then((i=>{if(i&&i.data){const t=i.data;this.userTanks[e]=new b(t);this.save()}}))}}async removeTank(e,i){e.stopPropagation();const n=await t.checkLicence("configs",true);if(n){const e=await y.create({header:s.getTransl("delete-tank-header","Delete tank?"),message:s.getTransl("delete-tank-message","This tank will be deleted! Are you sure?"),buttons:[{text:s.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:s.getTransl("ok","OK"),handler:()=>{this.userTanks.splice(i,1);this.save()}}]});e.present()}}async addTank(){const e=await t.checkLicence("configs",true);if(e){let e=[];w.exports.forEach(this.stdTanks,((i,t)=>{e.push({type:"radio",label:i.name+(this.hasUserTanks?" (standard)":""),value:i,checked:t==0?true:false})}));if(this.hasUserTanks)w.exports.forEach(this.userTanks,(i=>{e.push({type:"radio",label:i.name,value:i,checked:false})}));const i=await y.create({header:s.getTransl("select-standard-tank","Select standard tank"),buttons:[{text:s.getTransl("ok","OK"),handler:async e=>{let i=await t.checkLicence("configs",true);if(i){const i=await a.openModal("modal-tank-configuration",{tank:e});i.onDidDismiss().then((e=>{if(e&&e.data){const i=e.data;this.userTanks.push(new b(i));this.save()}}))}}},{text:s.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});i.present()}}save(){t.updateUserTanks(this.userTanks)}render(){return i("div",{key:"d0fc3bd6a6fd7e2e20086947048f3c566f603a50",class:"slider-container"},i("div",{key:"916030bad15a3b26850cfc5646c092c2c8d6439b",class:"slider-scrollable-container"},i("ion-grid",{key:"e9348014b68f55f1a4f44a35e5782d1fd79635c4",class:"ion-no-padding"},i("ion-row",{key:"972aec3ccf0ad826e49d945fd9c682a77b3168b4",class:"ion-text-start ion-no-padding"},this.userTanks.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding"},i("ion-card",{onClick:()=>this.viewTank(t),class:"card-margins"},i("ion-card-header",null,i("ion-item",{class:"ion-no-padding",lines:"none"},i("ion-button",{"icon-only":true,slot:"end",color:"danger",fill:"clear",onClick:e=>this.removeTank(e,t)},i("ion-icon",{name:"trash-bin-outline"})),i("ion-card-title",null,e.name)),i("ion-card-subtitle",null,s.getTransl("volume","Volume")+" : "+e.volume+" lt"+(this.userSettings.settings.units!="Metric"?" / "+m.ltToCuFt(e.volume)+" cuft":""))),i("ion-card-content",null,i("ion-grid",null,i("ion-row",null,i("ion-col",null,s.getTransl("no_of_tanks","Number Of Tanks")+" : "+e.no_of_tanks)),i("ion-row",null,i("ion-col",null,s.getTransl("pressure","Pressure")+" : "+e.pressure+" bar"+(this.userSettings.settings.units!="Metric"?" / "+m.barToPsi(e.pressure)+" psi":""))),e.forDeco?i("ion-row",null,i("ion-col",null,"(",s.getTransl("for-deco","For Decompression"),")")):undefined)))))),i("ion-col",{key:"2241f0f6012b55992f358fbce0583b53369a641e","size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding"},i("ion-card",{key:"ed1206810486f186da97b8a00d72da0d63a5b19a",onClick:()=>this.addTank()},i("ion-card-content",{key:"0c984f6ae67bcc10726663ea59399c8013a4c45c",class:"ion-text-center"},i("ion-icon",{key:"7da17ccdc4385b2abee4e159b295166be6b476b4",name:"add-circle-outline",style:{fontSize:"100px"}}))))))))}};R.style=P;export{T as app_user_cards,j as app_user_configurations,_ as app_user_licences,R as app_user_tanks};