import{r as e,h as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{m as s}from"./p-c2915cc5.js";import{x as t,E as c,T as o}from"./p-773bd3de.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1af05547.js";import"./p-e9c4f463.js";const a="";const l=a;const n=class{constructor(i){e(this,i);this.inProgress={};this.urls={};this.files=undefined;this.collectionId=undefined;this.itemId=undefined;this.updateView=false}uploadProgressHandler(e){const i=e.detail;if(i.state==="completed"){this.urls[this.uploadingId]=i.url;let e=true;Object.keys(this.inProgress).forEach((i=>{e=e&&this.inProgress[i].uploadProgress===100}));this.updateView=!this.updateView;if(e){s.dismiss(this.urls)}else{this.uploadMedia()}}else if(i.state==="error"){s.dismiss(false)}else{this.inProgress[this.uploadingId].uploadProgress=i.progress;this.updateView=!this.updateView}}componentDidLoad(){this.inProgress={};Object.keys(this.files).forEach((e=>{this.inProgress[e]={size:this.files[e].file.size,uploadProgress:0}}));this.uploadMedia()}async cancel(){s.dismiss(false)}uploadMedia(){let e=null;Object.keys(this.inProgress).forEach((i=>{if(this.inProgress[i].uploadProgress==0){e=i;return}}));this.uploadingId=e;const i=this.files[e].file;const s=this.files[e].media;t.uploadFile(this.collectionId,this.itemId,s,i)}render(){return[i("ion-header",{key:"887c16a8031c1ea039997a319d6b9b6eada02aa0"},i("ion-toolbar",{key:"082b42ec5e3f3fdac30fab55c979fa6f2a49ae25",color:c.getAppColor()},i("ion-title",{key:"7302255343893c55cdf8d2509b122fc9ce791a75"},o.getTransl("media-uploader","Media Uploader")))),i("ion-content",{key:"356ff63a23a105b83c6fb6b9b019a829ddb0fce6"},i("ion-list",{key:"013e84dc42f574c126cb8143b0b26cc9e3dce585"},Object.keys(this.files).map((e=>[i("ion-item",null,i("ion-label",null,i("h4",null,this.files[e].media.title),this.inProgress&&this.inProgress[e]?[i("h5",null,o.getTransl("file-size","File Size"),": ",this.inProgress[e].size),i("p",null,o.getTransl("uploaded","Uploaded"),":"," ",this.inProgress[e].uploadProgress,"%")]:undefined)),this.inProgress&&this.inProgress[e]?i("ion-progress-bar",{value:this.inProgress[e].uploadProgress}):undefined]))),i("ion-button",{key:"b4915e9bdc0133923542a7c753c9cf79f4d5cc1f",expand:"block",fill:"outline",onClick:()=>this.cancel()},i("ion-label",{key:"2307abff69063082a2cff3bf29109c32970c2f46"},o.getTransl("cancel","Cancel"))))]}};n.style=l;export{n as popover_media_uploader};