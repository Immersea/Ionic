{"version":3,"names":["modalDatasheetQualitycolorcodeCss","ModalDatasheetQualitycolorcodeStyle0","ModalDatasheetQualityColorCode","componentWillLoad","this","loadDatasheetQualityColorCodes","DatasheetsService","downloadDatasheetSettings","datasheetQualityColorCodes","cloneDeep","getDatasheetQualityColorCodes","length","datasheetQualityColorCode","addDatasheetQualityColorCode","validateDatasheet","selectType","ev","detail","value","handleChange","n","name","v","replace","trim","toLowerCase","validDatasheetQualityColorCode","isString","qualityColorCodeId","qualityColorCodePicture","updateView","DatasheetQualityColorCode","push","index","duplicateDatasheetQualityColorCode","deleteDatasheetQualityColorCode","splice","error","SystemService","presentAlertError","save","dismiss","uploadDatasheetSettings","modalController","cancel","render","h","Host","key","lines","color","id","interface","label","TranslationService","getTransl","disabled","onIonChange","map","size","class","fill","onClick","slot","onFormItemChanged","labelPosition","validator","options","type","list","Environment","getAppColor","disableSave","onCancelEmit","onSaveEmit"],"sources":["src/components/trasteel/modals/modal-datasheet-qualitycolorcode/modal-datasheet-qualitycolorcode.scss?tag=modal-datasheet-qualitycolorcode","src/components/trasteel/modals/modal-datasheet-qualitycolorcode/modal-datasheet-qualitycolorcode.tsx"],"sourcesContent":["modal-datasheet-qualitycolorcode {\n  ion-list {\n    width: 100%;\n  }\n}\n","import {Component, h, Host, State, Element} from \"@stencil/core\";\nimport {modalController} from \"@ionic/core\";\nimport {cloneDeep, isString} from \"lodash\";\nimport {TranslationService} from \"../../../../services/common/translations\";\nimport {Environment} from \"../../../../global/env\";\nimport {SystemService} from \"../../../../services/common/system\";\nimport {DatasheetQualityColorCode} from \"../../../../interfaces/trasteel/refractories/datasheets\";\nimport {DatasheetsService} from \"../../../../services/trasteel/refractories/datasheets\";\n\n@Component({\n  tag: \"modal-datasheet-qualitycolorcode\",\n  styleUrl: \"modal-datasheet-qualitycolorcode.scss\",\n})\nexport class ModalDatasheetQualityColorCode {\n  @Element() el: HTMLElement;\n  @State() index: number = 0;\n  @State() datasheetQualityColorCodes: DatasheetQualityColorCode[];\n  @State() datasheetQualityColorCode: DatasheetQualityColorCode;\n  @State() updateView = true;\n  @State() validDatasheetQualityColorCode = false;\n\n  async componentWillLoad() {\n    await this.loadDatasheetQualityColorCodes();\n  }\n\n  async loadDatasheetQualityColorCodes() {\n    await DatasheetsService.downloadDatasheetSettings();\n    this.datasheetQualityColorCodes = cloneDeep(\n      DatasheetsService.getDatasheetQualityColorCodes()\n    );\n    if (\n      this.datasheetQualityColorCodes &&\n      this.datasheetQualityColorCodes.length > 0\n    ) {\n      this.datasheetQualityColorCode = this.datasheetQualityColorCodes[0];\n    } else {\n      //create new and add to list\n      this.addDatasheetQualityColorCode();\n    }\n    this.validateDatasheet();\n  }\n\n  selectType(ev) {\n    this.datasheetQualityColorCode =\n      this.datasheetQualityColorCodes[ev.detail.value];\n    this.validateDatasheet();\n  }\n\n  handleChange(ev) {\n    const n = ev.detail.name;\n    let v = ev.detail.value;\n    if (n == \"qualityColorCodeId\") {\n      //remove spaces and lowercase\n      v = v.replace(/\\s+/g, \"-\").trim().toLowerCase();\n    }\n    this.datasheetQualityColorCode[n] = v;\n    this.validateDatasheet();\n  }\n\n  validateDatasheet() {\n    this.validDatasheetQualityColorCode =\n      isString(this.datasheetQualityColorCode.qualityColorCodeId) &&\n      isString(this.datasheetQualityColorCode.qualityColorCodePicture);\n    this.updateView = !this.updateView;\n  }\n\n  addDatasheetQualityColorCode() {\n    this.datasheetQualityColorCode = new DatasheetQualityColorCode();\n    this.datasheetQualityColorCodes.push(this.datasheetQualityColorCode);\n    this.index = this.datasheetQualityColorCodes.length - 1;\n  }\n\n  duplicateDatasheetQualityColorCode() {\n    this.datasheetQualityColorCode = cloneDeep(this.datasheetQualityColorCode);\n    this.datasheetQualityColorCode.qualityColorCodeId =\n      this.datasheetQualityColorCode.qualityColorCodeId + \"_rev.\";\n    this.datasheetQualityColorCodes.push(this.datasheetQualityColorCode);\n    this.index = this.datasheetQualityColorCodes.length - 1;\n  }\n\n  async deleteDatasheetQualityColorCode() {\n    try {\n      this.datasheetQualityColorCodes.splice(this.index, 1);\n      this.index = 0;\n      this.datasheetQualityColorCode = this.datasheetQualityColorCodes[0];\n      this.validateDatasheet();\n    } catch (error) {\n      if (error) SystemService.presentAlertError(error);\n    }\n  }\n\n  async save(dismiss = true) {\n    await DatasheetsService.uploadDatasheetSettings(\n      \"qualityColorCode\",\n      this.datasheetQualityColorCodes\n    );\n    return dismiss ? modalController.dismiss() : true;\n  }\n\n  async cancel() {\n    return modalController.dismiss();\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-content>\n          <ion-grid>\n            <ion-row>\n              <ion-col>\n                <ion-item lines=\"none\">\n                  <ion-select\n                    color=\"trasteel\"\n                    id=\"selectType\"\n                    interface=\"action-sheet\"\n                    label={TranslationService.getTransl(\n                      \"datasheet_qualityColorCode\",\n                      \"Datasheet QualityColorCode\"\n                    )}\n                    disabled={!this.validDatasheetQualityColorCode}\n                    label-placement=\"floating\"\n                    onIonChange={(ev) => this.selectType(ev)}\n                    value={this.index ? this.index : 0}\n                  >\n                    {this.datasheetQualityColorCodes.map(\n                      (datasheetQualityColorCode, index) => (\n                        <ion-select-option value={index}>\n                          {datasheetQualityColorCode.qualityColorCodeId +\n                            \" | \" +\n                            datasheetQualityColorCode.qualityColorCodePicture}\n                        </ion-select-option>\n                      )\n                    )}\n                  </ion-select>\n                </ion-item>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  disabled={!this.validDatasheetQualityColorCode}\n                  onClick={() => this.addDatasheetQualityColorCode()}\n                >\n                  <ion-icon name=\"add\" slot=\"start\" />\n                </ion-button>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  disabled={!this.validDatasheetQualityColorCode}\n                  onClick={() => this.duplicateDatasheetQualityColorCode()}\n                >\n                  <ion-icon slot=\"start\" name=\"duplicate\"></ion-icon>\n                </ion-button>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  color=\"danger\"\n                  disabled={this.datasheetQualityColorCodes.length == 0}\n                  onClick={() => this.deleteDatasheetQualityColorCode()}\n                >\n                  <ion-icon slot=\"start\" name=\"trash\"></ion-icon>\n                </ion-button>\n              </ion-col>\n            </ion-row>\n          </ion-grid>\n          <app-form-item\n            label-text=\"ID\"\n            value={this.datasheetQualityColorCode.qualityColorCodeId}\n            name=\"qualityColorCodeId\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n            labelPosition=\"fixed\"\n            validator={[\n              \"required\",\n              {\n                name: \"uniqueid\",\n                options: {\n                  type: \"list\",\n                  index: \"qualityColorCodeId\",\n                  list: DatasheetsService.getDatasheetQualityColorCodes(),\n                },\n              },\n            ]}\n          ></app-form-item>\n          <app-form-item\n            label-text=\"Name\"\n            value={this.datasheetQualityColorCode.qualityColorCodePicture}\n            name=\"qualityColorCodePicture\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n            labelPosition=\"fixed\"\n            validator={[\"required\"]}\n          ></app-form-item>\n        </ion-content>\n        <app-modal-footer\n          color={Environment.getAppColor()}\n          disableSave={!this.validDatasheetQualityColorCode}\n          onCancelEmit={() => this.cancel()}\n          onSaveEmit={() => this.save()}\n        />\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}