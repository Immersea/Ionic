import{r as e,h as t,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s}from"./p-5d4a8e1f.js";import{l as d}from"./p-1af05547.js";import{S as o,a1 as r,t as c}from"./p-341ae8a8.js";import{S as n}from"./p-a75993af.js";import{E as f}from"./p-46038295.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-1819cfda.js";import"./p-7ee16e8d.js";const p="modal-dive-certification-update ion-list{width:100%}";const l=p;const h=class{constructor(t){e(this,t);this.agencyId=undefined;this.diveCertification=undefined;this.validCert=false;this.newCert=false;this.updateView=false;this.titles=[{tag:"details"},{tag:"schedule"}];this.slider=undefined}async componentWillLoad(){this.newCert=!this.diveCertification.id;this.certGroups=o.systemPreferences.selectOptions.certificationGroups;if(this.diveCertification.activities)this.diveCertification.activities=this.diveCertification.activities.map((e=>{if(e.divePlan)e.divePlan=new r(e.divePlan);return e}))}async componentDidLoad(){this.slider=new n(".slider-dive-cert",{speed:400,spaceBetween:100,allowTouchMove:true,autoHeight:true});this.validateCert()}handleCertChange(e){if(e.detail.name=="maxDepth"||e.detail.name=="numberOfStudents"){this.diveCertification[e.detail.name]=d.exports.toNumber(e.detail.value)}else{this.diveCertification[e.detail.name]=e.detail.value}this.validateCert()}updateCertGroup(e){this.diveCertification.group=e;this.validateCert()}uniqueIdValid(e){this.validCert=this.validCert&&e.detail}updateImageUrls(e){const t=e.detail.type;const i=e.detail.url;if(t=="photo"){this.diveCertification.photoURL=i}else{this.diveCertification.coverURL=i}}validateCert(){this.validCert=d.exports.isString(this.diveCertification.id)&&d.exports.isString(this.diveCertification.name)&&this.diveCertification.numberOfStudents>0&&this.diveCertification.maxDepth>0}async save(){return s.dismiss(this.diveCertification)}async cancel(){return s.dismiss()}render(){return t(i,{key:"b82f1f9681856c6f93a72615a9334159c92da738"},t("ion-header",{key:"ee2e7e2022864b9ea6544e6428a4dcfcffb9fffc"},this.diveCertification.id?t("app-upload-cover",{item:{collection:c,id:this.agencyId+"-"+this.diveCertification.id,photoURL:this.diveCertification.photoURL,coverURL:this.diveCertification.coverURL},onCoverUploaded:e=>this.updateImageUrls(e)}):undefined),t("app-header-segment-toolbar",{key:"07ec075829ffedb2e1bbc5311c61672ac404a146",color:f.getAppColor(),swiper:this.slider,titles:this.titles}),t("ion-content",{key:"2d8e5d0b72058d484645bb8be2de1f8ccd531d44",class:"slides"},t("swiper-container",{key:"9b5d8acf91975dbc8bea1430bfb572b389f5d673",class:"slider-dive-cert swiper"},t("swiper-wrapper",{key:"0183505b1e2e6758879a11b6760ab201aaea4932",class:"swiper-wrapper"},t("swiper-slide",{key:"3a17c0b9efe01fc5ed74e3e69c9f51a5ccf5fea2",class:"swiper-slide"},t("ion-list",{key:"f7b9c1ccf093fb337c8e7f4a8f8c8612dd81758e"},t("app-form-item",{key:"9cc14a6cb3b5921868f61854f0d21724afe3d681","label-tag":"unique-id","label-text":"Unique ID",value:this.diveCertification.id,disabled:!this.newCert,name:"id","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),onIsValid:e=>this.uniqueIdValid(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"491cfbd4afe564d6f6ce0baad5f5f77b64ddcd68","label-tag":"name","label-text":"Name",value:this.diveCertification.name,name:"name","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"8b74302304d6fccf39209cddecd14f3805a84396","label-tag":"max-depth","label-text":"Max. Depth",value:d.exports.toString(this.diveCertification.maxDepth),name:"maxDepth","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"581fe4e6ad21a23f4a7ab9ea8c427f870289429a","label-tag":"max-students","label-text":"Max. number of students",value:d.exports.toString(this.diveCertification.numberOfStudents),name:"numberOfStudents","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("ion-item",{key:"9d545d057c87172cc8b00b022b6940d65864693f"},t("ion-label",{key:"7f9fd35001b12b3384b1d0e1812e60ed5560b8b4"},"Certification Group"),t("ion-select",{key:"cf728d617e23a79fc53b04c81938a6187ebd5c74",value:this.diveCertification.group,onIonChange:e=>this.updateCertGroup(e.detail.value),interface:"popover"},this.certGroups.map((e=>t("ion-select-option",{value:e.tag},e.text))))))),t("swiper-slide",{key:"7b3e42019101e4f52d8f12a64a85b6e4f2577929",class:"swiper-slide"},t("app-dive-course-activities",{key:"5552de6e33633b5c62eb111d8fb1e84926789c5c",schedule:this.diveCertification.activities,showDiveLocation:false,onScheduleEmit:e=>this.diveCertification.activities=e.detail,editable:true}))))),t("app-modal-footer",{key:"b7cfcb7bd28f6ef335570195b9f1bee070ff7259",disableSave:!this.validCert,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};h.style=l;export{h as modal_dive_certification_update};