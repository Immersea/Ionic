import{r as e,h as t,H as i,f as s}from"./p-cbe60c68.js";import{a5 as a,aH as o,U as r,aI as n}from"./p-736235c6.js";import{G as l,C as m}from"./p-13508874.js";import"./p-c7ee7cfe.js";import{n as c}from"./p-5d4a8e1f.js";import{l as h}from"./p-1af05547.js";import"./p-1819cfda.js";import"./p-e9c4f463.js";import"./p-46038295.js";import"./p-694b8ade.js";import"./p-7ee16e8d.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const p="popover-gas-blender{}popover-gas-blender .scrollx{display:flex;flex-wrap:nowrap;overflow-x:auto}popover-gas-blender .scrollx .item{flex:0 0 0 0}popover-gas-blender .scrollx ::-webkit-scrollbar{display:none}";const b=p;const f=class{constructor(t){e(this,t);this.maxPressure=a.isMetric()?300:4300;this.maxTemperature=a.isMetric()?60:140;this.gasProp=undefined;this.stdGasesList=undefined;this.showBar=true;this.hasTrimixlicence=true;this.gas=new l(new m(10,a.isMetric()?200:3e3),new o(.21,0),a.isMetric()?200:3e3,false,a.isMetric()?20:68);this.form=undefined}async componentWillLoad(){this.hasTrimixlicence=await r.checkLicence("trimix");if(this.gasProp&&this.gasProp.getFO2()){this.gas=this.gasProp}this.setForm();this.updateStdGasList()}componentDidLoad(){this.scrollGas=this.el.querySelector("#scrollGas");this.updateStdGasList()}disconnectedCallback(){this.setForm()}save(){c.dismiss(this.gas)}async setForm(){this.form=this.gas.getForm();this.hasTrimixlicence=await r.checkLicence("trimix")}updateStdGasList(){this.stdGases=[];var e=false;var t=0;var i=0;this.stdGasesList.forEach((s=>{t++;let a=this.gas.mMix.O2===s.O2&&this.gas.mMix.He===s.He?true:false;if(a){e=true;i=t}this.stdGases.push({selected:a,gas:s.getGas()})}));setTimeout((()=>{if(e&&this.scrollGas){let e=this.scrollGas.scrollWidth;let s=this.scrollGas.clientWidth;let a=t/(e/s);i=i-a;i=i<0?0:i;this.scrollGas.scrollLeft=e*i/t*1.15}}))}selectStdGas(e){if(!this.hasTrimixlicence&&e.He>0){r.checkLicence("trimix",true);return}this.gas.setMix(new o(h.exports.round(e.fO2,3),h.exports.round(e.fHe,3),e.fromDepth,e.ppO2,e.units));this.setForm();this.updateStdGasList()}inputHandler(e){this.form[e.detail.name]=e.detail.value}blurHandler(e){this.updateGas(e.detail.name);if(e.detail.name=="bar"){this.gas.setPressure(h.exports.toNumber(this.form.bar)>this.maxPressure?this.maxPressure:h.exports.toNumber(this.form.bar))}else if(e.detail.name=="temp"){this.gas.setTemperature(h.exports.toNumber(this.form.temp)>this.maxTemperature?this.maxTemperature:h.exports.toNumber(this.form.temp))}this.setForm()}updateGas(e){if(e=="o2"){this.gas.mMix.setFO2(h.exports.round(h.exports.toNumber(this.form.o2),2)/100)}else if(e=="he"){this.gas.mMix.setFHe(h.exports.round(h.exports.toNumber(this.form.he),2)/100)}else if(e=="bar"){this.gas.setPressure(h.exports.toNumber(this.form.bar))}else if(e=="temp"){this.gas.setTemperature(h.exports.toNumber(this.form.temp))}this.updateStdGasList()}render(){return t(i,{key:"43f94d41b89ded5c3117dc0971c99c0ab38c57e6"},t("ion-list",{key:"d7e2a0053872a50af06c9b31cb551dad50bb8e15"},t("ion-grid",{key:"88838c0e9438a8fe5e9b14f288e45efa59ab3199",class:"ion-no-padding"},t("ion-row",{key:"f9b2c01b9c110751571eb1503e7f5ecf36b2e96c"},t("ion-col",{key:"0e0ad4170d31a931d46d10e5349b7580a1654181",size:"6"},t("app-form-item",{key:"2b387c794892474a2597e09d9c2e8ec348f80631","label-tag":"o2","label-text":"O2",value:this.form.o2,name:"o2","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),onFormItemBlur:e=>this.blurHandler(e),validator:["required",{name:"minmaxvalue",options:{min:0,max:100-this.form.he}}]})),t("ion-col",{key:"8e2e314fb95c96101175205f734600e221271744",size:"6"},this.hasTrimixlicence?t("app-form-item",{"label-text":"He",value:this.form.he,name:"he","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),onFormItemBlur:e=>this.blurHandler(e),validator:["required",{name:"minmaxvalue",options:{min:0,max:100-this.form.o2}}]}):t("app-form-item",{"label-text":"He",value:this.form.he,onClick:()=>r.checkLicence("trimix",true)}))),t("ion-row",{key:"99ed7bcc20f0bcf399afa1c52641eb8e62836f10"},t("ion-col",{key:"b4a21f220391eea973e6f25952ae6a3cb525abfd",size:"6"},t("app-form-item",{key:"69ec320b5acf10bb0c59977e3fb5a26e25b31539","label-tag":"pressure","label-text":"Pressure",appendText:" ("+a.pressUnit+")",value:this.form.bar,name:"bar","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),onFormItemBlur:e=>this.blurHandler(e),validator:["required",{name:"minmaxvalue",options:{min:1,max:this.maxPressure}}]})),t("ion-col",{key:"ebfd45e2198697c4a9ae42236524589b9f30b759",size:"6"},t("app-form-item",{key:"145b08a54ca1477dea618f86ec4a2e9dbbf17933","label-tag":"temperature","label-text":"Temperature",appendText:" ("+(a.isMetric()?"°C":"°F")+")",value:this.form.temp,name:"temp","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),onFormItemBlur:e=>this.blurHandler(e),validator:["required",{name:"minmaxvalue",options:{min:0,max:this.maxTemperature}}]}))),t("ion-row",{key:"d63d1b48b0d27ce2e08bdb9bfb9e5356b6a4ff9e",class:"scrollx",id:"scrollGas"},this.stdGases.map((e=>t("ion-col",{class:"item"},t("ion-button",{shape:"round",color:e.selected?"secondary":"primary",onClick:()=>this.selectStdGas(e.gas)},n.getGasName(e.gas)))))),t("ion-row",{key:"3ef01501471acabf6bb29c8130b99da6e78a695c"},t("ion-col",{key:"ea8af2a7b205bf5cb0a686b3f65f48dec6b03891",class:"item"},t("ion-button",{key:"5a49922602ff38e8d87cd2c13130ead5bb637a0a",expand:"block",fill:"outline",size:"small",color:"success",onClick:()=>this.save()},t("my-transl",{key:"d450751f41fb4cd14959ac2fd5259338e9c5e2ff",tag:"save",text:"Save"})))))))}get el(){return s(this)}};f.style=b;export{f as popover_gas_blender};