{"version":3,"names":["pageTrsUserSettingsCss","PageTrsUserSettingsStyle0","PageTrsUserSettings","this","titles","tag","text","componentWillLoad","userSub$","UserService","userProfile$","subscribe","userProfile","UserProfile","userRoles","componentDidLoad","setSliderHeight","initLocalUser","updateSlider","slider","Swiper","speed","spaceBetween","allowTouchMove","autoHeight","photoURL","coverURL","slideContainers","Array","from","el","getElementsByClassName","map","container","setAttribute","slideHeight","disconnectedCallback","unsubscribe","updateView","setTimeout","update","undefined","scrollToTop","content","logScrollStart","ev","srcElement","checkShapesMapData","ShapesService","checkMapData","checkProjectsMapData","ProjectsService","checkDatasheetsMapData","DatasheetsService","render","h","class","showUserDetails","color","Environment","getAppColor","swiper","scrollEvents","onIonScrollStart","vertical","horizontal","slot","style","marginTop","fabButtonTopMarginString","name","onClick","presentUserUpdate","showCover","expand","fill","AuthService","logout","isLabel","isSuperAdmin","button","editShapeTypes","TrasteelFilterService","getMapDocs","SHAPESCOLLECTION","icon","editDatasheetSettings","DATASHEETSCOLLECTION","editProjectSettings","PROJECTSCOLLECTION"],"sources":["src/components/trasteel/pages/user/page-trs-user-settings/page-trs-user-settings.scss?tag=page-trs-user-settings","src/components/trasteel/pages/user/page-trs-user-settings/page-trs-user-settings.tsx"],"sourcesContent":["page-trs-user-settings {\n  .cover {\n    height: var(--coverHeight);\n  }\n  .nopaddingtop {\n    //remove for iOS\n    padding-top: 0px !important;\n  }\n}\n","import {Component, h, State, Element} from \"@stencil/core\";\nimport {Subscription} from \"rxjs\";\nimport {UserService} from \"../../../../../services/common/user\";\nimport {AuthService} from \"../../../../../services/common/auth\";\nimport {UserProfile} from \"../../../../../interfaces/common/user/user-profile\";\nimport {\n  fabButtonTopMarginString,\n  slideHeight,\n} from \"../../../../../helpers/utils\";\nimport {Environment} from \"../../../../../global/env\";\nimport Swiper from \"swiper\";\nimport {\n  SHAPESCOLLECTION,\n  ShapesService,\n} from \"../../../../../services/trasteel/refractories/shapes\";\nimport {TrasteelFilterService} from \"../../../../../services/trasteel/common/trs-db-filter\";\nimport {\n  DATASHEETSCOLLECTION,\n  DatasheetsService,\n} from \"../../../../../services/trasteel/refractories/datasheets\";\nimport {\n  PROJECTSCOLLECTION,\n  ProjectsService,\n} from \"../../../../../services/trasteel/refractories/projects\";\nimport {UserRoles} from \"../../../../../components\";\n\n@Component({\n  tag: \"page-trs-user-settings\",\n  styleUrl: \"page-trs-user-settings.scss\",\n})\nexport class PageTrsUserSettings {\n  @Element() el: HTMLElement;\n  @State() userProfile: UserProfile;\n  @State() userRoles: UserRoles;\n  userSub$: Subscription;\n  titles = [\n    {tag: \"user-info\", text: \"My Info\"},\n    {tag: \"admin\", text: \"Administration\"},\n  ];\n  @State() slider: Swiper;\n  @State() updateView = false;\n  content: HTMLIonContentElement;\n\n  componentWillLoad() {\n    this.userSub$ = UserService.userProfile$.subscribe(\n      (userProfile: UserProfile) => {\n        this.userProfile = new UserProfile(userProfile);\n        this.userRoles = UserService.userRoles;\n      }\n    );\n  }\n\n  async componentDidLoad() {\n    this.setSliderHeight();\n    //check if user is loaded or trigger local user\n    if (!this.userProfile) {\n      UserService.initLocalUser();\n    }\n    this.updateSlider();\n  }\n\n  setSliderHeight() {\n    this.slider = new Swiper(\".slider-user-settings\", {\n      speed: 400,\n      spaceBetween: 100,\n      allowTouchMove: false,\n      autoHeight: true,\n    });\n    //reset sliders height inside slider\n    if (this.userProfile.photoURL || this.userProfile.coverURL) {\n      const slideContainers = Array.from(\n        this.el.getElementsByClassName(\"slide-container\")\n      );\n      slideContainers.map((container) => {\n        container.setAttribute(\n          \"style\",\n          \"height: \" + (slideHeight(this.userProfile) - 190) + \"px\"\n        );\n      });\n    }\n  }\n\n  disconnectedCallback() {\n    this.userSub$.unsubscribe();\n  }\n\n  updateSlider() {\n    this.updateView = !this.updateView;\n    //wait for view to update and then reset slider height\n    setTimeout(() => {\n      this.slider ? this.slider.update() : undefined;\n    }, 100);\n    this.scrollToTop();\n  }\n\n  scrollToTop() {\n    this.content ? this.content.scrollToTop() : undefined;\n  }\n\n  logScrollStart(ev) {\n    this.content = ev.srcElement;\n  }\n\n  checkShapesMapData() {\n    ShapesService.checkMapData();\n  }\n\n  checkProjectsMapData() {\n    ProjectsService.checkMapData();\n  }\n\n  checkDatasheetsMapData() {\n    DatasheetsService.checkMapData();\n  }\n\n  render() {\n    return [\n      this.userProfile\n        ? [\n            this.userProfile.coverURL || this.userProfile.photoURL ? (\n              <ion-header class=\"cover\">\n                <app-user-cover showUserDetails={false}></app-user-cover>\n              </ion-header>\n            ) : (\n              <app-navbar\n                color={Environment.getAppColor()}\n                tag=\"settings\"\n                text=\"Settings\"\n              ></app-navbar>\n            ),\n            <app-header-segment-toolbar\n              color={Environment.getAppColor()}\n              swiper={this.slider}\n              titles={this.titles}\n              class=\"nopaddingtop\"\n            ></app-header-segment-toolbar>,\n            <ion-content\n              class=\"slides\"\n              scrollEvents={true}\n              onIonScrollStart={(ev) => this.logScrollStart(ev)}\n            >\n              {this.userProfile.coverURL || this.userProfile.photoURL\n                ? [\n                    <ion-fab\n                      vertical=\"top\"\n                      horizontal=\"start\"\n                      slot=\"fixed\"\n                      style={{\n                        marginTop:\n                          \"calc(env(safe-area-inset-top) + \" +\n                          fabButtonTopMarginString(1) +\n                          \")\",\n                      }}\n                    >\n                      <ion-menu-toggle>\n                        <ion-fab-button color=\"light\">\n                          <ion-icon name=\"menu-outline\" />\n                        </ion-fab-button>\n                      </ion-menu-toggle>\n                    </ion-fab>,\n                    <ion-fab\n                      vertical=\"top\"\n                      horizontal=\"end\"\n                      slot=\"fixed\"\n                      style={{\n                        marginTop:\n                          \"calc(env(safe-area-inset-top) + \" +\n                          fabButtonTopMarginString(1) +\n                          \")\",\n                      }}\n                    >\n                      <ion-fab-button\n                        color=\"light\"\n                        onClick={() => UserService.presentUserUpdate()}\n                      >\n                        <ion-icon name=\"create-outline\" />\n                      </ion-fab-button>\n                    </ion-fab>,\n                  ]\n                : undefined}\n              <swiper-container class=\"slider-user-settings swiper\">\n                <swiper-wrapper class=\"swiper-wrapper\">\n                  <swiper-slide class=\"swiper-slide\">\n                    <app-user-cover showCover={false}></app-user-cover>\n                    <ion-footer class=\"ion-no-border\">\n                      <ion-toolbar>\n                        <ion-button\n                          expand=\"block\"\n                          fill=\"solid\"\n                          color=\"danger\"\n                          onClick={() => AuthService.logout()}\n                        >\n                          <ion-icon slot=\"start\" name=\"log-out\"></ion-icon>\n                          <my-transl\n                            tag=\"logout\"\n                            text=\"Logout\"\n                            isLabel\n                          ></my-transl>\n                        </ion-button>\n                      </ion-toolbar>\n                    </ion-footer>\n                  </swiper-slide>\n                  <swiper-slide class=\"swiper-slide\">\n                    <ion-list>\n                      {this.userRoles.isSuperAdmin()\n                        ? [\n                            <ion-item-divider>\n                              <ion-label>SuperAdmin</ion-label>\n                            </ion-item-divider>,\n                            <ion-item\n                              button\n                              onClick={() => this.checkShapesMapData()}\n                            >\n                              <ion-label>Check Shapes MapData</ion-label>\n                            </ion-item>,\n                            <ion-item\n                              button\n                              onClick={() => this.checkDatasheetsMapData()}\n                            >\n                              <ion-label>Check Datasheets MapData</ion-label>\n                            </ion-item>,\n                            <ion-item\n                              button\n                              onClick={() => this.checkProjectsMapData()}\n                            >\n                              <ion-label>Check Projects MapData</ion-label>\n                            </ion-item>,\n                          ]\n                        : undefined}\n                      <ion-item-divider>\n                        <ion-label>Shapes</ion-label>\n                      </ion-item-divider>\n                      <ion-item\n                        button\n                        onClick={() => ShapesService.editShapeTypes()}\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(SHAPESCOLLECTION)\n                              .icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Types</ion-label>\n                      </ion-item>\n                      <ion-item-divider>\n                        <ion-label>Datasheets</ion-label>\n                      </ion-item-divider>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          DatasheetsService.editDatasheetSettings(\"majorfamily\")\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(\n                              DATASHEETSCOLLECTION\n                            ).icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Major Families</ion-label>\n                      </ion-item>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          DatasheetsService.editDatasheetSettings(\"family\")\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(\n                              DATASHEETSCOLLECTION\n                            ).icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Families</ion-label>\n                      </ion-item>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          DatasheetsService.editDatasheetSettings(\"category\")\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(\n                              DATASHEETSCOLLECTION\n                            ).icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Categories</ion-label>\n                      </ion-item>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          DatasheetsService.editDatasheetSettings(\n                            \"propertyType\"\n                          )\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(\n                              DATASHEETSCOLLECTION\n                            ).icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Property Types</ion-label>\n                      </ion-item>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          DatasheetsService.editDatasheetSettings(\n                            \"propertyName\"\n                          )\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(\n                              DATASHEETSCOLLECTION\n                            ).icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Property Names</ion-label>\n                      </ion-item>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          DatasheetsService.editDatasheetSettings(\n                            \"qualityColorCode\"\n                          )\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(\n                              DATASHEETSCOLLECTION\n                            ).icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Quality Color Codes</ion-label>\n                      </ion-item>\n                      <ion-item-divider>\n                        <ion-label>Projects</ion-label>\n                      </ion-item-divider>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          ProjectsService.editProjectSettings(\n                            \"bricksAllocationArea\"\n                          )\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(PROJECTSCOLLECTION)\n                              .icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Bricks Allocation Areas</ion-label>\n                      </ion-item>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          ProjectsService.editProjectSettings(\"applicationUnit\")\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(PROJECTSCOLLECTION)\n                              .icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Application Units</ion-label>\n                      </ion-item>\n                      <ion-item\n                        button\n                        onClick={() =>\n                          ProjectsService.editProjectSettings(\"quantityUnit\")\n                        }\n                      >\n                        <ion-icon\n                          name={\n                            TrasteelFilterService.getMapDocs(PROJECTSCOLLECTION)\n                              .icon.name\n                          }\n                          slot=\"start\"\n                        />\n                        <ion-label>Edit Quantity Units</ion-label>\n                      </ion-item>\n                    </ion-list>\n                  </swiper-slide>\n                </swiper-wrapper>\n              </swiper-container>\n            </ion-content>,\n          ]\n        : undefined,\n    ];\n  }\n}\n"],"mappings":"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","ignoreList":[]}