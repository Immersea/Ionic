import{r as e,h as n}from"./p-cbe60c68.js";import{U as t,b9 as a,S as i,R as s,af as c,T as o,b6 as l,t as r,o as d,ba as h,aj as u,aW as p,am as m,q as f,aN as b,ak as g,b7 as y}from"./p-9424d4f6.js";import"./p-c7ee7cfe.js";import{b as k}from"./p-5d4a8e1f.js";import{l as x}from"./p-1af05547.js";import{B as w}from"./p-25158b55.js";import"./p-694b8ade.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const v="app-user-cards{width:100%}app-user-cards .cards-container{margin:0;margin-bottom:1rem;}app-user-cards .cards-column{margin-bottom:1rem !important;}app-user-cards .card{display:flex;flex-direction:column;height:100%;box-sizing:border-box;cursor:pointer;transition:transform 0.2s ease-in-out;}app-user-cards .card:hover{transform:scale(1.02);}app-user-cards .card-content{flex-grow:1;}app-user-cards .card-margins{margin-bottom:1rem;}app-user-cards .add-card{min-height:200px;min-width:200px;}app-user-cards .add-card-content{display:flex;justify-content:center;align-items:center;height:100%;width:100%;}app-user-cards .add-icon{width:70%;height:70%;}";const C=v;const T=class{constructor(n){e(this,n);this.updateSlider=undefined;this.userCards=undefined;this.updateView=true;this.sysPref=undefined}async componentWillLoad(){this.userCardsSub$=t.userCards$.subscribe((e=>{this.userCards=new a(e);this.updateView=!this.updateView;this.updateSlider()}));this.sysPref=await i.getSystemPreferences()}componentDidLoad(){if(!this.userCards){t.initLocalUser()}}disconnectedCallback(){this.userCardsSub$.unsubscribe()}async addCard(e){const n=await s.openModal("modal-dive-card",{card:this.userCards.cards[e]?this.userCards.cards[e]:new c});n.onDidDismiss().then((n=>{n=n.data;if(n){if(this.userCards.cards[e]){this.userCards.cards[e]=new c(n)}else{this.userCards.cards.push(new c(n))}this.save()}}))}async removeCard(e,n){e.stopPropagation();const t=await k.create({header:o.getTransl("delete-card-header","Delete Dive Card?"),message:o.getTransl("delete-card-message","This dive card will be deleted! Are you sure?"),buttons:[{text:o.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:o.getTransl("ok","OK"),handler:()=>{this.userCards.cards.splice(n,1);this.save()}}]});t.present()}save(){t.updateUserCards(this.userCards);this.updateSlider()}render(){return n("div",{key:"40916da38ed73b8863f4e05323f8dce14d15e335",class:"slider-container"},n("div",{key:"0dd15cc879d4deb468fd81e476441c514ed159eb",class:"slider-scrollable-container"},n("ion-grid",{key:"8b054be49df225d54c8657cc3b8afd01894a561f",class:"ion-no-padding"},n("ion-row",{key:"70da1015dd165e21b037525bf33c5a0d029d88a0",class:"ion-text-start ion-no-padding cards-container"},this.userCards&&this.userCards.cards.length>0?this.userCards.cards.map(((e,t)=>n("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding cards-column"},n("ion-card",{onClick:()=>this.addCard(t),class:"card"},n("div",{class:"card-content"},e.imgFront?n("img",{src:e.imgFront}):undefined,n("ion-card-header",null,n("ion-card-subtitle",null,n("ion-item",{class:"ion-no-padding",lines:"none"},n("ion-button",{"icon-only":true,slot:"end",color:"danger",fill:"clear",onClick:e=>this.removeCard(e,t)},n("ion-icon",{name:"trash-bin-outline"})),n("ion-label",null,n("h2",null,e.course.certificationId))),e.course.agencyName)),n("ion-card-content",null,e.number?n("p",null,"#",e.number):undefined,e.instructor?n("p",null,n("my-transl",{tag:"instructor",text:"Instructor"}),": ",e.instructor):undefined,e.certified?n("p",null,n("my-transl",{tag:"certified",text:"Certified"}),":"," ",l(e.certified,"date")):undefined,e.expiry?n("p",null,n("my-transl",{tag:"expiry",text:"Expiry"}),":"," ",l(e.expiry,"date")):undefined,e.comments?n("p",null,n("my-transl",{tag:"comments",text:"Comments"}),":"," ",e.comments):undefined)))))):undefined,n("ion-col",{key:"d9dc860fb822bf719d3ff78c8e6258f16cce0958","size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding cards-column"},n("ion-card",{key:"c86f7f0deb46d207a1301c37c667b9435f597114",class:"card add-card",onClick:()=>this.addCard()},n("ion-card-content",{key:"d7cc2163d587e6dec2630cb478ee0fcb7f504749",class:"card-content add-card-content"},n("ion-icon",{key:"b7e25ea3e371d79f46b83fc870ab0b5ad1e01d2b",name:"add-circle-outline",class:"add-icon"}))))))))}};T.style=C;const D="app-user-configurations{width:100%}app-user-configurations .cards-container{margin:0;margin-bottom:1rem;}app-user-configurations .cards-column{margin-bottom:1rem !important;}app-user-configurations .card{display:flex;flex-direction:column;height:100%;box-sizing:border-box;cursor:pointer;transition:transform 0.2s ease-in-out;}app-user-configurations .card:hover{transform:scale(1.02);}app-user-configurations .card-content{flex-grow:1;}app-user-configurations .card-margins{margin-bottom:1rem;}app-user-configurations .add-card{min-height:200px;min-width:200px;}app-user-configurations .add-card-content{display:flex;justify-content:center;align-items:center;height:100%;width:100%;}app-user-configurations .add-icon{width:70%;height:70%;}";const z=D;const j=class{constructor(n){e(this,n);this.stdConfigurations=[];this.userConfigurations=[]}componentWillLoad(){this.userSub$=t.userSettings$.subscribe((e=>{this.userSettings=new r(e);this.loadData()}))}componentDidLoad(){if(!this.userSettings){t.initLocalUser()}}async loadData(){if(!this.userSettings){this.userSettings=new r(await d.getLocalDocument(h))}this.stdConfigurations=u.getStdConfigurations();if(this.userSettings){this.userConfigurations=this.userSettings.userConfigurations}else{const e=await d.getLocalDocument("localconfigurations");if(e){this.stdConfigurations=[];e.forEach((e=>{const n=new p(e);this.userConfigurations.push(n)}))}else{this.userConfigurations=u.getDivePlansFromConfigurations(this.stdConfigurations);d.saveLocalDocument("localconfigurations",this.userConfigurations)}}}disconnectedCallback(){this.userSub$.unsubscribe()}async viewConfiguration(e){const n=await t.checkLicence("configs",true);if(n){const n=x.exports.cloneDeep(this.userConfigurations[e]);const t=new m;t.setConfiguration(n);const a=await s.openModal("modal-dive-configuration",{diveDataToShare:{divePlan:t}});a.onDidDismiss().then((n=>{n=n.data;if(n){this.userConfigurations[e]=new p(n);this.save()}}))}}async removeConfiguration(e,n){e.stopPropagation();const a=await t.checkLicence("configs",true);if(a){const e=await k.create({header:o.getTransl("delete-configuration-header","Delete configuration?"),message:o.getTransl("delete-configuration-message","This configuration will be deleted! Are you sure?"),buttons:[{text:o.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:o.getTransl("ok","OK"),handler:()=>{this.userConfigurations.splice(n,1);this.save()}}]});e.present()}}async addConfiguration(){const e=await t.checkLicence("configs",true);if(e){let e=[];x.exports.forEach(this.stdConfigurations,((n,t)=>{e.push({type:"radio",label:n.stdName+" (standard)",value:n,checked:t==0?true:false})}));x.exports.forEach(this.userConfigurations,(n=>{e.push({type:"radio",label:n.stdName,value:n,checked:false})}));const n=await k.create({header:o.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:o.getTransl("ok","OK"),handler:async e=>{let n=await t.checkLicence("configs",true);if(n){const n=new p(e);const t=new m;t.setConfiguration(n);const a=await s.openModal("modal-dive-configuration",{diveDataToShare:{divePlan:t}});a.onDidDismiss().then((e=>{e=e.data;if(e){this.userConfigurations.push(new p(e));this.save()}}))}}},{text:o.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});n.present()}}save(){t.updateUserConfigurations(this.userConfigurations)}render(){return n("div",{key:"7cace0d46ce80fac3541d543d7a05f9264df69fb",class:"slider-container"},n("div",{key:"57ab3e7558fd5f1fda2932b8660f2a2d6fb741a2",class:"slider-scrollable-container"},n("ion-grid",{key:"4319e2a5d4c2da090471187f2b7146764f31dce7",class:"ion-no-padding"},n("ion-row",{key:"e2a7571257a04f711ae63766ad2772deaacf9322",class:"ion-text-start ion-no-padding cards-container"},this.userConfigurations.map(((e,t)=>n("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding cards-column"},n("ion-card",{onClick:()=>this.viewConfiguration(t),class:"card"},n("div",{class:"card-content"},n("ion-card-header",null,n("ion-item",{class:"ion-no-padding",lines:"none"},n("ion-button",{"icon-only":true,slot:"end",color:"danger",fill:"clear",onClick:e=>this.removeConfiguration(e,t)},n("ion-icon",{name:"trash-bin-outline"})),n("ion-card-title",null,e.stdName)),n("ion-card-subtitle",null,n("my-transl",{tag:"max-depth",text:"Max Depth"}),":",e.maxDepth," ",e.parameters.depthUnit)),n("ion-card-content",null,e.configuration.bottom.length>0?n("p",null,n("my-transl",{tag:"bottom-tanks",text:"Bottom Tanks"}),":"):undefined,e.configuration.bottom.map((e=>n("p",null,e.name+"->"+e.gas.toString()))),e.configuration.deco.length>0?n("p",null,n("my-transl",{tag:"deco-tanks",text:"Deco Tanks"}),":"):undefined,e.configuration.deco.map((e=>n("p",null,e.name+"->"+e.gas.toString()))))))))),n("ion-col",{key:"880bd15f407afb91e2084db2b66f81e45509179e","size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding cards-column"},n("ion-card",{key:"57db890921821311ff0c43300b4a827888d9ec89",class:"card add-card",onClick:()=>this.addConfiguration()},n("ion-card-content",{key:"72ce732bfb708ec6059c880c34dc3a039adb9743",class:"card-content add-card-content"},n("ion-icon",{key:"0271aec5b00daec75a8371d95a42bca135423b30",name:"add-circle-outline",class:"add-icon"}))))))))}};j.style=z;const O="app-user-licences{width:100%}";const M=O;const L=class{constructor(n){e(this,n);this.allowPurchase=true;this.userRoles=undefined;this.prices={};this.sysPref=undefined}async componentWillLoad(){this.userRolesSub$=t.userRoles$.subscribe((e=>{if(e&&e.uid){this.userRoles=new f(e)}}));this.sysPref=await i.getSystemPreferences();this.setProductPrices()}componentDidLoad(){if(!this.userRoles){t.initLocalUser()}}disconnectedCallback(){this.userRolesSub$.unsubscribe()}setProductPrices(){this.prices={rec1:{licence:"rec1",price:this.sysPref.productPrices.rec1},rec2:{licence:"rec2",price:this.sysPref.productPrices.rec2},rec3:{licence:"rec3",price:this.sysPref.productPrices.rec3},tech1:{licence:"tech1",price:this.sysPref.productPrices.tech1},tech2:{licence:"tech2",price:this.sysPref.productPrices.tech2},unlimited:{licence:"unlimited",price:this.sysPref.productPrices.unlimited}}}async showInfo(e){let n;switch(e){case"trimix":n=o.getTransl("licence-tmx-descr","This licence adds the possibility to select trimix gases in the dive plans.");break;case"tables":n=o.getTransl("licence-tables-descr","This licence shows dive plan tables with the possibility to vary the bottom time and depth.");break;case"rebreather":n=o.getTransl("licence-reb-descr","This licence adds the possibility to plan dives with CCR and pSCR rebreathers, including bailout options.");break;case"configurations":n=o.getTransl("licence-confs-descr","This licence adds the possibility to edit, add and delete dive configurations.");break;case"professional":n=o.getTransl("licence-pro-descr","This licence opens all the features of the app.");break;case"rec1":n=o.getTransl("licence-rec1-descr","This licence allows dives in the Rec1 range.");break;case"rec2":n=o.getTransl("licence-rec2-descr","This licence allows dives in the Rec2 range.");break;case"rec3":n=o.getTransl("licence-rec3-descr","This licence allows dives in the Rec3 range.");break;case"tech1":n=o.getTransl("licence-tech1-descr","This licence allows dives in the Tech1 range.");break;case"tech2":n=o.getTransl("licence-tech2-descr","This licence allows dives in the Tech2 range.");break;case"unlimited":n=o.getTransl("licence-unlimited-descr","This licence allows every kind of dive.");break}let t=[];t.push({text:o.getTransl("purchase","Purchase"),handler:()=>{this.purchase(e)}});t.push({text:o.getTransl("ok","OK")});let a=await k.create({header:o.getTransl("licence-info","Licence info"),message:n,buttons:t});a.present()}async activateTrial(){const e=this.userRoles.licences.trial.duration>0?this.userRoles.licences.trial.duration:15;let n=await k.create({header:o.getTransl("activate-trial","Start Trial"),message:o.getTransl("activate-trail-message","Do you want to start the UNLIMITED trial period of xxx days?",{xxx:e}),buttons:[{text:o.getTransl("ok","OK"),handler:async()=>{await b.startUserTrialPeriod()}},{role:"cancel",text:o.getTransl("cancel","Cancel")}]});n.present()}async purchase(e){let n=encodeURI("https://www.gue.com/store/software/decoplanner-4?uid="+t.userProfile.uid+"&email="+t.userProfile.email+"&licence="+e);await w.open({url:n})}render(){return this.userRoles&&this.userRoles.uid?n("ion-list",null,n("ion-list-header",{onClick:()=>this.purchase("unlimited")},n("my-transl",{tag:"purchase-dp4",text:"Purchase DecoPlanner 4"})),Object.keys(this.prices).map((e=>n("ion-item",null,n("ion-label",null,n("my-transl",{tag:e,text:x.exports.upperFirst(e)})),!this.userRoles.hasLicence(this.prices[e].licence,false)?[n("ion-button",{slot:"end",fill:"clear",onClick:()=>this.showInfo(e)},n("ion-icon",{name:"help-circle"}))]:n("ion-button",{slot:"end",fill:"clear"},n("ion-icon",{color:"secondary",name:"checkmark"}))))),n("ion-item",null,n("my-transl",{tag:"trial-period",text:"Trial Period",isLabel:true}),this.userRoles.licences.trial.level?n("ion-note",{slot:"end"}," ",this.userRoles.licences.trialDays()>0?n("span",null,n("my-transl",{tag:this.userRoles.licences.trial.level,text:x.exports.upperFirst(this.userRoles.licences.trial.level)})," ","- ",this.userRoles.licences.trialDays()," ",n("my-transl",{tag:"days-remaining",text:"days remaining"})):n("span",null,n("my-transl",{tag:this.userRoles.licences.trial.level,text:x.exports.upperFirst(this.userRoles.licences.trial.level)})," - ",n("my-transl",{tag:"expired",text:"Expired"}),": "+this.userRoles.licences.trialExpiryDate())):n("ion-button",{slot:"end",fill:"outline",onClick:()=>this.activateTrial()},n("ion-label",null,n("my-transl",{tag:"activate-trial",text:"Start Trial"})))),n("ion-item-divider",null,"Actual limitations"),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"max-deco-time",text:"Max Deco Time"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().maxDecoTime+" min"))),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"max-depth",text:"Max Depth"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().maxDepth+" "+g.depthUnit))),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"max-he",text:"Max He"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().maxHe+"%"))),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"min-o2",text:"Min O2"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().minO2+"%"))),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"max-o2",text:"Max O2"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().maxO2+"%"))),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"max-deco-gases",text:"Max Deco Gases"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().maxDecoGases))),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"min-deco-o2",text:"Min Deco O2"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().minDecoO2+"%"))),n("ion-item",null,n("ion-label",null,n("my-transl",{tag:"max-deco-o2",text:"Max Deco O2"})),n("ion-note",{slot:"end"},n("span",null,t.userRoles.licences.getUserLimitations().maxDecoO2+"%")))):undefined}};L.style=M;const _="app-user-tanks{width:100%}app-user-tanks .cards-container{margin:0;margin-bottom:1rem;}app-user-tanks .cards-column{margin-bottom:1rem !important;}app-user-tanks .card{display:flex;flex-direction:column;height:100%;box-sizing:border-box;cursor:pointer;transition:transform 0.2s ease-in-out;}app-user-tanks .card:hover{transform:scale(1.02);}app-user-tanks .card-content{flex-grow:1;}app-user-tanks .card-margins{margin-bottom:1rem;}app-user-tanks .add-card{min-height:200px;min-width:200px;}app-user-tanks .add-card-content{display:flex;justify-content:center;align-items:center;height:100%;width:100%;}app-user-tanks .add-icon{width:70%;height:70%;}";const P=_;const S=class{constructor(n){e(this,n);this.stdTanks=[];this.hasUserTanks=true;this.userTanks=[]}componentWillLoad(){this.userSub$=t.userSettings$.subscribe((e=>{this.userSettings=new r(e);this.loadData()}))}componentDidLoad(){if(!this.userSettings){t.initLocalUser()}}async loadData(){if(!this.userSettings){this.userSettings=new r(await d.getLocalDocument(h))}this.userTanks=this.userSettings.userTanks;this.stdTanks=u.getStdTanks();if(x.exports.isEqual(this.userTanks,this.stdTanks))this.hasUserTanks=false}disconnectedCallback(){this.userSub$.unsubscribe()}async viewTank(e){const n=await t.checkLicence("configs",true);if(n){const n=x.exports.cloneDeep(this.userTanks[e]);const t=await s.openModal("modal-tank-configuration",{tank:n});t.onDidDismiss().then((n=>{if(n&&n.data){const t=n.data;this.userTanks[e]=new y(t);this.save()}}))}}async removeTank(e,n){e.stopPropagation();const a=await t.checkLicence("configs",true);if(a){const e=await k.create({header:o.getTransl("delete-tank-header","Delete tank?"),message:o.getTransl("delete-tank-message","This tank will be deleted! Are you sure?"),buttons:[{text:o.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:o.getTransl("ok","OK"),handler:()=>{this.userTanks.splice(n,1);this.save()}}]});e.present()}}async addTank(){const e=await t.checkLicence("configs",true);if(e){let e=[];x.exports.forEach(this.stdTanks,((n,t)=>{e.push({type:"radio",label:n.name+(this.hasUserTanks?" (standard)":""),value:n,checked:t==0?true:false})}));if(this.hasUserTanks)x.exports.forEach(this.userTanks,(n=>{e.push({type:"radio",label:n.name,value:n,checked:false})}));const n=await k.create({header:o.getTransl("select-standard-tank","Select standard tank"),buttons:[{text:o.getTransl("ok","OK"),handler:async e=>{let n=await t.checkLicence("configs",true);if(n){const n=await s.openModal("modal-tank-configuration",{tank:e});n.onDidDismiss().then((e=>{if(e&&e.data){const n=e.data;this.userTanks.push(new y(n));this.save()}}))}}},{text:o.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});n.present()}}save(){t.updateUserTanks(this.userTanks)}render(){return n("div",{key:"9643f72ed0b27c3dea72fb97b22cea17a10d1f24",class:"slider-container"},n("div",{key:"00d32625dcbde7eb04878254051943a77048109f",class:"slider-scrollable-container"},n("ion-grid",{key:"956939df7ac98ae3f266754ea44c07ae8f1cab0c",class:"ion-no-padding"},n("ion-row",{key:"0c036be30890996637d0a00b7187ecf3dd8b8e7b",class:"ion-text-start ion-no-padding cards-container"},this.userTanks.map(((e,t)=>n("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding cards-column"},n("ion-card",{onClick:()=>this.viewTank(t),class:"card"},n("div",{class:"card-content"},n("ion-card-header",null,n("ion-item",{class:"ion-no-padding",lines:"none"},n("ion-button",{"icon-only":true,slot:"end",color:"danger",fill:"clear",onClick:e=>this.removeTank(e,t)},n("ion-icon",{name:"trash-bin-outline"})),n("ion-card-title",null,e.name)),n("ion-card-subtitle",null,o.getTransl("volume","Volume")+" : "+e.volume+" lt"+(this.userSettings.settings.units!="Metric"?" / "+g.ltToCuFt(e.volume)+" cuft":""))),n("ion-card-content",null,n("ion-grid",null,n("ion-row",null,n("ion-col",null,o.getTransl("no_of_tanks","Number Of Tanks")+" : "+e.no_of_tanks)),n("ion-row",null,n("ion-col",null,o.getTransl("pressure","Pressure")+" : "+e.pressure+" bar"+(this.userSettings.settings.units!="Metric"?" / "+g.barToPsi(e.pressure)+" psi":""))),e.forDeco?n("ion-row",null,n("ion-col",null,"(",o.getTransl("for-deco","For Decompression"),")")):undefined))))))),n("ion-col",{key:"01eb5b3797af7d0ea5a715206a89a99148dd4804","size-sm":"12","size-md":"6","size-lg":"4",class:"ion-no-padding cards-column"},n("ion-card",{key:"d64648d499007cebabcc54ec5e0d2d7ff7e9f7f3",class:"card add-card",onClick:()=>this.addTank()},n("ion-card-content",{key:"0026b020c5245493abb73b1aec2366d7774b5adf",class:"card-content add-card-content"},n("ion-icon",{key:"ac111f6925650fd34b4cf057170818bd011678c3",name:"add-circle-outline",class:"add-icon"}))))))))}};S.style=P;export{T as app_user_cards,j as app_user_configurations,L as app_user_licences,S as app_user_tanks};