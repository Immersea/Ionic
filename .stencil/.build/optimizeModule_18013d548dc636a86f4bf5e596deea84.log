import{r as t,h as e,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{ah as c,ak as o,S as d,T as l}from"./p-736235c6.js";import{E as r}from"./p-46038295.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-1819cfda.js";import"./p-7ee16e8d.js";const h="modal-project-quantityunit ion-list{width:100%}";const f=h;const b=class{constructor(e){t(this,e);this.index=0;this.quantityUnits=undefined;this.quantityUnit=undefined;this.updateView=true;this.validQuantityUnit=false}async componentWillLoad(){await this.loadQuantityUnits()}async loadQuantityUnits(){await c.downloadProjectSettings();this.quantityUnits=n.exports.cloneDeep(c.getQuantityUnits());if(this.quantityUnits&&this.quantityUnits.length>0){this.quantityUnit=this.quantityUnits[0]}else{this.addQuantityUnit()}this.validateProject()}selectType(t){this.quantityUnit=this.quantityUnits[t.detail.value];this.validateProject()}handleChange(t){const e=t.detail.name;let i=t.detail.value;if(e=="familyId"){i=i.replace(/\s+/g,"-").trim().toLowerCase()}this.quantityUnit[e]=i;this.validateProject()}validateProject(){this.validQuantityUnit=n.exports.isString(this.quantityUnit.quantityUnitId)&&n.exports.isString(this.quantityUnit.quantityUnitId);this.updateView=!this.updateView}addQuantityUnit(){this.quantityUnit=new o;this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}duplicateQuantityUnit(){this.quantityUnit=n.exports.cloneDeep(this.quantityUnit);this.quantityUnit.quantityUnitId=this.quantityUnit.quantityUnitId+"_rev.";this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}async deleteQuantityUnit(){try{this.quantityUnits.splice(this.index,1);this.index=0;this.quantityUnit=this.quantityUnits[0];this.validateProject()}catch(t){if(t)d.presentAlertError(t)}}async save(t=true){await c.uploadProjectSettings("quantityUnit",this.quantityUnits);return t?s.dismiss():true}async cancel(){return s.dismiss()}render(){return e(i,{key:"f719e47138be054bea7d7cb7986d5c2f77d9518a"},e("ion-content",{key:"894a8aa5ee4a7f0e6a6cec66e897f196004645fa"},e("ion-grid",{key:"7017e7aa10ca77d65205487dca759c8aa78c5232"},e("ion-row",{key:"dc399eef729b25afda4d48e7696b76d16cb6e31e"},e("ion-col",{key:"c86bffc3a2771af6450eda3744abfcaf5546ee57"},e("ion-item",{key:"4d12392c6204534007b72692a67e02e9c7aa817c",lines:"none"},e("ion-select",{key:"6d1bc24a90d3c264831d805d472b98477631724e",color:"trasteel",id:"selectType",interface:"action-sheet",label:l.getTransl("project_quantityunit","Project Quantity Unit"),disabled:!this.validQuantityUnit,"label-placement":"floating",onIonChange:t=>this.selectType(t),value:this.index?this.index:0},this.quantityUnits.map(((t,i)=>e("ion-select-option",{value:i},t.quantityUnitId+" | "+t.quantityUnitName.en)))))),e("ion-col",{key:"67febfe1a8394b9ce38b74e22f1686c866fbe7c3",size:"1",class:"ion-text-center"},e("ion-button",{key:"039a93a14aeb4649c38b2796ed324c3db4e2056e",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.addQuantityUnit()},e("ion-icon",{key:"1a1564ed4b95e6b96056cc8ebaa653a1f999ba2e",name:"add",slot:"start"}))),e("ion-col",{key:"dcf4a3883d8f35afb581408782452fa958abb67d",size:"1",class:"ion-text-center"},e("ion-button",{key:"d53923a0ab2ef6c7a8c0405c6780c778f94376ee",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.duplicateQuantityUnit()},e("ion-icon",{key:"7c93d730ac2da6ebea6a3674f3606690ed893bcc",slot:"start",name:"duplicate"}))),e("ion-col",{key:"6d59a0c74c16a68d0bb9e01be9187cd872212171",size:"1",class:"ion-text-center"},e("ion-button",{key:"73e3d98f2387f60a712f990249dad4057a65c26d",fill:"clear",color:"danger",disabled:this.quantityUnits.length==0,onClick:()=>this.deleteQuantityUnit()},e("ion-icon",{key:"3c849722cf95167071fa1a42a6788129fddbf91b",slot:"start",name:"trash"}))))),e("app-form-item",{key:"f88637c23d0f35c2b2b174382a868a7f9ee5c815","label-text":"ID",value:this.quantityUnit.quantityUnitId,name:"quantityUnitId","input-type":"string",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required",{name:"uniqueid",options:{type:"list",index:"quantityUnitId",list:c.getQuantityUnits()}}]}),e("app-form-item",{key:"ebdb83d09b2e5ab7bc051090d25d304e821f67a2","label-text":"Name",value:this.quantityUnit.quantityUnitName,name:"quantityUnitName","input-type":"text",multiLanguage:true,"text-rows":"1",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required"]})),e("app-modal-footer",{key:"289db94c0040b8795d567233319659a49f864554",color:r.getAppColor(),disableSave:!this.validQuantityUnit,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};b.style=f;export{b as modal_project_quantityunit};