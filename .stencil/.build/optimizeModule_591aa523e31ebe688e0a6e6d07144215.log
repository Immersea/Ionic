import{r as t,h as e}from"./p-cbe60c68.js";import{u as s,m as i,t as a,T as n,v as r}from"./p-7ea622ea.js";import{l as o}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as c,n as d}from"./p-5d4a8e1f.js";import{K as h}from"./p-6c93b3f7.js";import"./p-5d8b2afa.js";import"./p-694b8ade.js";import"./p-7ee16e8d.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";class l{constructor(t){this.id=t&&t.id?t.id:s();this.order=t&&t.order?t.order:0;this.title=t&&t.title?t.title:"";this.subtitle=t&&t.subtitle?t.subtitle:"";this.description=t&&t.description?t.description:"";this.coverURL=t&&t.coverURL?t.coverURL:null;this.link=t&&t.link?t.link:"";this.active=t&&t.active?true:false}}const p="advertising";class m{constructor(){this.advertisingObservable$=new h([])}async getAdvertisingObservable(){const t=await i.getDocumentObservable(a,p);this.advertisingDocSub=t.subscribe((t=>{this.advertisingDoc={};Object.keys(t).map((e=>{this.advertisingDoc[e]=new l(t[e])}));this.advertisingObservable$.next(this.getAdvertisingArray())}))}unsubscribeAdvertising(){this.advertisingDocSub?this.advertisingDocSub.unsubscribe():undefined}async getActiveAdvertising(){const t=await i.getDocument(a,p);this.advertisingDoc={};if(t){Object.keys(t).map((e=>{if(t[e].active){this.advertisingDoc[e]=t[e]}}))}return this.getAdvertisingArray()}getAdvertisingArray(){const t=[];Object.keys(this.advertisingDoc).map((e=>{t.push(this.advertisingDoc[e])}));return o.exports.orderBy(t,"order")}async updateAdvertising(t){this.advertisingDoc[t.id]=t;this.reorderAdvertDoc();await this.saveAdvertDoc()}reorderAdvertDoc(){let t=[];Object.keys(this.advertisingDoc).map((e=>{t.push(this.advertisingDoc[e])}));t=o.exports.orderBy(t,"order");let e=0;t.map((t=>{t.order=e;e++;this.advertisingDoc[t.id]=t}))}async saveAdvertDoc(){await i.updateDocument(a,p,this.advertisingDoc)}async removeAdvertising(t){const e=await c.create({header:n.getTransl("delete-advertising-header","Delete Advertising?"),message:n.getTransl("delete-advertising-message","This advertising will be deleted! Are you sure?"),buttons:[{text:n.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:n.getTransl("ok","OK"),handler:()=>{delete this.advertisingDoc[t.id];r.deletePhotoURLs(p,t.id);this.reorderAdvertDoc();this.saveAdvertDoc()}}]});e.present()}followAdvertisingLink(t){window.open("http://"+t.link,"_blank")}}const v=new m;const g="app-admin-advertising{}";const u=g;const f=class{constructor(e){t(this,e);this.editable=true;this.advertisingArray=[]}async componentWillLoad(){this.advertisingSub=v.advertisingObservable$.subscribe((t=>{this.advertisingArray=t}));v.getAdvertisingObservable()}async disconnectedCallback(){this.advertisingSub.unsubscribe();v.unsubscribeAdvertising()}async editAdvertising(t,e){t.stopPropagation();const s=await d.create({component:"popover-edit-advertising",componentProps:{advertising:e},event:null,translucent:true});s.onDidDismiss().then((async t=>{if(t){const e=t.data;await v.updateAdvertising(e)}}));s.present()}async removeAdvertising(t,e){t.stopPropagation();await v.removeAdvertising(e)}render(){return e("ion-content",{key:"bf82aaa672329900a525b3c743a25e4fa7c1e71e"},this.editable?e("ion-item",{button:true,onClick:t=>this.editAdvertising(t,null),color:"light"},e("ion-icon",{name:"add-circle",slot:"start",color:"beach"}),e("ion-label",null,e("my-transl",{tag:"add",text:"Add"}))):undefined,this.advertisingArray.map((t=>e("app-advertising-card",{edit:true,advertising:t,onEditEmit:e=>this.editAdvertising(e,t)}))))}};f.style=u;export{f as app_admin_advertising};