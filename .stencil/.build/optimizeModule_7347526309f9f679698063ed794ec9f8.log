import{r as t,h as e,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s}from"./p-c2915cc5.js";import{l as c}from"./p-1af05547.js";import{ay as n,aB as o,S as d,E as f,T as l}from"./p-773bd3de.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";const r="modal-project-quantityunit ion-list{width:100%}";const h=r;const b=class{constructor(e){t(this,e);this.index=0;this.quantityUnits=undefined;this.quantityUnit=undefined;this.updateView=true;this.validQuantityUnit=false}async componentWillLoad(){await this.loadQuantityUnits()}async loadQuantityUnits(){await n.downloadProjectSettings();this.quantityUnits=c.exports.cloneDeep(n.getQuantityUnits());if(this.quantityUnits&&this.quantityUnits.length>0){this.quantityUnit=this.quantityUnits[0]}else{this.addQuantityUnit()}this.validateProject()}selectType(t){this.quantityUnit=this.quantityUnits[t.detail.value];this.validateProject()}handleChange(t){const e=t.detail.name;let i=t.detail.value;if(e=="familyId"){i=i.replace(/\s+/g,"-").trim().toLowerCase()}this.quantityUnit[e]=i;this.validateProject()}validateProject(){this.validQuantityUnit=c.exports.isString(this.quantityUnit.quantityUnitId)&&c.exports.isString(this.quantityUnit.quantityUnitId);this.updateView=!this.updateView}addQuantityUnit(){this.quantityUnit=new o;this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}duplicateQuantityUnit(){this.quantityUnit=c.exports.cloneDeep(this.quantityUnit);this.quantityUnit.quantityUnitId=this.quantityUnit.quantityUnitId+"_rev.";this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}async deleteQuantityUnit(){try{this.quantityUnits.splice(this.index,1);this.index=0;this.quantityUnit=this.quantityUnits[0];this.validateProject()}catch(t){if(t)d.presentAlertError(t)}}async save(t=true){await n.uploadProjectSettings("quantityUnit",this.quantityUnits);return t?s.dismiss():true}async cancel(){return s.dismiss()}render(){return e(i,{key:"e1be42002fb3688e0e5f877fcf2a7aaf50cc26bb"},e("ion-content",{key:"41a451cbd2efab9f42cddcfea304efbe380c1486"},e("ion-grid",{key:"031e62576b8e2f8702f0e567d3df3e7a8e362cf4"},e("ion-row",{key:"a78a5b4419bbe81bc09d5939649a268b8718e1c4"},e("ion-col",{key:"6657ec760f497bc0a17eff3b409386d2838854c5"},e("ion-item",{key:"96e3129374acd8c8d01735ec73003d7e4fbb2384",lines:"none"},e("ion-select",{key:"ead9a20ad5a423f453ac8bdd7523d5c8ea76bab8",color:"trasteel",id:"selectType",interface:"action-sheet",label:l.getTransl("project_quantityunit","Project Quantity Unit"),disabled:!this.validQuantityUnit,"label-placement":"floating",onIonChange:t=>this.selectType(t),value:this.index?this.index:0},this.quantityUnits.map(((t,i)=>e("ion-select-option",{value:i},t.quantityUnitId+" | "+t.quantityUnitName.en)))))),e("ion-col",{key:"fbd8d629c008a3552e83667c2aaa87d16bd6b43b",size:"1",class:"ion-text-center"},e("ion-button",{key:"9dbb366dac28c768f7a7847f49606247b07fd63e",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.addQuantityUnit()},e("ion-icon",{key:"8830ebd107dfea7fddb846584ac3b04dcf1c0e9f",name:"add",slot:"start"}))),e("ion-col",{key:"9f7873503c36504a2e4ab34c3d969ce0de7439a7",size:"1",class:"ion-text-center"},e("ion-button",{key:"39a3cba293a92dedf0f0b8fb5a15273ef2cc435e",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.duplicateQuantityUnit()},e("ion-icon",{key:"239bd3c76ceb24cc61c4ff160882dceeec8bfec5",slot:"start",name:"duplicate"}))),e("ion-col",{key:"df5f2f9c0cabf42f46cbdfc74630ad0b60108612",size:"1",class:"ion-text-center"},e("ion-button",{key:"c913d61b061d5124462849b71bf2436913909122",fill:"clear",color:"danger",disabled:this.quantityUnits.length==0,onClick:()=>this.deleteQuantityUnit()},e("ion-icon",{key:"13b934076ced4231d5336f8f4277a616dcda681b",slot:"start",name:"trash"}))))),e("app-form-item",{key:"56dd99e0c452968759884df1ffdf54ee128d2614","label-text":"ID",value:this.quantityUnit.quantityUnitId,name:"quantityUnitId","input-type":"string",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required",{name:"uniqueid",options:{type:"list",index:"quantityUnitId",list:n.getQuantityUnits()}}]}),e("app-form-item",{key:"931b07139571a20e894d4f128916e3c70ee02732","label-text":"Name",value:this.quantityUnit.quantityUnitName,name:"quantityUnitName","input-type":"text",multiLanguage:true,"text-rows":"1",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required"]})),e("app-modal-footer",{key:"2cd39c988c58fcdc7804f375f541d088c25c53d7",color:f.getAppColor(),disableSave:!this.validQuantityUnit,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};b.style=h;export{b as modal_project_quantityunit};