import{r as e,h as t,H as i,f as a}from"./p-cbe60c68.js";import{l as s}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as c,n as o}from"./p-5d4a8e1f.js";import{T as n,U as l,R as d,aV as f}from"./p-9424d4f6.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const b="popover-new-class-activity .validation-error{text-align:center;font-size:0.7rem;color:red}";const r=b;const h=class{constructor(t){e(this,t);this.typeSelectOptions=[];this.stdConfigurations=[];this.activity=undefined;this.showDiveLocation=true;this.updateView=false;this.validActivity=false}componentWillLoad(){this.typeSelectOptions=[{tag:"theory",text:n.getTransl("theory","Theory")},{tag:"dry",text:n.getTransl("dry","Dry")},{tag:"in-water",text:n.getTransl("in-water","In Water")},{tag:"dive",text:n.getTransl("dive","Dive")}];this.stdConfigurations=s.exports.cloneDeep(l.userSettings.userConfigurations);this.validateActivity()}validateActivity(){this.validActivity=s.exports.isNumber(this.activity.day)&&s.exports.isString(this.activity.type)&&s.exports.isString(this.activity.title.tag)&&s.exports.isString(this.activity.title.text);if(this.activity.type=="dive"){this.validActivity=this.validActivity&&this.activity.divePlan!==null}this.updateView=!this.updateView}updateDay(e){this.activity.day=e;this.validateActivity()}updateType(e){if(e!="dive"&&this.activity.type=="dive"){this.activity.divePlan=null}this.activity.type=e;this.validateActivity()}updateTitle(e){let t=e.detail.value;if(e.detail.name=="tag"){t=t.toLowerCase().replace(" ","-").trim()}this.activity.title[e.detail.name]=t;this.validateActivity()}async addDivePlan(){let e=[];s.exports.forEach(this.stdConfigurations,((t,i)=>{e.push({type:"radio",label:t.stdName,value:i,checked:i==0?true:false})}));const t=await c.create({header:n.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:n.getTransl("ok","OK"),handler:async e=>{const t=await d.openModal("modal-dive-template",{selectedConfiguration:this.stdConfigurations[e],stdConfigurations:this.stdConfigurations,dive:0,user:l.userProfile});t.onDidDismiss().then((e=>{const t=e.data;if(t){this.activity.divePlan=t;this.validateActivity();this.updateView=!this.updateView}}))}},{text:n.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});t.present()}async editDivePlan(){const e=await f.presentDiveTemplateUpdate(this.activity.divePlan,0,this.showDiveLocation);if(e){this.activity.divePlan=e;this.updateView=!this.updateView}}async save(){o.dismiss(this.activity)}cancel(){o.dismiss()}render(){return t(i,{key:"179820bc65e7e331d94a81654903ec72505a4708"},t("ion-toolbar",{key:"ed3342a823a667edb82976fc9dcda98a771cea52"},t("ion-title",{key:"4c11461c03de6d5367feb7a1b9d7271bb9ef142c"},t("my-transl",{key:"79ecd40509b5687d33cf915fb89faf505fea0b24",tag:"class-activity",text:"Class Activity"}))),t("ion-item",{key:"0eae05921e55cf5c6fa96424c4c454bb2c80587d"},t("ion-label",{key:"5d17134a989748e5953a7587e382b3b165b73be2"},t("my-transl",{key:"4d86137f098216de639e8c6fec809592d2bb1444",tag:"class-day",text:"Class Day"})),t("ion-select",{key:"b94d7cbd7e8fe385a7f5aab101fb07fbed7c894e",value:this.activity.day,onIonChange:e=>this.updateDay(e.detail.value),interface:"popover"},t("ion-select-option",{key:"b789a085795195b37eb6570f448443019e7d53b6",value:1},"1"),t("ion-select-option",{key:"8e6c505b74b22e86abfebbae92d9d699ab599969",value:2},"2"),t("ion-select-option",{key:"7c67f844629c853995273570c613a4688591710a",value:3},"3"),t("ion-select-option",{key:"f76ef16e868964ea91b8cb03daad3ef5ecce615e",value:4},"4"),t("ion-select-option",{key:"7693517339e059802516dfba613d88dfb3494d39",value:5},"5"),t("ion-select-option",{key:"6e9d2ff6a6f638fdfb4246730b4fbac1e26b8e7a",value:6},"6"),t("ion-select-option",{key:"bc40fccfef9b56bb351cbf6317dd859b38ddcbb1",value:7},"7"),t("ion-select-option",{key:"034d173159fecf8e0b5400b71a491f2fd0f15b22",value:8},"8"),t("ion-select-option",{key:"c6153128148c175b5a52ecf86973b6b915e92566",value:9},"9"),t("ion-select-option",{key:"83df94b9decc6ae0442ae842ee0193ff7abd7d18",value:10},"10"))),t("ion-item",{key:"b5d5c450ee6ffe2bc289c4502d1edde54d2728a2"},t("ion-label",{key:"b517bcbc1eccf3714cfebc5c5696571785cfc6cd"},t("my-transl",{key:"5fe78f23551a109fd94c5c103bdfb232590b494e",tag:"type",text:"Type"})),t("ion-select",{key:"4738b320a940d8fd2a90ff4cf0ecc1bcf8985c38",value:this.activity.type,onIonChange:e=>this.updateType(e.detail.value),interface:"popover"},this.typeSelectOptions.map((e=>t("ion-select-option",{value:e.tag},e.text))))),t("app-form-item",{key:"b5d4b91f1760f765d5da9cf7519e9887376b1e3b","label-tag":"unique-id","label-text":"Unique ID",value:this.activity.title.tag,name:"tag","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"5a455bbe6a797b28bda7262e5f56530f03dafa61","label-tag":"title","label-text":"Title",value:this.activity.title.text,name:"text","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required"]}),this.activity.type=="dive"?this.activity.divePlan?t("ion-item",null,t("ion-label",null,this.activity.divePlan.dives[0].getDiveDetails().map((e=>t("p",null,e)))),t("ion-button",{"icon-only":true,fill:"clear",onClick:()=>this.editDivePlan()},t("ion-icon",{name:"create-outline"}))):t("ion-button",{expand:"full",onClick:()=>this.addDivePlan()},"Add Dive Plan"):undefined,t("app-modal-footer",{key:"7ce278b20b68eb543760d317cbd73826ec9189bb",disableSave:!this.validActivity,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};h.style=r;export{h as popover_new_class_activity};