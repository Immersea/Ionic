import{r as e,h as n,H as t}from"./p-cbe60c68.js";import{U as i,aE as s,z as o,T as l,w as a,a5 as r,aI as c}from"./p-736235c6.js";import{l as p}from"./p-1af05547.js";import{E as d}from"./p-46038295.js";import"./p-1819cfda.js";import"./p-e9c4f463.js";import"./p-c7ee7cfe.js";import"./p-5d4a8e1f.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-7ee16e8d.js";const u="app-user-dive-plans{}";const h=u;const f=class{constructor(n){e(this,n);this.sitesCollection=[];this.userDivePlansArray=[];this.updateView=false;this.loadingDivePlans=true}async componentWillLoad(){this.userDivePlans$=i.userDivePlans$.subscribe((async e=>{this.loadingDivePlans=false;s.resetSkeletons();if(e){this.userDivePlansArray=[];Object.keys(e).forEach((n=>{let t=e[n];t.id=n;t.date=t.dives[0].date;this.userDivePlansArray.push(t)}));this.userDivePlansArray=p.exports.orderBy(this.userDivePlansArray,"date","desc");this.filterMySites()}}));this.diveSitesList$=o.diveSitesList$.subscribe((e=>{this.sitesCollection=e;this.filterMySites()}))}disconnectedCallback(){this.userDivePlans$.unsubscribe();this.diveSitesList$.unsubscribe()}filterMySites(){if(this.sitesCollection.length>0&&this.userDivePlansArray.length>0){this.userDivePlansArray.map((e=>{e.dives.map((e=>{e.diveSite=this.sitesCollection.find((n=>n.id==e.diveSiteId));this.updateView=!this.updateView}))}))}}update(e,n,t){e.stopPropagation();s.presentDivePlanUpdate(n,t)}delete(e,n,t){e.stopPropagation();s.deleteDiveFromPlan(n,t)}addDive(e,n,t){e.stopPropagation();s.addDiveToPlan(n,t)}deleteDivePlan(e,n){e.stopPropagation();s.deleteDivePlan(n)}render(){return n(t,{key:"5f11b928dea466416479dcfbec0d642337d03ec1"},this.loadingDivePlans?[n("app-skeletons",{skeleton:"userDivePlan"}),n("app-skeletons",{skeleton:"userDivePlan"}),n("app-skeletons",{skeleton:"userDivePlan"}),n("app-skeletons",{skeleton:"userDivePlan"}),n("app-skeletons",{skeleton:"userDivePlan"})]:undefined,this.userDivePlansArray.map((e=>n("ion-card",null,n("ion-item",null,n("ion-label",null,n("h2",null,a.format(e.date,"PP")),n("p",null,e.configuration)),n("ion-button",{fill:"clear","icon-only":true,slot:"end",color:"danger",onClick:n=>this.deleteDivePlan(n,e.id)},n("ion-icon",{name:"trash-bin",slot:"end"})),n("ion-button",{fill:"clear","icon-only":true,color:d.isDecoplanner()?"gue-blue":"planner",slot:"end",onClick:n=>this.addDive(n,e.id,e.dives.length-1)},n("ion-icon",{name:"add-circle",slot:"end"}))),e.dives.map(((t,i)=>n("ion-item",{detail:true,button:true,onClick:()=>s.presentDivePlanDetails(e.id,i)},t.diveSite&&t.diveSite.coverURL?n("ion-thumbnail",{slot:"start"},n("img",{src:t.diveSite.coverURL})):undefined,n("ion-label",null,n("h3",null,a.format(t.date,"p")),t.diveSite?n("h4",null,t.diveSite.displayName):undefined,t.profilePoints.map((e=>n("p",null,e.time,"min @",e.depth,r.depthUnit," (",c.getGasName(e.gas),")")))),i>0?n("ion-button",{fill:"clear","icon-only":true,slot:"end",color:"danger",onClick:n=>this.delete(n,e.id,i)},n("ion-icon",{name:"trash",slot:"end"})):undefined,n("ion-button",{fill:"clear","icon-only":true,slot:"end",color:d.isDecoplanner()?"gue-blue":"planner",onClick:n=>this.update(n,e.id,i)},n("ion-icon",{name:"create",slot:"end"})))))))),this.userDivePlansArray.length==0?n("ion-item",null,n("ion-label",null,n("h2",null,l.getTransl("no-logbooks","No dives yet. Click on the '+' button to create your first one.")))):undefined)}};f.style=h;export{f as app_user_dive_plans};