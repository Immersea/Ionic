import{r as e,h as i,H as t,f as s}from"./p-cbe60c68.js";import{T as a,aa as d,ab as o,U as r}from"./p-30358c9d.js";import"./p-c7ee7cfe.js";import{o as c}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{S as p}from"./p-a75993af.js";import"./p-2578d979.js";import"./p-e9c4f463.js";import"./p-a9f4af61.js";import"./p-694b8ade.js";import"./p-7ee16e8d.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const h="modal-dive-trip-update ion-list{width:100%}modal-dive-trip-update ion-segment-button{--color-checked:var(--ion-color-divetrip-contrast)}";const f=h;const l=class{constructor(i){e(this,i);this.diveTripId=undefined;this.collectionId=undefined;this.organiserId=undefined;this.diveTrip=undefined;this.updateView=true;this.validTrip=false;this.titles=[{tag:"dives"},{tag:"team"},{tag:"bookings"}];this.slider=undefined}async componentWillLoad(){await this.loadDiveTrip();this.placeholder=a.getTransl("insert-title","Insert title")}async loadDiveTrip(){if(this.diveTripId){this.diveTrip=await d.getDiveTrip(this.diveTripId)}else{this.diveTrip=new o;this.diveTrip.organiser={collectionId:this.collectionId,id:this.organiserId};this.diveTrip.users={[r.userRoles.uid]:["owner"]}}}async componentDidLoad(){this.slider=new p(".slider-dive-trip",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null}}});this.validateTrip()}async addDiveTrip(e,i){this.diveTrip=await d.addDiveTrip(this.diveTrip,e,i);this.validateTrip()}removeDiveTrip(e){this.diveTrip=d.removeDiveTrip(this.diveTrip,e);this.validateTrip()}removeTripDive(e,i){this.diveTrip=d.removeTripDive(this.diveTrip,e,i);this.updateView=!this.updateView}setTitle(e){this.diveTrip.displayName=e.target.value;this.validateTrip()}validateTrip(){this.diveTrip.tripDives=n.exports.orderBy(this.diveTrip.tripDives,"divePlan.dives[0].date");this.validTrip=n.exports.isString(this.diveTrip.displayName)&&this.diveTrip.displayName.length>3&&this.diveTrip.tripDives.length>0;this.updateView=!this.updateView}async save(){await d.updateDiveTrip(this.diveTripId,this.diveTrip);return c.dismiss(false)}async cancel(){return c.dismiss(true)}render(){return i(t,{key:"d06de559fd6a0789ab132e69aea0f115c41f5dae"},i("ion-header",{key:"7edd9512559582341bb9d42007860271e9fcd2ad"},i("ion-toolbar",{key:"ff73b18f9a88e971a2dadf2cf51e17611f600533",color:"divetrip"},i("ion-title",{key:"414c3186b5a9a30831f0d32fdea095ce620cc585"},i("ion-input",{key:"34dad6e223d0c6de3b1659b82b7bf0579f0ec2a0",placeholder:this.placeholder+"...",inputmode:"text",onIonInput:e=>this.setTitle(e),value:this.diveTrip.displayName})))),i("app-header-segment-toolbar",{key:"d031d0b2135b25f8761de3661c502f32b2bb9b55",color:"divetrip",swiper:this.slider,titles:this.titles}),i("ion-content",{key:"a66f0d553769be3eb3d7e23217dffc0b747dbd25",class:"slides"},i("swiper-container",{key:"4422ae82808879483dd4e77ec21ac246811150ba",class:"slider-dive-trip swiper"},i("swiper-wrapper",{key:"116ac9306750ddd0f11cd393c579444de8e6eb50",class:"swiper-wrapper"},i("swiper-slide",{key:"a88978166a6409af59f8e6b31054849852cef75d",class:"swiper-slide"},i("ion-grid",{key:"4126ea4e0077927cae66acce7d6313ead77b95ed"},i("ion-row",{key:"2f350accee9b66906ca05bb6dcb199ae4150d45c",class:"ion-text-start"},this.diveTrip.tripDives.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4"},i("app-dive-trip-card",{tripDive:e,editable:true,updateView:this.updateView,onAddDiveEmit:()=>this.addDiveTrip(t),onRemoveDiveTripEmit:()=>this.removeDiveTrip(t),onRemoveTripDiveEmit:e=>this.removeTripDive(t,n.exports.toNumber(e.detail)),onUpdateDiveEmit:e=>this.addDiveTrip(t,n.exports.toNumber(e.detail))})))),i("ion-col",{key:"bfa4808523f08deedd336e9d4e8ed6013eb7d399","size-sm":"12","size-md":"6","size-lg":"4"},i("ion-card",{key:"91b0277967b3938a3475503137521c1e270e33b0",onClick:()=>this.addDiveTrip()},i("ion-card-content",{key:"a213e1d17dea4173c368c3a07f907edfb535b796",class:"ion-text-center"},i("ion-icon",{key:"1292ccd81724f65608c102494fceac7994f1de88",name:"add-circle-outline",style:{fontSize:"130px"}}))))))),i("swiper-slide",{key:"679f936d4a4a1fc452801ef8a476051688397ab4",class:"swiper-slide"},i("app-users-list",{key:"05bc9796d1f5942095e5d71b244180a6f9609fb9",item:this.diveTrip,editable:true,show:["owner","divemaster","instructor"]})),i("swiper-slide",{key:"5a194a8cf9874e93fc9e10b50401167eb4215453",class:"swiper-slide"},i("ion-grid",{key:"35fa81d83b4058230119971f0d39e9adbb381533"},i("ion-row",{key:"3c8053ccb5b7c39b15208290532d901df44d6604"},Object.keys(this.diveTrip.tripDives).map((e=>i("ion-col",{"size-sm":"12","size-md":"12","size-lg":"12"},i("app-dive-trip-bookings",{diveTrip:this.diveTrip,diveTripId:this.diveTripId,tripDiveIndex:n.exports.toNumber(e),editable:true})))))))))),i("app-modal-footer",{key:"3e6b1e08dcf49d7a96176c963a13af5302585350",disableSave:!this.validTrip,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return s(this)}};l.style=f;export{l as modal_dive_trip_update};