import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import{U as s,n as d,g as n,au as o,a3 as r,f as c}from"./p-30358c9d.js";import"./p-c7ee7cfe.js";import{o as f}from"./p-5d4a8e1f.js";import{l}from"./p-1af05547.js";import{S as p}from"./p-a75993af.js";import"./p-2578d979.js";import"./p-e9c4f463.js";import"./p-a9f4af61.js";import"./p-694b8ade.js";import"./p-7ee16e8d.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const h="modal-service-center-update ion-list{width:100%}";const m=h;const b=class{constructor(t){e(this,t);this.serviceCenterId=undefined;this.serviceCenter=undefined;this.updateView=true;this.validServiceCenter=false;this.divingCourses=undefined;this.tmpServiceCenterId=undefined;this.showSCId=false;this.titles=[{tag:"map"},{tag:"position"},{tag:"information"},{tag:"team"}];this.slider=undefined}async componentWillLoad(){this.userProfileSub$=s.userProfile$.subscribe((e=>{this.userProfile=new d(e)}));await this.loadServiceCenter()}async loadServiceCenter(){if(this.serviceCenterId){this.serviceCenter=await n.getServiceCenter(this.serviceCenterId);this.draggableMarkerPosition={lat:this.serviceCenter.position.geopoint.latitude,lon:this.serviceCenter.position.geopoint.longitude}}else{this.serviceCenter=new o;this.draggableMarkerPosition={}}}async componentDidLoad(){this.slider=new p(".slider-service-center",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null;this.slider.updateSize()}}});await customElements.whenDefined("app-map");this.mapElement=this.el.querySelector("#map");const e=this.el.querySelector("#map-container");e.setAttribute("style","height: "+r(this.serviceCenter,true)+"px");this.mapElement["mapLoaded"]().then((()=>{this.mapElement.triggerMapResize()}));this.mapElement.triggerMapResize();this.validateServiceCenter()}disconnectedCallback(){this.userProfileSub$.unsubscribe()}updateLocation(e){this.draggableMarkerPosition={lat:l.exports.toNumber(e.detail.lat),lon:l.exports.toNumber(e.detail.lon)};this.serviceCenter.setPosition(e.detail.lat,e.detail.lon);this.validateServiceCenter()}updateAddress(e){this.serviceCenter.setAddress(e.detail)}handleChange(e){if(e.detail.name=="facebook"||e.detail.name=="instagram"||e.detail.name=="twitter"||e.detail.name=="website"||e.detail.name=="email"){const t=l.exports.toLower(e.detail.value).split(" ").join("-");this.serviceCenter[e.detail.name]=t}else if(e.detail.name=="id"){this.setTmpId(e.detail.value)}else{this.serviceCenter[e.detail.name]=e.detail.value}this.updateView=!this.updateView;this.validateServiceCenter()}setTmpId(e){this.tmpServiceCenterId=l.exports.toLower(e).trim().split(" ").join("-").substring(0,16)}uniqueIdValid(e){if(e.detail){this.serviceCenterId=this.tmpServiceCenterId}else{this.serviceCenterId=null}}updateImageUrls(e){const t=e.detail.type;const a=e.detail.url;if(t=="photo"){this.serviceCenter.photoURL=a}else{this.serviceCenter.coverURL=a}}validateServiceCenter(){this.validServiceCenter=l.exports.isNumber(this.serviceCenter.position.geopoint.latitude)&&l.exports.isNumber(this.serviceCenter.position.geopoint.longitude)&&l.exports.isString(this.serviceCenter.displayName)&&l.exports.isString(this.serviceCenter.description)}async save(){await n.updateServiceCenter(this.serviceCenterId,this.serviceCenter,this.userProfile.uid);return f.dismiss()}async cancel(){return f.dismiss()}render(){return t(a,{key:"89db429d9a69ea9d12fc00ecc02adb8c20171efc"},t("ion-header",{key:"aca18eceb2835cd48dbb99c2a10c3f1b98eddaa6"},t("app-upload-cover",{key:"6f6fdc30d0c399d7feb60cb6b93a67d19f228f90",item:{collection:c,id:this.serviceCenterId,photoURL:this.serviceCenter.photoURL,coverURL:this.serviceCenter.coverURL},onCoverUploaded:e=>this.updateImageUrls(e)})),t("app-header-segment-toolbar",{key:"74ee47fcf7860ec1dfd533fb3794ff87e0bf5ca0",color:"servicecenter",swiper:this.slider,titles:this.titles}),t("ion-content",{key:"10fa455cdfb2d6bb91eac5fb6bc4ae5cc44a6f90",class:"slides"},t("swiper-container",{key:"f9f4670be3f4c2901af07e1acf59520c99459521",class:"slider-service-center swiper"},t("swiper-wrapper",{key:"2cc9e6b0b604d78ffb13b68391f2b31069500c4e",class:"swiper-wrapper"},t("swiper-slide",{key:"14a698bdb310ebe8f4bddb0fef5278ca196284cc",class:"swiper-slide"},t("div",{key:"a7c1408f3faf063a49371a7da8011c9e1d579060",id:"map-container"},t("app-map",{key:"9986965d4b66a233ba5b204eb4bd3fd923bfd77f",id:"map",pageId:"dive-sites",draggableMarkerPosition:this.draggableMarkerPosition,onDragMarkerEnd:e=>this.updateLocation(e)}))),t("swiper-slide",{key:"3330eb3be3be1150517c0f501a3f0f060bae9f3c",class:"swiper-slide"},t("app-coordinates",{key:"aef4d1709462db1f7f41c95a786a1c7771478e79",coordinates:this.draggableMarkerPosition,onCoordinatesEmit:e=>this.updateLocation(e),onAddressEmit:e=>this.updateAddress(e)})),t("swiper-slide",{key:"fe3d62f37c2c0ef2902695cacb384b07e036f0e5",class:"swiper-slide"},t("ion-list",{key:"cfc769071495a7038dfb16851d6def6ac7589a16",class:"ion-no-padding"},t("ion-list-header",{key:"1d9b359417c633836dd63b48fb6c9620fd35f60c"},t("my-transl",{key:"e52bd6505e2dcf64255bab5ec38629387a332b25",tag:"general-information",text:"General Information",isLabel:true})),t("app-form-item",{key:"6e42d4f226706d0ff74ce05dd1feeab11ea71af1","label-tag":"name","label-text":"Name",value:this.serviceCenter.displayName,name:"displayName","input-type":"text",onFormItemChanged:e=>this.handleChange(e),validator:["required"]}),this.showSCId?t("app-form-item",{"label-tag":"unique-id","label-text":"Unique ID",value:this.tmpServiceCenterId,name:"id","input-type":"text",onFormItemChanged:e=>this.handleChange(e),onIsValid:e=>this.uniqueIdValid(e),validator:["required",{name:"uniqueid",options:{type:c}}]}):undefined,t("app-form-item",{key:"8fac5aa32e2ca86f41ff12b70dfd5f3d0f09545f","label-tag":"description","label-text":"Description",value:this.serviceCenter.description,name:"description",textRows:10,"input-type":"text",onFormItemChanged:e=>this.handleChange(e),validator:["required"]}),t("app-form-item",{key:"f3f97117c14d70d5246fffe5fad8c7dd6b183388","label-tag":"phone","label-text":"Phone",value:this.serviceCenter.phoneNumber,name:"phoneNumber","input-type":"tel",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{key:"a44de344a44ab8cd4cec790ba09b84f067500310","label-tag":"email","label-text":"Email",value:this.serviceCenter.email,name:"email","input-type":"email",onFormItemChanged:e=>this.handleChange(e),validator:["email"]}),t("app-form-item",{key:"c332bf69df939e545cc2df02f2e48481805ef450","label-tag":"website","label-text":"Website",value:this.serviceCenter.website,name:"website","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.serviceCenter.website?t("a",{class:"ion-padding-start",href:"http://"+this.serviceCenter.website,target:"_blank"},"http://"+this.serviceCenter.website):undefined,t("app-form-item",{key:"79a0bf2931370710fd3f7623ad0e0dbc681d4fd8","label-tag":"facebook-id","label-text":"Facebook ID",value:this.serviceCenter.facebook,name:"facebook","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.serviceCenter.facebook?t("a",{class:"ion-padding-start",href:"https://www.facebook.com/"+this.serviceCenter.facebook,target:"_blank"},"https://www.facebook.com/"+this.serviceCenter.facebook):undefined,t("app-form-item",{key:"c1e3ffe2d4dff48d3ccc9efbd20d4d0cc4b5916b","label-tag":"instagram-id","label-text":"Instagram ID",value:this.serviceCenter.instagram,name:"instagram","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.serviceCenter.instagram?t("a",{class:"ion-padding-start",href:"https://www.instagram.com/"+this.serviceCenter.instagram,target:"_blank"},"https://www.instagram.com/"+this.serviceCenter.instagram):undefined,t("app-form-item",{key:"827cf333cbe9a837b64ad717ba11376e24fc49f4","label-tag":"twitter id","label-text":"Twitter ID",value:this.serviceCenter.twitter,name:"twitter","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.serviceCenter.twitter?t("a",{class:"ion-padding-start",href:"https://www.twitter.com/"+this.serviceCenter.twitter,target:"_blank"},"https://www.twitter.com/"+this.serviceCenter.twitter):undefined)),t("swiper-slide",{key:"202341bb4885aedbef6e0eb206914cce9e5de8cd",class:"swiper-slide"},t("app-users-list",{key:"5a456dd5f85865a59afa84d89a50cc8151f64881",item:this.serviceCenter,editable:true,show:["owner","editor"]}))))),t("app-modal-footer",{key:"768c45427c4191dad414e607d815f3a7aa7e0d4d",disableSave:!this.validServiceCenter,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};b.style=m;export{b as modal_service_center_update};