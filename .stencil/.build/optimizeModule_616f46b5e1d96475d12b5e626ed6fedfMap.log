{"version":3,"names":["modalQuillEditorCss","ModalQuillEditorStyle0","ModalQuillEditor","refresh","this","selectedArticle","article","languageSelected","componentWillLoad","immerseaLocation","languages","SystemService","getLanguages","map","lang","value","ops","insert","selectLanguage","initEditor","ev","editor","detail","getContents","event","content","save","modalController","dismiss","cancel","render","readOnly","h","color","Environment","getAppColor","undefined","key","mode","scrollable","onIonChange","layout","class","countryCode","label","slot","onClick","edit","emit","JSON","stringify","format","theme","onEditorInit","onEditorChange","onCancelEmit","onSaveEmit"],"sources":["src/components/common/modals/modal-quill-editor/modal-quill-editor.scss?tag=modal-quill-editor","src/components/common/modals/modal-quill-editor/modal-quill-editor.tsx"],"sourcesContent":["modal-quill-editor {\n  /* Component styles go here */\n  .ql-container {\n    height: calc(100% - 50px) !important;\n  }\n}\n","import {\n  Component,\n  Event,\n  EventEmitter,\n  h,\n  Prop,\n  State,\n  Watch,\n} from \"@stencil/core\";\nimport {ArticleMultilanguage} from \"../../../../interfaces/interfaces\";\nimport {SystemService} from \"../../../../services/common/system\";\nimport {Environment} from \"../../../../global/env\";\nimport {modalController} from \"@ionic/core\";\nimport {ImmerseaLocation} from \"../../../../interfaces/immersea/immerseaLocation\";\n\n@Component({\n  tag: \"modal-quill-editor\",\n  styleUrl: \"modal-quill-editor.scss\",\n})\nexport class ModalQuillEditor {\n  @Prop({mutable: true}) languageSelected: string = \"en\";\n  @Prop({mutable: true}) updateView = false;\n  @Prop() immerseaLocation: ImmerseaLocation;\n  @Prop() readOnly = false;\n  languages: any;\n  editor: any;\n  @State() article: ArticleMultilanguage;\n  @State() selectedArticle;\n  @Event() edit: EventEmitter<any>;\n\n  @Watch(\"updateView\")\n  refresh() {\n    this.selectedArticle = this.article[this.languageSelected];\n  }\n\n  componentWillLoad() {\n    this.article = this.immerseaLocation.article;\n    this.languages = SystemService.getLanguages();\n    if (!this.article) this.article = {};\n    this.languages.map((lang) => {\n      //set all languages\n      if (!this.article[lang.value]) {\n        this.article[lang.value] = {ops: [{insert: \"\"}]};\n      }\n    });\n    this.selectLanguage();\n  }\n\n  initEditor(ev) {\n    this.editor = ev.detail;\n  }\n\n  selectLanguage(ev?) {\n    if (ev && ev.detail.value) {\n      this.languageSelected = ev.detail.value;\n    }\n    this.refresh();\n  }\n\n  getContents(ev) {\n    if (ev.detail.event == \"text-change\" && ev.detail.content) {\n      this.article[this.languageSelected] = ev.detail.content;\n      this.refresh();\n    }\n  }\n\n  async save() {\n    return modalController.dismiss(this.article);\n  }\n\n  async cancel() {\n    return modalController.dismiss();\n  }\n\n  render() {\n    return [\n      !this.readOnly ? (\n        <ion-header>\n          <ion-toolbar color={Environment.getAppColor()}>\n            <ion-title>Editor</ion-title>\n          </ion-toolbar>\n        </ion-header>\n      ) : undefined,\n      <ion-header>\n        <ion-toolbar color={Environment.getAppColor()}>\n          <ion-segment\n            mode=\"md\"\n            scrollable\n            onIonChange={(ev) => this.selectLanguage(ev)}\n            value={this.languageSelected}\n          >\n            {this.languages.map((lang) => (\n              <ion-segment-button value={lang.value} layout=\"icon-start\">\n                <ion-icon\n                  class={\n                    \"flag-icon flag-icon-\" +\n                    (lang.countryCode == \"en\" ? \"gb\" : lang.countryCode)\n                  }\n                ></ion-icon>\n                <ion-label>{lang.label}</ion-label>\n              </ion-segment-button>\n            ))}\n          </ion-segment>\n          {this.readOnly ? (\n            <ion-button slot=\"end\" onClick={() => this.edit.emit(true)}>\n              <ion-label>EDIT</ion-label>\n            </ion-button>\n          ) : undefined}\n        </ion-toolbar>\n      </ion-header>,\n      <ion-content>\n        {!this.readOnly ? (\n          <quill-editor\n            immerseaLocation={this.immerseaLocation}\n            content={JSON.stringify(this.selectedArticle)}\n            format=\"json\"\n            theme=\"snow\"\n            onEditorInit={(ev) => this.initEditor(ev)}\n            onEditorChange={(ev) => this.getContents(ev)}\n          ></quill-editor>\n        ) : (\n          <quill-view\n            content={JSON.stringify(this.selectedArticle)}\n            format=\"json\"\n            theme=\"snow\"\n          ></quill-view>\n        )}\n      </ion-content>,\n      !this.readOnly ? (\n        <app-modal-footer\n          onCancelEmit={() => this.cancel()}\n          onSaveEmit={() => this.save()}\n        />\n      ) : undefined,\n    ];\n  }\n}\n"],"mappings":"4WAAA,MAAMA,EAAsB,4FAC5B,MAAAC,EAAeD,E,MCkBFE,EAAgB,M,0EACuB,K,gBACd,M,8CAEjB,M,sDAQnB,OAAAC,GACEC,KAAKC,gBAAkBD,KAAKE,QAAQF,KAAKG,iB,CAG3C,iBAAAC,GACEJ,KAAKE,QAAUF,KAAKK,iBAAiBH,QACrCF,KAAKM,UAAYC,EAAcC,eAC/B,IAAKR,KAAKE,QAASF,KAAKE,QAAU,GAClCF,KAAKM,UAAUG,KAAKC,IAElB,IAAKV,KAAKE,QAAQQ,EAAKC,OAAQ,CAC7BX,KAAKE,QAAQQ,EAAKC,OAAS,CAACC,IAAK,CAAC,CAACC,OAAQ,K,KAG/Cb,KAAKc,gB,CAGP,UAAAC,CAAWC,GACThB,KAAKiB,OAASD,EAAGE,M,CAGnB,cAAAJ,CAAeE,GACb,GAAIA,GAAMA,EAAGE,OAAOP,MAAO,CACzBX,KAAKG,iBAAmBa,EAAGE,OAAOP,K,CAEpCX,KAAKD,S,CAGP,WAAAoB,CAAYH,GACV,GAAIA,EAAGE,OAAOE,OAAS,eAAiBJ,EAAGE,OAAOG,QAAS,CACzDrB,KAAKE,QAAQF,KAAKG,kBAAoBa,EAAGE,OAAOG,QAChDrB,KAAKD,S,EAIT,UAAMuB,GACJ,OAAOC,EAAgBC,QAAQxB,KAAKE,Q,CAGtC,YAAMuB,GACJ,OAAOF,EAAgBC,S,CAGzB,MAAAE,GACE,MAAO,EACJ1B,KAAK2B,SACJC,EAAA,kBACEA,EAAA,eAAaC,MAAOC,EAAYC,eAC9BH,EAAA,6BAGFI,UACJJ,EAAA,cAAAK,IAAA,4CACEL,EAAA,eAAAK,IAAA,2CAAaJ,MAAOC,EAAYC,eAC9BH,EAAA,eAAAK,IAAA,2CACEC,KAAK,KACLC,WAAU,KACVC,YAAcpB,GAAOhB,KAAKc,eAAeE,GACzCL,MAAOX,KAAKG,kBAEXH,KAAKM,UAAUG,KAAKC,GACnBkB,EAAA,sBAAoBjB,MAAOD,EAAKC,MAAO0B,OAAO,cAC5CT,EAAA,YACEU,MACE,wBACC5B,EAAK6B,aAAe,KAAO,KAAO7B,EAAK6B,eAG5CX,EAAA,iBAAYlB,EAAK8B,WAItBxC,KAAK2B,SACJC,EAAA,cAAYa,KAAK,MAAMC,QAAS,IAAM1C,KAAK2C,KAAKC,KAAK,OACnDhB,EAAA,0BAEAI,YAGRJ,EAAA,eAAAK,IAAA,6CACIjC,KAAK2B,SACLC,EAAA,gBACEvB,iBAAkBL,KAAKK,iBACvBgB,QAASwB,KAAKC,UAAU9C,KAAKC,iBAC7B8C,OAAO,OACPC,MAAM,OACNC,aAAejC,GAAOhB,KAAKe,WAAWC,GACtCkC,eAAiBlC,GAAOhB,KAAKmB,YAAYH,KAG3CY,EAAA,cACEP,QAASwB,KAAKC,UAAU9C,KAAKC,iBAC7B8C,OAAO,OACPC,MAAM,WAIXhD,KAAK2B,SACJC,EAAA,oBACEuB,aAAc,IAAMnD,KAAKyB,SACzB2B,WAAY,IAAMpD,KAAKsB,SAEvBU,U","ignoreList":[]}