import{r as e,h as t,H as i,f as s}from"./p-cbe60c68.js";import{O as n,c as a,T as o}from"./p-773bd3de.js";import{l}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{m as c}from"./p-c2915cc5.js";import"./p-694b8ade.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const h="popover-new-dive-trip .validation-error{text-align:center;font-size:0.7rem;color:red}";const p=h;const r=class{constructor(t){e(this,t);this.sitesList=[];this.divingCentersList=[];this.tripDive=undefined;this.diveIndex=undefined;this.diveSite=undefined;this.updateView=false;this.noDivePlans=false;this.validTrip=false}async componentWillLoad(){this.sitesList=n.diveSitesList;this.divingCentersList=a.divingCentersList}componentDidLoad(){if(this.tripDive&&this.diveIndex>=0){this.participants=this.tripDive.numberOfParticipants;this.tripDate=this.tripDive.divePlan.dives[0].date;console.log("this.tripDate",this.tripDive,this.tripDate,this.tripDate.toISOString());this.diveSite=this.sitesList.find((e=>e.id===this.tripDive.divePlan.dives[this.diveIndex].diveSiteId));this.divingCenterId=this.tripDive.divePlan.dives[this.diveIndex].divingCenterId;this.setSelectDivePlans();this.divePlanTitle=this.tripDive.divePlan.title;this.divePlanName=this.tripDive.divePlan.configuration?this.tripDive.divePlan.configuration.stdName:null;this.surfaceInterval=this.diveIndex>0?this.tripDive.divePlan.dives[this.diveIndex].surfaceInterval:undefined;this.validateTrip()}}async openSearchSite(){const e=await c.create({component:"popover-search-dive-site",translucent:true});e.onDidDismiss().then((e=>{this.divePlanName=null;const t=e.data;this.diveSite=this.sitesList.find((e=>e.id===t));this.validateTrip();this.setSelectDivePlans()}));e.present()}setSelectDivePlans(){const e=this.el.querySelector("#selectDivePlans");const t={header:o.getTransl("dive-profile","Dive Profile")};e.interfaceOptions=t;const i=Array.from(e.getElementsByTagName("ion-select-option"));i.map((t=>{e.removeChild(t)}));if(this.diveSite.divePlans&&this.diveSite.divePlans.length>0){e.placeholder=o.getTransl("select","Select");this.diveSite.divePlans.map((t=>{const i=document.createElement("ion-select-option");i.value=t;i.textContent=t;e.appendChild(i)}));this.noDivePlans=false;e.disabled=false}else{e.placeholder=o.getTransl("no-profiles","No Dive Profiles available for this site");e.disabled=true;this.noDivePlans=true}const s=this.el.querySelector("#selectDivingCenter");const n={header:o.getTransl("diving-center","Diving Center")};s.interfaceOptions=n;const a=Array.from(s.getElementsByTagName("ion-select-option"));a.map((e=>{s.removeChild(e)}));if(this.diveSite.divingCenters&&this.diveSite.divingCenters.length>0){s.placeholder=o.getTransl("select","Select");const e=document.createElement("ion-select-option");e.value=null;e.textContent="-";s.appendChild(e);this.diveSite.divingCenters.map((e=>{const t=document.createElement("ion-select-option");const i=this.divingCentersList.find((t=>t.id===e));t.value=e;t.textContent=i.displayName;s.appendChild(t)}));s.disabled=false}else{s.placeholder=o.getTransl("no-divecenters","No Diving Centers available for this site");s.disabled=true}this.updateView=!this.updateView}updateDate(e){this.tripDate=new Date(e.detail.value);this.validateTrip()}updateSurfaceInterval(e){this.surfaceInterval=e;this.validateTrip()}updateParticipants(e){this.participants=l.exports.toNumber(e.detail.value);this.validateTrip()}updateTitle(e){this.divePlanTitle=e.detail.value;this.validateTrip()}updateDivePlanName(e){this.divePlanName=e.detail.value}updateDivingCenter(e){this.divingCenterId=e.detail.value}validateTrip(){this.validTrip=(!this.diveIndex&&!this.tripDive||this.diveIndex===0?l.exports.isDate(this.tripDate)&&l.exports.isNumber(this.participants)&&l.exports.isString(this.divePlanTitle):l.exports.isNumber(this.surfaceInterval))&&this.diveSite&&l.exports.isString(this.diveSite.id);this.updateView=!this.updateView}async save(){c.dismiss({participants:this.participants,date:this.tripDate,title:this.divePlanTitle,diveSiteId:this.diveSite.id,divingCenterId:this.divingCenterId,divePlanName:this.divePlanName,surfaceInterval:this.surfaceInterval})}cancel(){c.dismiss()}render(){return t(i,{key:"afa5ff78dbdd4a650dae057ceb327e6a24492606"},t("ion-toolbar",{key:"dc87468cad51ec15bfd3b3cf25159f4ba4481ec3"},t("ion-title",{key:"4b697238992e1fbd999a188172d039c6537e9006"},t("my-transl",{key:"e190169351119a720aeba647067c2d70a4eb7e64",tag:"dive-trip",text:"Dive Trip"}))),!this.diveIndex&&!this.tripDive||this.diveIndex===0?[t("app-form-item",{"label-tag":"date-time","label-text":"Date/Time",value:this.tripDate?this.tripDate.toISOString():null,name:"tripDate","input-type":"date",datePresentation:"date-time",lines:"inset",onFormItemChanged:e=>this.updateDate(e)}),t("app-form-item",{"label-tag":"title","label-text":"Title",value:this.divePlanTitle,name:"divePlanTitle","input-type":"text",lines:"inset",onFormItemChanged:e=>this.updateTitle(e)}),t("app-form-item",{"label-tag":"number-participants","label-text":"Max Number of Participants",value:this.participants,name:"participants","input-type":"number",lines:"inset",onFormItemChanged:e=>this.updateParticipants(e)})]:t("ion-item",null,t("ion-select",{label:o.getTransl("surface-interval","Surface Interval"),onIonChange:e=>this.updateSurfaceInterval(e.detail.value),value:this.surfaceInterval},t("ion-select-option",{value:.5},"0:30"),t("ion-select-option",{value:1},"1:00"),t("ion-select-option",{value:1.5},"1:30"),t("ion-select-option",{value:2},"2:00"),t("ion-select-option",{value:2.5},"2:30"),t("ion-select-option",{value:3},"3:00"),t("ion-select-option",{value:3.5},"3:30"),t("ion-select-option",{value:4},"4:00"),t("ion-select-option",{value:4.5},"4:30"),t("ion-select-option",{value:5},"5:00"),t("ion-select-option",{value:5.5},"5:30"),t("ion-select-option",{value:6},"6:00"),t("ion-select-option",{value:6.5},"6:30"),t("ion-select-option",{value:7},"7:00"),t("ion-select-option",{value:7.5},"7:30"),t("ion-select-option",{value:8},"8:00"),t("ion-select-option",{value:8.5},"8:30"),t("ion-select-option",{value:9},"9:00"),t("ion-select-option",{value:9.5},"9:30"),t("ion-select-option",{value:10},"10:00"),t("ion-select-option",{value:10.5},"10:30"),t("ion-select-option",{value:11},"11:00"),t("ion-select-option",{value:11.5},"11:30"),t("ion-select-option",{value:12},"12:00"))),t("ion-item",{key:"2a7947fcba868020729a4abfa3a6f97a6359bcae",button:true,onClick:()=>this.openSearchSite()},t("ion-input",{key:"c175d883b3a1d2a46a0e0509812e6350f9ebb6f8",label:o.getTransl("dive-site","Dive Site"),"label-placement":"floating",placeholder:o.getTransl("select-dive-site","Select Dive Site"),value:this.diveSite?this.diveSite.displayName:undefined}),t("ion-icon",{key:"cc4ef41852e39ade4a8903a6d75ae7db2438531d",slot:"end",name:"search-outline"})),t("ion-item",{key:"887319052a9b6485a86013e384311f1f707164f4"},t("ion-select",{key:"9714641fca2a5b6c49d31ab8ac8c47f42b9a71cc",label:o.getTransl("dive-profile","Dive Profile"),id:"selectDivePlans",onIonChange:e=>this.updateDivePlanName(e),disabled:true,value:this.divePlanName})),t("ion-item",{key:"04962cd71d538ee9499453b82317afcc90f3bed5"},t("ion-select",{key:"bd9ff0a0bfd90b25133e2aedb79058028a00cca4",label:o.getTransl("diving-center","Diving Center"),id:"selectDivingCenter",onIonChange:e=>this.updateDivingCenter(e),disabled:true,value:this.divingCenterId})),t("app-modal-footer",{key:"13b1e62ff21a1b8f3882a3bccb49f5635c01b0ae",disableSave:!this.validTrip,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return s(this)}};r.style=p;export{r as popover_new_dive_trip};