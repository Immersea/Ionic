import{r as t,h as e,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s}from"./p-c2915cc5.js";import{l as c}from"./p-1af05547.js";import{ay as n,aB as o,S as d,E as l,T as f}from"./p-26083a07.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";const r="modal-project-quantityunit ion-list{width:100%}";const h=r;const b=class{constructor(e){t(this,e);this.index=0;this.quantityUnits=undefined;this.quantityUnit=undefined;this.updateView=true;this.validQuantityUnit=false}async componentWillLoad(){await this.loadQuantityUnits()}async loadQuantityUnits(){await n.downloadProjectSettings();this.quantityUnits=c.exports.cloneDeep(n.getQuantityUnits());if(this.quantityUnits&&this.quantityUnits.length>0){this.quantityUnit=this.quantityUnits[0]}else{this.addQuantityUnit()}this.validateProject()}selectType(t){this.quantityUnit=this.quantityUnits[t.detail.value];this.validateProject()}handleChange(t){const e=t.detail.name;let i=t.detail.value;if(e=="familyId"){i=i.replace(/\s+/g,"-").trim().toLowerCase()}this.quantityUnit[e]=i;this.validateProject()}validateProject(){this.validQuantityUnit=c.exports.isString(this.quantityUnit.quantityUnitId)&&c.exports.isString(this.quantityUnit.quantityUnitId);this.updateView=!this.updateView}addQuantityUnit(){this.quantityUnit=new o;this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}duplicateQuantityUnit(){this.quantityUnit=c.exports.cloneDeep(this.quantityUnit);this.quantityUnit.quantityUnitId=this.quantityUnit.quantityUnitId+"_rev.";this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}async deleteQuantityUnit(){try{this.quantityUnits.splice(this.index,1);this.index=0;this.quantityUnit=this.quantityUnits[0];this.validateProject()}catch(t){if(t)d.presentAlertError(t)}}async save(t=true){await n.uploadProjectSettings("quantityUnit",this.quantityUnits);return t?s.dismiss():true}async cancel(){return s.dismiss()}render(){return e(i,{key:"4beaceff8186200b84935ed55d71745414173fdf"},e("ion-content",{key:"68da258e78a25cb7223d9a0d5b765fa1ae9e9ac1"},e("ion-grid",{key:"c832b7bceea8adc3fbaf9d2223b505705623c9b5"},e("ion-row",{key:"a6f6a1a3851b3a12d6bed470669186cda19a0689"},e("ion-col",{key:"8ab121cb2a0c12e94bcc7024100874e67918f4fc"},e("ion-item",{key:"c95a2072441c9bc559911bc8b44c4ecd8f96950f",lines:"none"},e("ion-select",{key:"2e1a314e4c903d0d93d24978f125fcc24efc6267",color:"trasteel",id:"selectType",interface:"action-sheet",label:f.getTransl("project_quantityunit","Project Quantity Unit"),disabled:!this.validQuantityUnit,"label-placement":"floating",onIonChange:t=>this.selectType(t),value:this.index?this.index:0},this.quantityUnits.map(((t,i)=>e("ion-select-option",{value:i},t.quantityUnitId+" | "+t.quantityUnitName.en)))))),e("ion-col",{key:"83d6cc4fb51251e0601842fddc7426b85e569907",size:"1",class:"ion-text-center"},e("ion-button",{key:"fde83bdf900e6dd1c0980a5285385e1e4c6d2d9b",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.addQuantityUnit()},e("ion-icon",{key:"ab21be22b0052500a5b283c4c5d7b9a309871b8e",name:"add",slot:"start"}))),e("ion-col",{key:"8816335bfde035a710f0c64e1464abc7db3e5262",size:"1",class:"ion-text-center"},e("ion-button",{key:"204c8fb3cfa4983bb4277c81ac30c30b9130c0a7",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.duplicateQuantityUnit()},e("ion-icon",{key:"7e043827c9a59cff49583bb26d244f084c16b8fc",slot:"start",name:"duplicate"}))),e("ion-col",{key:"76b8e28c6622234fbabcd1a5904380ef0f91310e",size:"1",class:"ion-text-center"},e("ion-button",{key:"2c3dfe394aebcb488f77f85b6475b59f0426bfaa",fill:"clear",color:"danger",disabled:this.quantityUnits.length==0,onClick:()=>this.deleteQuantityUnit()},e("ion-icon",{key:"6d080d5991989e4a6dd7148158a9cdc698881a68",slot:"start",name:"trash"}))))),e("app-form-item",{key:"7064f78fe0ff8528c41cea74112e3484f62fc39f","label-text":"ID",value:this.quantityUnit.quantityUnitId,name:"quantityUnitId","input-type":"string",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required",{name:"uniqueid",options:{type:"list",index:"quantityUnitId",list:n.getQuantityUnits()}}]}),e("app-form-item",{key:"ca85d5c2ef0862228209e393966fc4afac10bade","label-text":"Name",value:this.quantityUnit.quantityUnitName,name:"quantityUnitName","input-type":"text",multiLanguage:true,"text-rows":"1",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required"]})),e("app-modal-footer",{key:"e5371686cc9527b31df569688d93a8d9e0eae6e1",color:l.getAppColor(),disableSave:!this.validQuantityUnit,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};b.style=h;export{b as modal_project_quantityunit};