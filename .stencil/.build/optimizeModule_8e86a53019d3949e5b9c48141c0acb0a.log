import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s}from"./p-c2915cc5.js";import{l as c}from"./p-1af05547.js";import{S as d,ag as o,E as r,v as n}from"./p-c24c8a77.js";import{S as f}from"./p-a75993af.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";const p="modal-dive-certification-update ion-list{width:100%}";const l=p;const h=class{constructor(t){e(this,t);this.agencyId=undefined;this.diveCertification=undefined;this.validCert=false;this.newCert=false;this.updateView=false;this.titles=[{tag:"details"},{tag:"schedule"}];this.slider=undefined}async componentWillLoad(){this.newCert=!this.diveCertification.id;this.certGroups=d.systemPreferences.selectOptions.certificationGroups;if(this.diveCertification.activities)this.diveCertification.activities=this.diveCertification.activities.map((e=>{if(e.divePlan)e.divePlan=new o(e.divePlan);return e}))}async componentDidLoad(){this.slider=new f(".slider-dive-cert",{speed:400,spaceBetween:100,allowTouchMove:true,autoHeight:true});this.validateCert()}handleCertChange(e){if(e.detail.name=="maxDepth"||e.detail.name=="numberOfStudents"){this.diveCertification[e.detail.name]=c.exports.toNumber(e.detail.value)}else{this.diveCertification[e.detail.name]=e.detail.value}this.validateCert()}updateCertGroup(e){this.diveCertification.group=e;this.validateCert()}uniqueIdValid(e){this.validCert=this.validCert&&e.detail}updateImageUrls(e){const t=e.detail.type;const a=e.detail.url;if(t=="photo"){this.diveCertification.photoURL=a}else{this.diveCertification.coverURL=a}}validateCert(){this.validCert=c.exports.isString(this.diveCertification.id)&&c.exports.isString(this.diveCertification.name)&&this.diveCertification.numberOfStudents>0&&this.diveCertification.maxDepth>0}async save(){return s.dismiss(this.diveCertification)}async cancel(){return s.dismiss()}render(){return t(a,{key:"feb1061cfad87ac7048997360fc1d0c48492b3fa"},t("ion-header",{key:"34feebf75cd6eabe65b1c28f8f1aa23c52bc6cbc"},this.diveCertification.id?t("app-upload-cover",{item:{collection:n,id:this.agencyId+"-"+this.diveCertification.id,photoURL:this.diveCertification.photoURL,coverURL:this.diveCertification.coverURL},onCoverUploaded:e=>this.updateImageUrls(e)}):undefined),t("app-header-segment-toolbar",{key:"185ba10e36545840862ee33ae30f5e2e44a57d0f",color:r.getAppColor(),swiper:this.slider,titles:this.titles}),t("ion-content",{key:"7185cee4bf6ba7e7482f914ec332abf4d97b3c73",class:"slides"},t("swiper-container",{key:"b1e04b92b0ca90e8b9e3446204449a22b3458abe",class:"slider-dive-cert swiper"},t("swiper-wrapper",{key:"a8ec3525d3a27cbf4076e7a7abf575a54a885f28",class:"swiper-wrapper"},t("swiper-slide",{key:"4d01c742193a0165b219d3c5c6077fd0aeb30891",class:"swiper-slide"},t("ion-list",{key:"8fc11a90edf590981b7b857050c05b364e49cfa9"},t("app-form-item",{key:"cd7a2492071413593744511df36cf53ae74424ac","label-tag":"unique-id","label-text":"Unique ID",value:this.diveCertification.id,disabled:!this.newCert,name:"id","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),onIsValid:e=>this.uniqueIdValid(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"673200587a2cff6511a357fbf1b1309c0007ab9a","label-tag":"name","label-text":"Name",value:this.diveCertification.name,name:"name","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"8d1e228985cca65ddb5e76242204cf51067aaffb","label-tag":"max-depth","label-text":"Max. Depth",value:c.exports.toString(this.diveCertification.maxDepth),name:"maxDepth","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"9dd43ca2d156fcff8313b5a5d2d6b0215b6f30f5","label-tag":"max-students","label-text":"Max. number of students",value:c.exports.toString(this.diveCertification.numberOfStudents),name:"numberOfStudents","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("ion-item",{key:"4f237752ecfa0f954792da38f579a62789125792"},t("ion-label",{key:"8da3c7c53409f73c5810ca41b25c6cc92e61ddb0"},"Certification Group"),t("ion-select",{key:"4bd166edf87d0bcf368cb2369d03a0e3c1b04cc8",value:this.diveCertification.group,onIonChange:e=>this.updateCertGroup(e.detail.value),interface:"popover"},this.certGroups.map((e=>t("ion-select-option",{value:e.tag},e.text))))))),t("swiper-slide",{key:"9cfb5592316d5bca7f1c128b6c204535455bcb25",class:"swiper-slide"},t("app-dive-course-activities",{key:"1d7e06f7f3dff7179377540e0b1765aa03739b35",schedule:this.diveCertification.activities,showDiveLocation:false,onScheduleEmit:e=>this.diveCertification.activities=e.detail,editable:true}))))),t("app-modal-footer",{key:"13e25f8774a2a96a8628a58476d74ff82b91846d",disableSave:!this.validCert,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};h.style=l;export{h as modal_dive_certification_update};