{"version":3,"names":["pageChatCss","PageChatStyle0","PageChat","componentWillLoad","this","chatSub","ChatService","loadedChat$","subscribe","chat","participants","Object","keys","length","map","partId","name","title","subtitle","getOtherChatParticipants","additionalData","loadAdditionalDataItem","componentDidLoad","chatApp","document","getElementsByTagName","disconnectedCallback","unsubscribe","collectionId","DIVETRIPSCOLLECTION","additionalDataItem","TranslationService","getTransl","onclick","DiveTripsService","pushDiveTrip","showAdditionalDataItem","addParticipant","ev","addParticipants","render","h","key","color","slot","onClick","RouterService","goBack","size","undefined","fill","id","chatId"],"sources":["src/components/common/pages/chat/page-chat/page-chat.scss?tag=page-chat","src/components/common/pages/chat/page-chat/page-chat.tsx"],"sourcesContent":["page-chat {\n    /* Component styles go here */\n}\n","import {Component, h, Prop, State} from \"@stencil/core\";\nimport {RouterService} from \"../../../../../services/common/router\";\nimport {ChatService} from \"../../../../../services/common/chat\";\nimport {Subscription} from \"rxjs\";\nimport {Chat} from \"../../../../../interfaces/common/chat/chat\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\nimport {\n  DIVETRIPSCOLLECTION,\n  DiveTripsService,\n} from \"../../../../../services/udive/diveTrips\";\n\n@Component({\n  tag: \"page-chat\",\n  styleUrl: \"page-chat.scss\",\n})\nexport class PageChat {\n  @Prop() chatId: string;\n  @State() participants: number;\n  @State() chat: Chat;\n  @State() title: string;\n  @State() subtitle: string;\n  chatApp: any;\n  chatSub: Subscription;\n  @State() additionalDataItem: {\n    title: string;\n    onclick: any;\n  };\n\n  componentWillLoad() {\n    this.chatSub = ChatService.loadedChat$.subscribe((chat) => {\n      if (chat && chat.participants) {\n        this.chat = chat;\n        this.participants = Object.keys(chat.participants).length;\n        let otherParticipants = [];\n        Object.keys(this.chat.participants).map((partId) => {\n          if (partId !== ChatService.chatUser.id) {\n            otherParticipants.push(this.chat.participants[partId]);\n          }\n        });\n\n        if (this.chat.name && this.chat.name.length > 0) {\n          this.title = this.chat.name;\n          this.subtitle = ChatService.getOtherChatParticipants(\n            \"names\",\n            this.chat\n          );\n        } else {\n          this.title = ChatService.getOtherChatParticipants(\"names\", this.chat);\n          this.subtitle = null;\n        }\n        if (this.chat.additionalData) {\n          this.loadAdditionalDataItem();\n        }\n      }\n    });\n  }\n  componentDidLoad() {\n    this.chatApp = document.getElementsByTagName(\"app-chat\")[0];\n  }\n\n  disconnectedCallback() {\n    this.chatSub.unsubscribe();\n  }\n\n  async loadAdditionalDataItem() {\n    if (this.chat.additionalData.collectionId === DIVETRIPSCOLLECTION) {\n      this.additionalDataItem = {\n        title: TranslationService.getTransl(\"dive-trip\", \"Dive Trip\"),\n        onclick: DiveTripsService.pushDiveTrip,\n      };\n    }\n  }\n\n  showAdditionalDataItem() {}\n\n  addParticipant(ev) {\n    this.chatApp.addParticipants(ev);\n  }\n\n  render() {\n    return [\n      <ion-header>\n        <ion-toolbar color=\"chat\">\n          <ion-buttons slot=\"start\">\n            <ion-button onClick={() => RouterService.goBack()} icon-only>\n              <ion-icon name=\"arrow-back\"></ion-icon>\n            </ion-button>\n          </ion-buttons>\n          <ion-title>{this.title}</ion-title>\n          {this.subtitle ? (\n            <ion-title size=\"small\">{this.subtitle}</ion-title>\n          ) : undefined}\n          <ion-buttons slot=\"end\">\n            {this.additionalDataItem ? (\n              <ion-button\n                fill=\"outline\"\n                onClick={() =>\n                  this.additionalDataItem.onclick(this.chat.additionalData.id)\n                }\n              >\n                {this.additionalDataItem.title}\n                <ion-icon name=\"open-outline\" slot=\"start\"></ion-icon>\n              </ion-button>\n            ) : undefined}\n            <ion-button\n              icon-only\n              slot=\"end\"\n              onClick={(ev) => this.addParticipant(ev)}\n            >\n              <ion-icon name=\"people-outline\"></ion-icon>\n              {this.participants ? (\n                <ion-badge color=\"secondary\">{this.participants}</ion-badge>\n              ) : undefined}\n            </ion-button>\n          </ion-buttons>\n        </ion-toolbar>\n      </ion-header>,\n      <ion-content>\n        <app-chat chatId={this.chatId} />\n      </ion-content>,\n    ];\n  }\n}\n"],"mappings":"8VAAA,MAAMA,EAAc,cACpB,MAAAC,EAAeD,E,MCcFE,EAAQ,M,8KAanB,iBAAAC,GACEC,KAAKC,QAAUC,EAAYC,YAAYC,WAAWC,IAChD,GAAIA,GAAQA,EAAKC,aAAc,CAC7BN,KAAKK,KAAOA,EACZL,KAAKM,aAAeC,OAAOC,KAAKH,EAAKC,cAAcG,OAEnDF,OAAOC,KAAKR,KAAKK,KAAKC,cAAcI,KAAKC,IAAD,IAMxC,GAAIX,KAAKK,KAAKO,MAAQZ,KAAKK,KAAKO,KAAKH,OAAS,EAAG,CAC/CT,KAAKa,MAAQb,KAAKK,KAAKO,KACvBZ,KAAKc,SAAWZ,EAAYa,yBAC1B,QACAf,KAAKK,K,KAEF,CACLL,KAAKa,MAAQX,EAAYa,yBAAyB,QAASf,KAAKK,MAChEL,KAAKc,SAAW,I,CAElB,GAAId,KAAKK,KAAKW,eAAgB,CAC5BhB,KAAKiB,wB,MAKb,gBAAAC,GACElB,KAAKmB,QAAUC,SAASC,qBAAqB,YAAY,E,CAG3D,oBAAAC,GACEtB,KAAKC,QAAQsB,a,CAGf,4BAAMN,GACJ,GAAIjB,KAAKK,KAAKW,eAAeQ,eAAiBC,EAAqB,CACjEzB,KAAK0B,mBAAqB,CACxBb,MAAOc,EAAmBC,UAAU,YAAa,aACjDC,QAASC,EAAiBC,a,EAKhC,sBAAAC,GAAsB,CAEtB,cAAAC,CAAeC,GACblC,KAAKmB,QAAQgB,gBAAgBD,E,CAG/B,MAAAE,GACE,MAAO,CACLC,EAAA,cAAAC,IAAA,4CACED,EAAA,eAAAC,IAAA,2CAAaC,MAAM,QACjBF,EAAA,eAAAC,IAAA,2CAAaE,KAAK,SAChBH,EAAA,cAAAC,IAAA,2CAAYG,QAAS,IAAMC,EAAcC,SAAQ,kBAC/CN,EAAA,YAAAC,IAAA,2CAAU1B,KAAK,iBAGnByB,EAAA,aAAAC,IAAA,4CAAYtC,KAAKa,OAChBb,KAAKc,SACJuB,EAAA,aAAWO,KAAK,SAAS5C,KAAKc,UAC5B+B,UACJR,EAAA,eAAAC,IAAA,2CAAaE,KAAK,OACfxC,KAAK0B,mBACJW,EAAA,cACES,KAAK,UACLL,QAAS,IACPzC,KAAK0B,mBAAmBG,QAAQ7B,KAAKK,KAAKW,eAAe+B,KAG1D/C,KAAK0B,mBAAmBb,MACzBwB,EAAA,YAAUzB,KAAK,eAAe4B,KAAK,WAEnCK,UACJR,EAAA,cAAAC,IAAA,4DAEEE,KAAK,MACLC,QAAUP,GAAOlC,KAAKiC,eAAeC,IAErCG,EAAA,YAAAC,IAAA,2CAAU1B,KAAK,mBACdZ,KAAKM,aACJ+B,EAAA,aAAWE,MAAM,aAAavC,KAAKM,cACjCuC,cAKZR,EAAA,eAAAC,IAAA,4CACED,EAAA,YAAAC,IAAA,2CAAUU,OAAQhD,KAAKgD,U","ignoreList":[]}