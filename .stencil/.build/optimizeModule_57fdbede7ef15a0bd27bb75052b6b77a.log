import{a5 as t,aH as s}from"./p-736235c6.js";import{l as r}from"./p-1af05547.js";const e=1.382;const i=.0346;const h=1.37;const a=.03186;const n=.0238;const u=.0387;class o{constructor(s,r){this.mInternalVolume=s;this.mServicePressure=r?r:t.isMetric()?230:3300;this.universalGasConstant=t.isMetric()?.083144598:10.73;this.atmPressure=t.isMetric()?1:14}VanDerWaals_computeA(t){let s=[t.getFO2(),t.getFN2(),t.getFHe()];let a=[e,h,i];let n=0;for(let t=0;t<3;t++){for(let e=0;e<3;e++){n+=r.exports.toNumber(Math.sqrt(a[t]*a[e])*s[t]*s[e])}}return n}VanDerWaals_computeB(t){let s=[t.getFO2(),t.getFN2(),t.getFHe()];let e=[a,u,n];let i=0;for(let t=0;t<3;t++){for(let h=0;h<3;h++){i+=r.exports.toNumber(Math.sqrt(e[t]*e[h])*s[t]*s[h])}}return i}fromCapacityVdw(t,s){var r=new o(0,s);r.setVdwCapacity(t);return r}fromCapacityIdeal(t,s){var r=new o(0,s);r.setIdealCapacity(t);return r}getVdwCapacity(){return r.exports.toNumber(this.getVdwCapacityAtPressure(this.mServicePressure,new s(.21,0)))}getIdealCapacity(){return r.exports.toNumber(this.getIdealCapacityAtPressure(this.mServicePressure))}setIdealCapacity(t){this.mInternalVolume=t/this.mServicePressure}setVdwCapacity(t,e=297){var i=new s(.21,0);var h=this.VanDerWaals_computeA(i),a=this.VanDerWaals_computeB(i);var n=e*this.universalGasConstant;var u=this.mServicePressure*a+n,o=2*u,l=h*a,v=3*this.mServicePressure;var c,d=n/this.mServicePressure;var m=t/n;var p=r.exports.toNumber(m/Math.pow(10,1)/2);do{c=d;var g=this.mServicePressure*Math.pow(c,3)-u*Math.pow(c,2)+h*c-l;var w=v*Math.pow(c,2)-o*c+h;d=c-g/w}while(Math.abs(c-d)>=p);this.mInternalVolume=r.exports.toNumber(d*m)}getInternalVolume(){return this.mInternalVolume}setInternalVolume(t){this.mInternalVolume=t}getServicePressure(){return this.mServicePressure}setServicePressure(t){this.mServicePressure=t}getIdealCapacityAtPressure(t){return this.mInternalVolume*t/this.atmPressure}getIdealPressureAtCapacity(t){return t*this.atmPressure/this.mInternalVolume}getVdwCapacityAtPressure(t,s,r=297){if(t==0){return 0}var e=this.VanDerWaals_computeA(s),i=this.VanDerWaals_computeB(s);var h=r*this.universalGasConstant;var a=t*i+h,n=2*a,u=e*i,o=3*t;var l,v=h/t;var c=1/(20*this.mInternalVolume*h);do{l=v;var d=t*Math.pow(l,3)-a*Math.pow(l,2)+e*l-u;var m=o*Math.pow(l,2)-n*l+e;v=l-d/m}while(Math.abs(l-v)/c>=v*v);const p=this.mInternalVolume*h/(this.atmPressure*v);return p}getVdwPressureAtCapacity(t,s,r){var e=r*this.universalGasConstant;var i=this.mInternalVolume*e/(this.atmPressure*t),h=this.VanDerWaals_computeA(s),a=this.VanDerWaals_computeB(s);return e/(i-a)-h/Math.pow(i,2)}}class l{constructor(s,r,e,i,h,a){this.mCylinder=s;this.mMix=r;this.mPressure=e;this.mUseIdealGasLaws=i;this.mTemperature=h;this.mUnits=a?a:t.units}useIdealGasLaws(t){this.mUseIdealGasLaws=t}getMix(){return this.mMix}setMix(t){this.mMix=t}getCylinder(){return this.mCylinder}setCylinder(t){this.mCylinder=t}getPressure(){return this.mPressure}setPressure(t){this.mPressure=t}getTemperature(){return this.mTemperature}getKTemperature(){if(this.mUnits=="Imperial"){return(this.mTemperature-32)*5/9+273.15}else{return this.mTemperature+273.15}}setTemperature(t){this.mTemperature=t}getGasAmount(){if(this.mUseIdealGasLaws){return this.mCylinder.getIdealCapacityAtPressure(this.mPressure)}else{return this.mCylinder.getVdwCapacityAtPressure(this.mPressure,this.mMix,this.getKTemperature())}}getFO2(){return r.exports.round(this.mMix.getFO2(),2)}getFN2(){return r.exports.round(this.mMix.getFN2(),2)}getFHe(){return r.exports.round(this.mMix.getFHe(),2)}getO2Amount(){return this.getGasAmount()*this.getFO2()}getN2Amount(){return this.getGasAmount()*this.getFN2()}getHeAmount(){return this.getGasAmount()*this.getFHe()}drainToGasAmount(t){if(this.mUseIdealGasLaws){this.mPressure=this.mCylinder.getIdealPressureAtCapacity(t)}else{this.mPressure=this.mCylinder.getVdwPressureAtCapacity(t,this.mMix,this.getKTemperature())}return this}drainToO2Amount(t){return this.drainToGasAmount(t/this.mMix.getFO2())}drainToN2Amount(t){return this.drainToGasAmount(t/this.mMix.getFHe())}drainToHeAmount(t){return this.drainToGasAmount(t/this.mMix.getFN2())}addO2(t){return this.addGas(new s(1,0),t)}addHe(t){return this.addGas(new s(0,1),t)}addGas(t,r){var e=this.getGasAmount(),i=this.mMix.getFO2()*e+t.getFO2()*r,h=this.mMix.getFHe()*e+t.getFHe()*r,a=e+r;this.mMix=new s(i/a,h/a);if(this.mUseIdealGasLaws){this.mPressure=this.mCylinder.getIdealPressureAtCapacity(a)}else{this.mPressure=this.mCylinder.getVdwPressureAtCapacity(a,this.mMix,this.getKTemperature())}return this}topup(t,s){if(this.mMix.isEqualTo(t)){this.mPressure=s;return this}var e=.005/Math.max(t.getFO2(),t.getFHe());var i=this.mCylinder;var h=this.mMix;var a=r.exports.toInteger(this.mPressure);var n=(1-a/s)*i.getVdwCapacityAtPressure(s,t,this.getKTemperature());var u=(1-a/s)*i.getVdwCapacityAtPressure(s,h,this.getKTemperature());var o;do{var v=new l(i,h,a,this.mUseIdealGasLaws,this.getKTemperature());var c=v.addGas(t,n).getPressure()-s;v=new l(i,h,a,this.mUseIdealGasLaws,this.getKTemperature());var d=v.addGas(t,u).getPressure()-s;o=(n-u)/(c-d)*c;u=n;n-=o}while(Math.abs(o)<e);this.addGas(t,n);this.mPressure=s;return this}getForm(){let t={o2:this.mMix.getO2(),he:this.mMix.getHe(),temp:r.exports.round(r.exports.toNumber(this.getTemperature()),2),bar:r.exports.round(r.exports.toNumber(this.getPressure()),2)};return t}}export{o as C,l as G};