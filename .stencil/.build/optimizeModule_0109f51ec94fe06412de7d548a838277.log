import{r as e,h as i,f as t}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{i as a}from"./p-694b8ade.js";import{n as o}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{a4 as s,U as l,a5 as c}from"./p-83f44900.js";import{E as d}from"./p-46038295.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-1819cfda.js";import"./p-7ee16e8d.js";const r="modal-dive-configuration .scrollx{display:flex;flex-wrap:nowrap;overflow-x:auto}modal-dive-configuration .scrollx .item{flex:0 0 0 0}modal-dive-configuration .scrollx ::-webkit-scrollbar{display:none}modal-dive-configuration input{text-align:right}modal-dive-configuration .fixedLabel{min-width:80% !important;max-width:80% !important}modal-dive-configuration ion-item .item-inner{box-shadow:none !important;border-bottom:1px solid #dedede !important}modal-dive-configuration .item-input .label-md,modal-dive-configuration .item-select .label-md,modal-dive-configuration .item-datetime .label-md{color:rgb(0, 0, 0)}";const f=r;const m=class{constructor(i){e(this,i);this.validForm={name:false,depth:false,time:false,bottom:false};this.diveDataToShare=undefined;this.updateView=true;this.showSave=false}componentWillLoad(){this.screenWidth=window.screen.width;this.divePlan=this.diveDataToShare.divePlan;this.diveConfig=this.divePlan.configuration;this.orderTanks();this.ranges=this.divePlan.getParamRanges(this.diveConfig.parameters.units);let e=s.getStdGases();e=n.exports.orderBy(e,"fromDepth","asc");this.bottomGases=n.exports.filter(e,{deco:false});this.decoGases=n.exports.filter(e,{deco:true});let i=l.userSettings.userTanks;i=n.exports.orderBy(i,"volume");const t=n.exports.filter(i,{forDeco:false});const a=n.exports.filter(i,{forDeco:true});this.bottomTanks=[];t.forEach((e=>{this.bottomTanks.push(e.getTank())}));this.decoTanks=[];a.forEach((e=>{this.decoTanks.push(e.getTank())}));this.stdConfigurations=s.getStdConfigurations();this.userStdConfigurations=n.exports.cloneDeep(l.userSettings.userConfigurations)}componentDidLoad(){this.validateAll()}async addTank(e,i,t){let s={tank:t,tanksList:null,stdGasesList:null,ccr:this.diveConfig.parameters.configuration=="CCR",parameters:this.diveConfig.parameters,decoTanks:!i};if(i){s.tanksList=this.bottomTanks;s.stdGasesList=this.bottomGases}else{s.tanksList=this.decoTanks;s.stdGasesList=this.decoGases}var l=undefined;if(a("capacitor")){l="custom-mobile-popover";e=null}const c=await o.create({component:"popover-tank",event:e,translucent:true,backdropDismiss:false,cssClass:l,componentProps:s});c.present();c.onDidDismiss().then((e=>{e=e.data;if(e){let a;if(i){a=this.diveConfig.configuration.bottom}else{a=this.diveConfig.configuration.deco}if(!t){a.push(e)}else{let i=n.exports.indexOf(a,t);a.splice(i,1,e)}this.orderTanks();this.validateForm("tanks")}}))}deleteTank(e,i){let t;if(e){t=this.diveConfig.configuration.bottom}else{t=this.diveConfig.configuration.deco}t.splice(i,1);this.orderTanks()}orderTanks(){this.diveConfig.configuration.bottom=n.exports.orderBy(this.diveConfig.configuration.bottom,"gas.fromDepth");this.diveConfig.configuration.deco=n.exports.orderBy(this.diveConfig.configuration.deco,"gas.fromDepth");this.updateView=!this.updateView}updateParams(e){this.divePlan.parameters=e}save(){this.el.closest("ion-modal").dismiss(this.diveConfig)}close(){this.el.closest("ion-modal").dismiss()}inputHandler(e){this.diveConfig[e.detail.name]=e.detail.value}validateAll(){this.validForm.name=this.diveConfig.stdName.length>=3;this.validForm.depth=this.diveConfig.maxDepth>1;this.validForm.time=this.diveConfig.maxTime>1;this.validateForm("tanks");this.updateView=!this.updateView}validateForm(e,i){if(e=="name"){this.validForm.name=i}else if(e=="time"){this.validForm.time=i}else if(e=="depth"){this.validForm.depth=i}else{this.validForm.bottom=this.bottomTanks.length>0}this.showSave=this.validForm.name&&this.validForm.time&&this.validForm.depth&&this.validForm.bottom}copyConfiguration(e){this.diveConfig=e;this.validateAll()}render(){return[i("app-navbar",{key:"574ff78cf1fa9c9539cfc0e3e6ac7d2f9082303b",tag:"dive-configuration",text:"Dive Configuration",color:d.getAppColor(),modal:true}),i("ion-content",{key:"7f1276a7b4ee14ea3afb0d5ebe5738d646c7f6de"},i("ion-list",{key:"b234a959107ebaba2007eab98970edb8829a967c"},i("ion-list-header",{key:"a5dfd99492e022b4edd11bc973f641aaf6ced82c"},"Copy from standard configuration"),i("ion-row",{key:"7ee1a72508f8a1f597fb2047e13dfc171c5078b6",class:"scrollx",id:"scrollTankGas"},this.userStdConfigurations?this.userStdConfigurations.map((e=>i("ion-col",{class:"item"},i("ion-button",{shape:"round",color:d.getAppColor(),onClick:()=>this.copyConfiguration(e)},e.stdName)))):undefined,this.stdConfigurations?this.stdConfigurations.map((e=>i("ion-col",{class:"item"},i("ion-button",{shape:"round",color:"success",onClick:()=>this.copyConfiguration(e)},"DP-",e.stdName)))):undefined),i("app-form-item",{key:"747cf1415fce52ca331660dc9634863af3ea7f4c","label-tag":"configuration-name","label-text":"Configuration Name",value:this.diveConfig.stdName,name:"stdName","input-type":"text",onFormItemChanged:e=>this.inputHandler(e),validator:["required"],onIsValid:e=>this.validateForm("name",e.detail)}),i("app-form-item",{key:"5b198da8957841c0f1b336ad62f5237a7b4019bc","label-tag":"max-depth","label-text":"Max Depth (xxx)",labelReplace:{xxx:this.diveConfig.parameters.depthUnit},value:n.exports.toString(this.diveConfig.maxDepth),name:"maxDepth","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),validator:["required",{name:"minvalue",options:{min:1}}],onIsValid:e=>this.validateForm("depth",e.detail)}),i("app-form-item",{key:"9778f5d76d3c445b72c9a6412cff988abc25457b","label-tag":"max-time","label-text":"Max Time (min)",value:n.exports.toString(this.diveConfig.maxTime),name:"maxTime","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),validator:["required",{name:"minvalue",options:{min:1}}],onIsValid:e=>this.validateForm("time",e.detail)}),i("ion-list-header",{key:"a0ff84ae79e219dcfee19e628122bc02f1ece99c"},i("my-transl",{key:"3206f76935e5fbed1c43e57b0cf6aae1891741ab",tag:"tanks-configuration",text:"Tank(s) Configuration",isLabel:true})),i("ion-list-header",{key:"b64bf069158df3c3466998a7dc16e69ca511308d"},i("ion-grid",{key:"1b9b2556df397ee39096dd222f518efb363d5836",class:"ion-no-padding"},i("ion-row",{key:"c117bce879cdbcbc0b1a165e2ff170fe0c5b4d4d"},i("ion-col",{key:"bd56ec29fcc0a324b7e2b4090662c1c5ee019b54"},i("my-transl",{key:"125a4f610a5de64d047d2e5cf470c1ecd378621c",tag:"bottom",text:"Bottom",isLabel:true})),i("ion-col",{key:"cc856510801040d6e9a383bd0d5ab89c74f07759",size:"1"},i("ion-row",{key:"38f8db3fedd373bdb6fa60937d7bd1a334e92901",class:"ion-text-center"},i("ion-button",{key:"2b0d7d5457d613d2a746daa70b679703b2f3e64b","icon-only":true,fill:"clear",color:"primary",onClick:e=>this.addTank(this.screenWidth>=500?e:null,true)},i("ion-icon",{key:"86d3bb43d76f8caca47577f0cda0192640c6f046",name:"add-circle"}))))))),this.diveConfig.configuration.bottom.length>0?i("ion-grid",null,i("ion-row",{class:"ion-text-center"},this.diveConfig.configuration.bottom.map(((e,t)=>i("ion-col",{size:"12","size-sm":true},e.name?i("ion-card",null,i("ion-card-header",{class:"ion-text-center"},e.name),i("ion-card-content",{class:"ion-text-center"},i("p",null,e.gas.toString()),i("p",null,e.pressure,c.pressUnit," / ",e.getGasVolume(),c.volumeUnit)),i("ion-grid",{class:"ion-no-padding"},i("ion-row",null,i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:i=>this.addTank(this.screenWidth>=500?i:null,true,e)},i("ion-icon",{name:"create"}),i("my-transl",{tag:"edit",text:"Edit"}))),i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:()=>this.deleteTank(true,t)},i("ion-icon",{name:"trash"}),i("my-transl",{tag:"delete",text:"Delete"})))))):undefined))))):undefined,i("ion-list-header",{key:"d994ba881d0200a96463bfa38d8534ff4b7b1f43"},i("ion-grid",{key:"0f15793c95a0ccb6d1c525263fd9f2f4c54e8721",class:"ion-no-padding"},i("ion-row",{key:"669b17f1015f59cbbf049c2ab2bd8d9ec11be1cc"},i("ion-col",{key:"999395f8e4dd0e0192586449c3aef7c24909fa98"},i("my-transl",{key:"bfdcacd99844f7cb70d8dda90f95ac095c2b2f7d",tag:"deco",text:"Deco",isLabel:true})),i("ion-col",{key:"1be104ca7c208afa9ca5a6b7113dca067f114cd4",size:"1"},i("ion-row",{key:"f23c53fcce6802ced85c390027e62b46dbc94558",class:"ion-text-center"},i("ion-button",{key:"644dbeb201ed1bb3d7aa56b0ef59dfa48e0f6e75","icon-only":true,fill:"clear",color:"primary",onClick:e=>this.addTank(this.screenWidth>=500?e:null,false)},i("ion-icon",{key:"6051227fd05a1ad2955a3549367c0f755d4d25ce",name:"add-circle"}))))))),this.diveConfig.configuration.deco.length>0?i("ion-grid",{class:"ion-no-padding"},i("ion-row",{class:"ion-text-center"},this.diveConfig.configuration.deco.map(((e,t)=>i("ion-col",{size:"12","size-sm":true},e.name?i("ion-card",null,i("ion-card-header",{class:"ion-text-center"},e.name),i("ion-card-content",{class:"ion-text-center"},i("p",null,e.gas.toString()),i("p",null,e.pressure,c.pressUnit," / ",e.getGasVolume(),c.volumeUnit)),i("ion-grid",{class:"ion-no-padding"},i("ion-row",null,i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:i=>this.addTank(this.screenWidth>=500?i:null,false,e)},i("ion-icon",{name:"create"}),i("my-transl",{tag:"edit",text:"Edit"}))),i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:()=>this.deleteTank(false,t)},i("ion-icon",{name:"trash"}),i("my-transl",{tag:"delete",text:"Delete"})))))):undefined))))):undefined,i("app-decoplanner-settings",{key:"fa0313ddae9d6c2b08e21d9c105bae9688d086e1",diveDataToShare:this.diveDataToShare,onUpdateParamsEvent:e=>this.updateParams(e)}))),i("app-modal-footer",{key:"3c435827ab2725f26fab42a75a1370081bb54226",disableSave:!this.showSave,onCancelEmit:()=>this.close(),onSaveEmit:()=>this.save()})]}get el(){return t(this)}};m.style=f;export{m as modal_dive_configuration};