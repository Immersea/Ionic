{"version":3,"names":["pageDivingClassDetailsCss","PageDivingClassDetailsStyle0","PageDivingClassDetails","this","markers","tag","componentWillLoad","userSub","UserService","userProfile$","subscribe","user","userId","uid","divingClass","DivingClassesService","getDivingClass","classid","userProfile","statusTitles","active","TranslationService","getTransl","closed","cancelled","divingCourses","SystemService","getDivingCoursesForSchool","course","selectedCourse","find","agencyId","id","certificationId","selectedAgency","getDivingAgencies","organiser","collectionId","DIVESCHOOLSSCOLLECTION","selectedDivingSchool","DivingSchoolsService","getDivingSchoolDetails","instructors","Object","keys","users","includes","push","getMapDataUserDetails","componentDidLoad","slider","Swiper","speed","spaceBetween","allowTouchMove","autoHeight","disconnectedCallback","unsubscribe","render","photoURL","h","item","undefined","key","color","class","slot","onClick","RouterService","goBack","name","swiper","titles","coverURL","vertical","horizontal","style","marginTop","fabButtonTopMarginString","src","displayName","location","display_name","text","status","map","instructor","comments","marginLeft","marginRight","divingClassId"],"sources":["src/components/udive/pages/diving-class/page-diving-class-details/page-diving-class-details.scss?tag=page-diving-class-details","src/components/udive/pages/diving-class/page-diving-class-details/page-diving-class-details.tsx"],"sourcesContent":["page-diving-class-details {\n  ion-list {\n    width: 100%;\n  }\n  app-diving-class-schedule {\n    width: 100%;\n  }\n  ion-segment-button {\n    --color-checked: var(--ion-color-divingclass-contrast);\n  }\n}\n","import {Component, h, Prop, State, Element} from \"@stencil/core\";\nimport {Marker} from \"../../../../../interfaces/interfaces\";\nimport {RouterService} from \"../../../../../services/common/router\";\nimport {Subscription} from \"rxjs\";\nimport {UserService} from \"../../../../../services/common/user\";\nimport {\n  DivingClass,\n  Agency,\n} from \"../../../../../interfaces/udive/diving-class/divingClass\";\nimport {DivingClassesService} from \"../../../../../services/udive/divingClasses\";\nimport {SystemService} from \"../../../../../services/common/system\";\nimport {fabButtonTopMarginString} from \"../../../../../helpers/utils\";\nimport {MapDataDivingSchool} from \"../../../../../interfaces/udive/diving-school/divingSchool\";\nimport {\n  DivingSchoolsService,\n  DIVESCHOOLSSCOLLECTION,\n} from \"../../../../../services/udive/divingSchools\";\nimport {MapDataUserPubicProfile} from \"../../../../../interfaces/common/user/user-public-profile\";\nimport Swiper from \"swiper\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\n\n@Component({\n  tag: \"page-diving-class-details\",\n  styleUrl: \"page-diving-class-details.scss\",\n})\nexport class PageDivingClassDetails {\n  @Element() el: HTMLElement;\n  @Prop() classid: string;\n  @State() divingClass: DivingClass;\n  @State() titles = [{tag: \"details\"}, {tag: \"schedule\"}, {tag: \"bookings\"}];\n  @State() slider: Swiper;\n  markers: Marker[] = [];\n  mapElement: HTMLAppMapElement;\n  userSub: Subscription;\n  @State() userId: string;\n  @State() selectedCourse: any;\n  @State() selectedAgency: Agency;\n  @State() selectedDivingSchool: MapDataDivingSchool;\n  @State() instructors: MapDataUserPubicProfile[];\n  statusTitles: {\n    active: string;\n    closed: string;\n    cancelled: string;\n  };\n\n  async componentWillLoad() {\n    this.userSub = UserService.userProfile$.subscribe((user) => {\n      this.userId = user && user.uid ? user.uid : null;\n    });\n    this.divingClass = await DivingClassesService.getDivingClass(this.classid);\n    this.userId =\n      UserService.userProfile && UserService.userProfile.uid\n        ? UserService.userProfile.uid\n        : null;\n\n    this.statusTitles = {\n      active: TranslationService.getTransl(\"active\", \"Active\"),\n      closed: TranslationService.getTransl(\"closed\", \"Closed\"),\n      cancelled: TranslationService.getTransl(\"cancelled\", \"Cancelled\"),\n    };\n\n    const divingCourses = await SystemService.getDivingCoursesForSchool();\n    //select diving class course\n    if (this.divingClass && this.divingClass.course) {\n      this.selectedCourse = divingCourses.find(\n        (course) =>\n          course.agencyId === this.divingClass.course.agencyId &&\n          course.id === this.divingClass.course.certificationId\n      );\n    }\n    this.selectedAgency = (await SystemService.getDivingAgencies())[\n      this.selectedCourse.agencyId\n    ];\n    if (this.divingClass.organiser.collectionId === DIVESCHOOLSSCOLLECTION)\n      this.selectedDivingSchool = DivingSchoolsService.getDivingSchoolDetails(\n        this.divingClass.organiser.id\n      );\n    this.instructors = [];\n    for (let userId of Object.keys(this.divingClass.users)) {\n      if (this.divingClass.users[userId].includes(\"instructor\")) {\n        this.instructors.push(await UserService.getMapDataUserDetails(userId));\n      }\n    }\n  }\n\n  async componentDidLoad() {\n    this.slider = new Swiper(\".slider-diving-class\", {\n      speed: 400,\n      spaceBetween: 100,\n      allowTouchMove: true,\n      autoHeight: true,\n    });\n  }\n\n  disconnectedCallback() {\n    this.userSub.unsubscribe();\n  }\n\n  render() {\n    return [\n      this.selectedCourse && this.selectedCourse.photoURL ? (\n        <ion-header>\n          <app-item-cover item={this.selectedCourse} />\n        </ion-header>\n      ) : undefined,\n      <ion-header>\n        <ion-toolbar\n          color=\"divingclass\"\n          class={\n            this.selectedCourse && this.selectedCourse.photoURL\n              ? \"no-safe-padding\"\n              : undefined\n          }\n        >\n          <ion-buttons slot=\"start\">\n            {!this.selectedCourse ? (\n              <ion-button onClick={() => RouterService.goBack()} icon-only>\n                <ion-icon name=\"arrow-back\"></ion-icon>\n              </ion-button>\n            ) : undefined}\n          </ion-buttons>\n          <ion-title>{this.divingClass.name}</ion-title>\n        </ion-toolbar>\n      </ion-header>,\n\n      <app-header-segment-toolbar\n        color=\"divingclass\"\n        swiper={this.slider}\n        titles={this.titles}\n      ></app-header-segment-toolbar>,\n      <ion-content class=\"slides\">\n        {this.selectedCourse && this.selectedCourse.coverURL ? (\n          <ion-fab\n            vertical=\"top\"\n            horizontal=\"start\"\n            slot=\"fixed\"\n            style={{marginTop: fabButtonTopMarginString(2)}}\n          >\n            <ion-fab-button\n              onClick={() => RouterService.goBack()}\n              class=\"fab-icon\"\n            >\n              <ion-icon name=\"arrow-back-circle-outline\"></ion-icon>\n            </ion-fab-button>\n          </ion-fab>\n        ) : undefined}\n        <swiper-container class=\"slider-diving-class swiper\">\n          <swiper-wrapper class=\"swiper-wrapper\">\n            <swiper-slide class=\"swiper-slide\">\n              <ion-list>\n                {this.selectedDivingSchool ? (\n                  <ion-item>\n                    <ion-avatar slot=\"start\">\n                      <img src={this.selectedDivingSchool.photoURL}></img>\n                    </ion-avatar>\n                    <ion-label>\n                      {this.selectedDivingSchool.displayName}\n                    </ion-label>\n                  </ion-item>\n                ) : undefined}\n                {this.selectedAgency ? (\n                  <ion-item>\n                    <ion-avatar slot=\"start\">\n                      <img src={this.selectedAgency.photoURL}></img>\n                    </ion-avatar>\n                    <ion-label>{this.selectedAgency.name}</ion-label>\n                  </ion-item>\n                ) : undefined}\n                {this.selectedCourse ? (\n                  <ion-item>\n                    <ion-avatar slot=\"start\">\n                      <img src={this.selectedCourse.photoURL}></img>\n                    </ion-avatar>\n                    <ion-label>{this.selectedCourse.name}</ion-label>\n                  </ion-item>\n                ) : undefined}\n                <ion-item>\n                  <ion-icon slot=\"start\" name=\"navigate-outline\"></ion-icon>\n                  <ion-label>\n                    {this.divingClass.location.display_name}\n                  </ion-label>\n                </ion-item>\n                <ion-item>\n                  <ion-icon slot=\"start\" name=\"scan-outline\"></ion-icon>\n                  <ion-label>\n                    <my-transl tag=\"status\" text=\"Status\"></my-transl>\n                  </ion-label>\n                  <ion-note slot=\"end\">\n                    {this.statusTitles[this.divingClass.status]}\n                  </ion-note>\n                </ion-item>\n                <ion-list-header>\n                  <my-transl tag=\"instructor\" text=\"Instructor\" />\n                </ion-list-header>\n                {this.instructors.map((instructor) => (\n                  <ion-item>\n                    {instructor.photoURL ? (\n                      <ion-avatar slot=\"start\">\n                        <img src={instructor.photoURL}></img>\n                      </ion-avatar>\n                    ) : (\n                      <ion-icon slot=\"start\" name=\"person\"></ion-icon>\n                    )}\n                    <ion-label>{instructor.displayName}</ion-label>\n                  </ion-item>\n                ))}\n                {this.divingClass.comments\n                  ? [\n                      <ion-list-header>\n                        <my-transl tag=\"comments\" text=\"Comments\" />\n                      </ion-list-header>,\n                      <ion-item>\n                        <ion-label class=\"ion-text-wrap\">\n                          {this.divingClass.comments}\n                        </ion-label>\n                      </ion-item>,\n                    ]\n                  : undefined}\n              </ion-list>\n            </swiper-slide>\n            <swiper-slide class=\"swiper-slide\">\n              <app-diving-class-schedule divingClass={this.divingClass} />\n            </swiper-slide>\n            <swiper-slide class=\"swiper-slide\">\n              <ion-grid>\n                <ion-row class=\"ion-text-start\">\n                  {!this.userId ? (\n                    <div\n                      style={{\n                        marginTop: \"10%\",\n                        marginLeft: \"auto\",\n                        marginRight: \"auto\",\n                      }}\n                    >\n                      <ion-card>\n                        <ion-card-header>\n                          <ion-card-title>\n                            <my-transl\n                              tag=\"please-login\"\n                              text=\"Please login to view this page\"\n                            />\n                          </ion-card-title>\n                        </ion-card-header>\n                      </ion-card>\n                    </div>\n                  ) : (\n                    <app-dive-class-bookings\n                      divingClass={this.divingClass}\n                      divingClassId={this.classid}\n                    />\n                  )}\n                </ion-row>\n              </ion-grid>\n            </swiper-slide>\n          </swiper-wrapper>\n        </swiper-container>\n      </ion-content>,\n    ];\n  }\n}\n"],"mappings":"qeAAA,MAAMA,EAA4B,mNAClC,MAAAC,EAAeD,E,MCwBFE,EAAsB,M,yBAMjCC,KAAAC,QAAoB,G,8DAFF,CAAC,CAACC,IAAK,WAAY,CAACA,IAAK,YAAa,CAACA,IAAK,a,uKAgB9D,uBAAMC,GACJH,KAAKI,QAAUC,EAAYC,aAAaC,WAAWC,IACjDR,KAAKS,OAASD,GAAQA,EAAKE,IAAMF,EAAKE,IAAM,IAAI,IAElDV,KAAKW,kBAAoBC,EAAqBC,eAAeb,KAAKc,SAClEd,KAAKS,OACHJ,EAAYU,aAAeV,EAAYU,YAAYL,IAC/CL,EAAYU,YAAYL,IACxB,KAENV,KAAKgB,aAAe,CAClBC,OAAQC,EAAmBC,UAAU,SAAU,UAC/CC,OAAQF,EAAmBC,UAAU,SAAU,UAC/CE,UAAWH,EAAmBC,UAAU,YAAa,cAGvD,MAAMG,QAAsBC,EAAcC,4BAE1C,GAAIxB,KAAKW,aAAeX,KAAKW,YAAYc,OAAQ,CAC/CzB,KAAK0B,eAAiBJ,EAAcK,MACjCF,GACCA,EAAOG,WAAa5B,KAAKW,YAAYc,OAAOG,UAC5CH,EAAOI,KAAO7B,KAAKW,YAAYc,OAAOK,iB,CAG5C9B,KAAK+B,sBAAwBR,EAAcS,qBACzChC,KAAK0B,eAAeE,UAEtB,GAAI5B,KAAKW,YAAYsB,UAAUC,eAAiBC,EAC9CnC,KAAKoC,qBAAuBC,EAAqBC,uBAC/CtC,KAAKW,YAAYsB,UAAUJ,IAE/B7B,KAAKuC,YAAc,GACnB,IAAK,IAAI9B,KAAU+B,OAAOC,KAAKzC,KAAKW,YAAY+B,OAAQ,CACtD,GAAI1C,KAAKW,YAAY+B,MAAMjC,GAAQkC,SAAS,cAAe,CACzD3C,KAAKuC,YAAYK,WAAWvC,EAAYwC,sBAAsBpC,G,GAKpE,sBAAMqC,GACJ9C,KAAK+C,OAAS,IAAIC,EAAO,uBAAwB,CAC/CC,MAAO,IACPC,aAAc,IACdC,eAAgB,KAChBC,WAAY,M,CAIhB,oBAAAC,GACErD,KAAKI,QAAQkD,a,CAGf,MAAAC,GACE,MAAO,CACLvD,KAAK0B,gBAAkB1B,KAAK0B,eAAe8B,SACzCC,EAAA,kBACEA,EAAA,kBAAgBC,KAAM1D,KAAK0B,kBAE3BiC,UACJF,EAAA,cAAAG,IAAA,4CACEH,EAAA,eAAAG,IAAA,2CACEC,MAAM,cACNC,MACE9D,KAAK0B,gBAAkB1B,KAAK0B,eAAe8B,SACvC,kBACAG,WAGNF,EAAA,eAAAG,IAAA,2CAAaG,KAAK,UACd/D,KAAK0B,eACL+B,EAAA,cAAYO,QAAS,IAAMC,EAAcC,SAAQ,kBAC/CT,EAAA,YAAUU,KAAK,gBAEfR,WAENF,EAAA,aAAAG,IAAA,4CAAY5D,KAAKW,YAAYwD,QAIjCV,EAAA,8BAAAG,IAAA,2CACEC,MAAM,cACNO,OAAQpE,KAAK+C,OACbsB,OAAQrE,KAAKqE,SAEfZ,EAAA,eAAAG,IAAA,2CAAaE,MAAM,UAChB9D,KAAK0B,gBAAkB1B,KAAK0B,eAAe4C,SAC1Cb,EAAA,WACEc,SAAS,MACTC,WAAW,QACXT,KAAK,QACLU,MAAO,CAACC,UAAWC,EAAyB,KAE5ClB,EAAA,kBACEO,QAAS,IAAMC,EAAcC,SAC7BJ,MAAM,YAENL,EAAA,YAAUU,KAAK,gCAGjBR,UACJF,EAAA,oBAAAG,IAAA,2CAAkBE,MAAM,8BACtBL,EAAA,kBAAAG,IAAA,2CAAgBE,MAAM,kBACpBL,EAAA,gBAAAG,IAAA,2CAAcE,MAAM,gBAClBL,EAAA,YAAAG,IAAA,4CACG5D,KAAKoC,qBACJqB,EAAA,gBACEA,EAAA,cAAYM,KAAK,SACfN,EAAA,OAAKmB,IAAK5E,KAAKoC,qBAAqBoB,YAEtCC,EAAA,iBACGzD,KAAKoC,qBAAqByC,cAG7BlB,UACH3D,KAAK+B,eACJ0B,EAAA,gBACEA,EAAA,cAAYM,KAAK,SACfN,EAAA,OAAKmB,IAAK5E,KAAK+B,eAAeyB,YAEhCC,EAAA,iBAAYzD,KAAK+B,eAAeoC,OAEhCR,UACH3D,KAAK0B,eACJ+B,EAAA,gBACEA,EAAA,cAAYM,KAAK,SACfN,EAAA,OAAKmB,IAAK5E,KAAK0B,eAAe8B,YAEhCC,EAAA,iBAAYzD,KAAK0B,eAAeyC,OAEhCR,UACJF,EAAA,YAAAG,IAAA,4CACEH,EAAA,YAAAG,IAAA,2CAAUG,KAAK,QAAQI,KAAK,qBAC5BV,EAAA,aAAAG,IAAA,4CACG5D,KAAKW,YAAYmE,SAASC,eAG/BtB,EAAA,YAAAG,IAAA,4CACEH,EAAA,YAAAG,IAAA,2CAAUG,KAAK,QAAQI,KAAK,iBAC5BV,EAAA,aAAAG,IAAA,4CACEH,EAAA,aAAAG,IAAA,2CAAW1D,IAAI,SAAS8E,KAAK,YAE/BvB,EAAA,YAAAG,IAAA,2CAAUG,KAAK,OACZ/D,KAAKgB,aAAahB,KAAKW,YAAYsE,UAGxCxB,EAAA,mBAAAG,IAAA,4CACEH,EAAA,aAAAG,IAAA,2CAAW1D,IAAI,aAAa8E,KAAK,gBAElChF,KAAKuC,YAAY2C,KAAKC,GACrB1B,EAAA,gBACG0B,EAAW3B,SACVC,EAAA,cAAYM,KAAK,SACfN,EAAA,OAAKmB,IAAKO,EAAW3B,YAGvBC,EAAA,YAAUM,KAAK,QAAQI,KAAK,WAE9BV,EAAA,iBAAY0B,EAAWN,gBAG1B7E,KAAKW,YAAYyE,SACd,CACE3B,EAAA,uBACEA,EAAA,aAAWvD,IAAI,WAAW8E,KAAK,cAEjCvB,EAAA,gBACEA,EAAA,aAAWK,MAAM,iBACd9D,KAAKW,YAAYyE,YAIxBzB,YAGRF,EAAA,gBAAAG,IAAA,2CAAcE,MAAM,gBAClBL,EAAA,6BAAAG,IAAA,2CAA2BjD,YAAaX,KAAKW,eAE/C8C,EAAA,gBAAAG,IAAA,2CAAcE,MAAM,gBAClBL,EAAA,YAAAG,IAAA,4CACEH,EAAA,WAAAG,IAAA,2CAASE,MAAM,mBACX9D,KAAKS,OACLgD,EAAA,OACEgB,MAAO,CACLC,UAAW,MACXW,WAAY,OACZC,YAAa,SAGf7B,EAAA,gBACEA,EAAA,uBACEA,EAAA,sBACEA,EAAA,aACEvD,IAAI,eACJ8E,KAAK,uCAOfvB,EAAA,2BACE9C,YAAaX,KAAKW,YAClB4E,cAAevF,KAAKc,gB","ignoreList":[]}