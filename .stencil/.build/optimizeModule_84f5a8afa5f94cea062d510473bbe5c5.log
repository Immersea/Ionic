import{r as e,h as t,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s,a as n}from"./p-c2915cc5.js";import{m as o,aw as l,p as d,E as c}from"./p-773bd3de.js";import{T as r}from"./p-1d025719.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1af05547.js";import"./p-e9c4f463.js";class m{getUserRoles(){return["registered","translator","superAdmin"]}}const h=new m;const f="modal-edit-user-roles ion-list{width:100%}";const b=f;const p=class{constructor(t){e(this,t);this.uid=undefined;this.userRoles=undefined;this.updateView=false}async componentWillLoad(){const e=await o.getDocument(l,this.uid);this.userRoles=new d(e)}async save(){await o.updateDocument(l,this.uid,this.userRoles);s.dismiss()}async cancel(){s.dismiss()}async presentActionSheet(){let e=[];let t=[];if(c.isTrasteel()){t=r.getUserRoles()}else if(c.isDecoplanner()||c.isUdive()){t=h.getUserRoles()}t.forEach((t=>{if(!this.userRoles.roles.includes(t)){e.push({text:t,handler:()=>{this.userRoles.roles.push(t);this.updateView=!this.updateView}})}}));e.push({text:"Close",icon:"close",role:"cancel",handler:()=>{}});const i=await n.create({header:"Add",buttons:e});await i.present()}updateLicense(e,t){this.userRoles.licences[e]=t.detail.checked;this.updateView=!this.updateView}handleChange(e){if(e.detail.name=="fromDate"){this.userRoles.licences.trial.fromDate=new Date(e.detail.value)}else{this.userRoles.licences.trial[e.detail.name]=e.detail.value}this.updateView=!this.updateView}deleteRole(e){const t=this.itemSliding.getElementsByClassName("item-sliding-"+e)[0];t.closeOpened();this.userRoles.roles.splice(e,1);this.updateView=!this.updateView}render(){return t(i,{key:"263d4ce0d361689a1dcf3fc333aaa652aa51c474"},t("ion-header",{key:"53e07eb0e418640194dbea6e1e9d0aba5d6825e2"},t("ion-toolbar",{key:"60d79039f7e1776f2e9cbfd6f946cf7457bfec0e",color:c.getAppColor()},t("ion-title",{key:"d6e102b8a62ef88dc710dc3d5b843af48db7d83d"},"User Roles Manager"))),t("ion-content",{key:"134c555e43115c483520d9166b3b28ad0a9457b8"},t("ion-list",{key:"a70e66c625aecfc086cb346fc768b54820a40477"},t("ion-item",{key:"7e63a9d8bbdb41ed434d344dd8a74d129d9c6e29"},"uid: ",this.userRoles.uid),t("ion-item",{key:"42839028982d8b86e722e19700733433bd8dbf5a"},"email: ",this.userRoles.email),!c.isTrasteel&&Object.keys(this.userRoles.licences).length>0?[t("ion-item-divider",null,"User Licences"),Object.keys(this.userRoles.licences).map((e=>e=="trial"?[t("ion-item-divider",null,t("ion-label",null,"Trial")),t("app-form-item",{"label-tag":"duration","label-text":"Duration",value:this.userRoles.licences.trial.duration,name:"duration","input-type":"number",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{"label-tag":"fromDate","label-text":"From Date",value:this.userRoles.licences.trial.fromDate!==null?this.userRoles.licences.trial.fromDate.toISOString():(new Date).toISOString(),name:"fromDate","input-type":"date",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{"label-tag":"level","label-text":"Level",value:this.userRoles.licences.trial.level,name:"level","input-type":"string",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("ion-item",null,t("ion-label",null,t("p",null,"Trial Days:"," ",this.userRoles.licences.trialDays())))]:[t("ion-item",null,t("ion-label",null,e),t("ion-toggle",{slot:"end",onIonChange:t=>this.updateLicense(e,t),checked:this.userRoles.licences[e]}))]))]:null),t("ion-list",{key:"1a9bd78fc6604f6165343080b628e13c8d3744f2"},t("ion-item-divider",{key:"dd0b4fe327875dec63c5758fc82e97c625c60c97"},"User Roles"),this.userRoles.roles.map(((e,i)=>t("ion-item-sliding",{class:"item-sliding-"+i},t("ion-item",null,t("ion-label",null,e)),t("ion-item-options",null,t("ion-item-option",{color:"danger",onClick:()=>this.deleteRole(i)},"Delete"))))),t("ion-item",{key:"a708a2a2edeabcd900a251082c234f37b406d9a1",button:true,onClick:()=>this.presentActionSheet()},t("ion-icon",{key:"e31a560dffc0d4841af954ba29f32295d6031603",name:"add"}),t("ion-label",{key:"ba49ddedfe2ca8f8a14ba599bd8c7285d63cdd04"},"Add")))),t("app-modal-footer",{key:"7f408d9e18b6c18e136d95ec90bf1b7355731d63",color:c.getAppColor(),onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get itemSliding(){return a(this)}};p.style=b;export{p as modal_edit_user_roles};