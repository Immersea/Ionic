{"version":3,"names":["appMapPopupCss","AppMapPopupStyle0","AppMapPopup","componentWillLoad","this","propObject","JSON","parse","properties","item","mapElement","el","closest","userRoles","UserService","setLinesForItem","disconnectedCallback","removeLinesForItem","collection","DIVECENTERSSCOLLECTION","diveSites","length","MapDataDivingCenter","pointsArray","forEach","async","siteId","diveSite","DiveSitesService","getDiveSitesDetails","push","DIVESITESCOLLECTION","divingCenters","MapDataDiveSite","centerId","divingCenter","DivingCentersService","getDivingCenterDetails","openModal","USERPUBLICPROFILECOLLECTION","presentUserDetails","id","presentDiveSiteDetails","presentDivingCenterDetails","DIVECOMMUNITIESCOLLECTION","DiveCommunitiesService","presentDiveCommunityDetails","DIVESCHOOLSSCOLLECTION","DivingSchoolsService","presentDivingSchoolDetails","SERVICECENTERSCOLLECTION","ServiceCentersService","presentServiceCenterDetails","CUSTOMERSCOLLECTION","CustomersService","presentCustomerDetails","planDive","editModal","presentDiveSiteUpdate","presentDivingCenterUpdate","presentDiveCommunityUpdate","presentDivingSchoolUpdate","presentServiceCenterUpdate","deleteDiveSite","deleteDivingCenter","deleteDiveCommunity","deleteDivingSchool","deleteServiceCenter","render","h","Host","key","coverURL","class","style","backgroundImage","undefined","photoURL","src","displayName","expand","fill","color","onClick","tag","text","Environment","isTrasteel","isSuperAdmin","delete"],"sources":["src/components/common/app/map/app-map-popup/app-map-popup.scss?tag=app-map-popup","src/components/common/app/map/app-map-popup/app-map-popup.tsx"],"sourcesContent":["app-map-popup {\n  .margin {\n    margin-bottom: 10px;\n  }\n  .center {\n    text-align: center;\n  }\n  h2 {\n    padding-left: 5px;\n    padding-right: 5px;\n  }\n  ion-thumbnail {\n    position: relative;\n    margin-top: -50px;\n    margin-bottom: 0;\n    margin-right: auto;\n    margin-left: auto;\n    width: 50px;\n    height: 50px;\n    img {\n      border-radius: 50%;\n      padding: 0.08em;\n      border: solid 0.25em lightsteelblue;\n      background-color: white;\n    }\n  }\n  .cover {\n    position: relative;\n    background-color: lightblue;\n    background-size: cover;\n    background-position: center;\n    background-repeat: no-repeat;\n    overflow: hidden;\n    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);\n    width: 100%;\n    height: 80px;\n  }\n}\n","import { Component, h, Prop, Host, Element } from \"@stencil/core\";\nimport {\n  UserService,\n  USERPUBLICPROFILECOLLECTION,\n} from \"../../../../../services/common/user\";\nimport {\n  DiveSitesService,\n  DIVESITESCOLLECTION,\n} from \"../../../../../services/udive/diveSites\";\nimport { UserRoles } from \"../../../../../interfaces/common/user/user-roles\";\nimport {\n  DivingCentersService,\n  DIVECENTERSSCOLLECTION,\n} from \"../../../../../services/udive/divingCenters\";\nimport {\n  DivingSchoolsService,\n  DIVESCHOOLSSCOLLECTION,\n} from \"../../../../../services/udive/divingSchools\";\nimport {\n  ServiceCentersService,\n  SERVICECENTERSCOLLECTION,\n} from \"../../../../../services/udive/serviceCenters\";\nimport { MapDataDivingCenter } from \"../../../../../interfaces/udive/diving-center/divingCenter\";\nimport { MapDataDiveSite } from \"../../../../../interfaces/udive/dive-site/diveSite\";\nimport {\n  DIVECOMMUNITIESCOLLECTION,\n  DiveCommunitiesService,\n} from \"../../../../../services/udive/diveCommunities\";\nimport {\n  CUSTOMERSCOLLECTION,\n  CustomersService,\n} from \"../../../../../services/trasteel/crm/customers\";\nimport { Environment } from \"../../../../../global/env\";\n@Component({\n  tag: \"app-map-popup\",\n  styleUrl: \"app-map-popup.scss\",\n})\nexport class AppMapPopup {\n  @Element() el: HTMLElement;\n  @Prop() properties: string; //comes from a JSON object\n  userRoles: UserRoles;\n  mapElement: HTMLAppMapElement;\n  propObject: any;\n\n  componentWillLoad() {\n    this.propObject = JSON.parse(this.properties);\n    this.propObject.item = JSON.parse(this.propObject.item);\n    this.mapElement = this.el.closest(\"app-map\");\n    this.userRoles = UserService.userRoles;\n    this.setLinesForItem();\n  }\n\n  disconnectedCallback() {\n    this.removeLinesForItem();\n  }\n\n  setLinesForItem() {\n    if (\n      this.propObject.collection == DIVECENTERSSCOLLECTION &&\n      this.propObject.item.diveSites &&\n      this.propObject.item.diveSites.length > 0\n    ) {\n      const diveSites = this.propObject.item.diveSites;\n      this.propObject.item = new MapDataDivingCenter(this.propObject.item);\n      const pointsArray = [this.propObject.item];\n      diveSites.forEach(async (siteId) => {\n        const diveSite = DiveSitesService.getDiveSitesDetails(siteId);\n        pointsArray.push(diveSite);\n        this.mapElement[\"createLine\"](siteId, this.propObject.item, diveSite);\n      });\n      this.mapElement[\"fitToBounds\"](pointsArray);\n    } else if (\n      this.propObject.collection == DIVESITESCOLLECTION &&\n      this.propObject.item.divingCenters &&\n      this.propObject.item.divingCenters.length > 0\n    ) {\n      const divingCenters = this.propObject.item.divingCenters;\n      this.propObject.item = new MapDataDiveSite(this.propObject.item);\n      const pointsArray = [this.propObject.item];\n      divingCenters.forEach(async (centerId) => {\n        const divingCenter =\n          DivingCentersService.getDivingCenterDetails(centerId);\n        pointsArray.push(divingCenter);\n        this.mapElement[\"createLine\"](\n          centerId,\n          this.propObject.item,\n          divingCenter\n        );\n      });\n      this.mapElement[\"fitToBounds\"](pointsArray);\n    }\n  }\n\n  removeLinesForItem() {\n    if (\n      this.propObject.collection == DIVECENTERSSCOLLECTION &&\n      this.propObject.item.diveSites &&\n      this.propObject.item.diveSites.length > 0\n    ) {\n      const diveSites = this.propObject.item.diveSites;\n      diveSites.forEach(async (siteId) => {\n        this.mapElement[\"removeLine\"](siteId);\n      });\n    } else if (\n      this.propObject.collection == DIVESITESCOLLECTION &&\n      this.propObject.item.divingCenters &&\n      this.propObject.item.divingCenters.length > 0\n    ) {\n      const divingCenters = this.propObject.item.divingCenters;\n      divingCenters.forEach(async (centerId) => {\n        this.mapElement[\"removeLine\"](centerId);\n      });\n    }\n  }\n\n  async openModal() {\n    switch (this.propObject.collection) {\n      case USERPUBLICPROFILECOLLECTION:\n        UserService.presentUserDetails(this.propObject.id);\n        break;\n      case DIVESITESCOLLECTION:\n        DiveSitesService.presentDiveSiteDetails(this.propObject.id);\n        break;\n      case DIVECENTERSSCOLLECTION:\n        DivingCentersService.presentDivingCenterDetails(this.propObject.id);\n        break;\n      case DIVECOMMUNITIESCOLLECTION:\n        DiveCommunitiesService.presentDiveCommunityDetails(this.propObject.id);\n        break;\n      case DIVESCHOOLSSCOLLECTION:\n        DivingSchoolsService.presentDivingSchoolDetails(this.propObject.id);\n        break;\n      case SERVICECENTERSCOLLECTION:\n        ServiceCentersService.presentServiceCenterDetails(this.propObject.id);\n        break;\n      //when markers are added as feature\n      case \"markers-feature\":\n        if (this.propObject.item.collection == CUSTOMERSCOLLECTION)\n          CustomersService.presentCustomerDetails(this.propObject.item.id);\n        break;\n    }\n    this.mapElement[\"closePopup\"]();\n  }\n\n  async planDive() {\n    DiveSitesService.presentDiveSiteDetails(this.propObject.id, true);\n    this.mapElement[\"closePopup\"]();\n  }\n\n  async editModal() {\n    switch (this.propObject.collection) {\n      case USERPUBLICPROFILECOLLECTION:\n        UserService.presentUserDetails(this.propObject.id);\n        break;\n      case DIVESITESCOLLECTION:\n        DiveSitesService.presentDiveSiteUpdate(this.propObject.id);\n        break;\n      case DIVECENTERSSCOLLECTION:\n        DivingCentersService.presentDivingCenterUpdate(this.propObject.id);\n        break;\n      case DIVECOMMUNITIESCOLLECTION:\n        DiveCommunitiesService.presentDiveCommunityUpdate(this.propObject.id);\n        break;\n      case DIVESCHOOLSSCOLLECTION:\n        DivingSchoolsService.presentDivingSchoolUpdate(this.propObject.id);\n        break;\n      case SERVICECENTERSCOLLECTION:\n        ServiceCentersService.presentServiceCenterUpdate(this.propObject.id);\n        break;\n    }\n    this.mapElement[\"closePopup\"]();\n  }\n\n  async delete() {\n    switch (this.propObject.collection) {\n      case \"userPublicProfiles\":\n        //UserService.presentUserDetails(this.propObject.id);\n        break;\n      case DIVESITESCOLLECTION:\n        DiveSitesService.deleteDiveSite(this.propObject.id);\n        break;\n      case DIVECENTERSSCOLLECTION:\n        DivingCentersService.deleteDivingCenter(this.propObject.id);\n        break;\n      case DIVECOMMUNITIESCOLLECTION:\n        DiveCommunitiesService.deleteDiveCommunity(this.propObject.id);\n        break;\n      case DIVESCHOOLSSCOLLECTION:\n        DivingSchoolsService.deleteDivingSchool(this.propObject.id);\n        break;\n      case SERVICECENTERSCOLLECTION:\n        ServiceCentersService.deleteServiceCenter(this.propObject.id);\n        break;\n    }\n    this.mapElement[\"closePopup\"]();\n  }\n\n  render() {\n    return (\n      <Host>\n        {this.propObject.item.coverURL ? (\n          <div\n            class='cover'\n            style={\n              this.propObject.item.coverURL\n                ? {\n                    backgroundImage:\n                      \"url(\" + this.propObject.item.coverURL + \")\",\n                  }\n                : undefined\n            }\n          ></div>\n        ) : undefined}\n        {this.propObject.item.photoURL ? (\n          <ion-thumbnail>\n            <img\n              src={\n                this.propObject.item.photoURL\n                  ? this.propObject.item.photoURL\n                  : \"assets/images/avatar.png\"\n              }\n            />\n          </ion-thumbnail>\n        ) : undefined}\n        <h2 class='center'>{this.propObject.item.displayName}</h2>\n        <div class='center'>\n          <ion-button\n            expand='full'\n            fill='outline'\n            color='dark'\n            onClick={() => this.openModal()}\n          >\n            <my-transl tag='details' text='Details' />\n          </ion-button>\n        </div>\n        {this.propObject.collection == DIVESITESCOLLECTION ? (\n          <div class='center'>\n            <ion-button\n              expand='full'\n              fill='outline'\n              color='secondary'\n              onClick={() => this.planDive()}\n            >\n              <my-transl tag='plan-dive' text='Plan a Dive' />\n            </ion-button>\n          </div>\n        ) : undefined}\n\n        {!Environment.isTrasteel() &&\n        this.userRoles &&\n        this.userRoles.isSuperAdmin()\n          ? [\n              <div class='center'>\n                <ion-button\n                  expand='full'\n                  fill='outline'\n                  color='primary'\n                  onClick={() => this.editModal()}\n                >\n                  <my-transl tag='edit' text='Edit' />\n                </ion-button>\n              </div>,\n              <div class='center'>\n                <ion-button\n                  expand='full'\n                  fill='outline'\n                  color='danger'\n                  onClick={() => this.delete()}\n                >\n                  <my-transl tag='delete' text='Delete' />\n                </ion-button>\n              </div>,\n            ]\n          : undefined}\n\n        <div class='margin'></div>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}