{"version":3,"names":["CameraWeb","WebPlugin","getPhoto","options","Promise","async","resolve","reject","webUseInput","source","CameraSource","Photos","this","fileInputExperience","Prompt","actionSheet","document","querySelector","createElement","body","appendChild","header","promptLabelHeader","cancelable","title","promptLabelPhoto","promptLabelPicture","addEventListener","e","selection","detail","cameraExperience","pickImages","_options","multipleFileInputExperience","customElements","get","cameraModal","facingMode","direction","CameraDirection","Front","componentOnReady","photo","CapacitorException","Error","_getCameraPhoto","dismiss","removeChild","present","console","error","input","cleanup","_a","parentNode","id","type","hidden","_e","file","files","format","resultType","reader","FileReader","dataUrl","result","b64","split","base64String","readAsDataURL","webPath","URL","createObjectURL","accept","capture","removeAttribute","Rear","click","multiple","photos","i","length","push","saved","onloadend","r","onerror","checkPermissions","navigator","permissions","unavailable","permission","window","query","name","camera","state","requestPermissions","unimplemented","pickLimitedLibraryPhotos","getLimitedLibraryPhotos","Camera"],"sources":["node_modules/@capacitor/camera/dist/esm/web.js"],"sourcesContent":["import { WebPlugin, CapacitorException } from '@capacitor/core';\nimport { CameraSource, CameraDirection } from './definitions';\nexport class CameraWeb extends WebPlugin {\n    async getPhoto(options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve, reject) => {\n            if (options.webUseInput || options.source === CameraSource.Photos) {\n                this.fileInputExperience(options, resolve);\n            }\n            else if (options.source === CameraSource.Prompt) {\n                let actionSheet = document.querySelector('pwa-action-sheet');\n                if (!actionSheet) {\n                    actionSheet = document.createElement('pwa-action-sheet');\n                    document.body.appendChild(actionSheet);\n                }\n                actionSheet.header = options.promptLabelHeader || 'Photo';\n                actionSheet.cancelable = false;\n                actionSheet.options = [\n                    { title: options.promptLabelPhoto || 'From Photos' },\n                    { title: options.promptLabelPicture || 'Take Picture' },\n                ];\n                actionSheet.addEventListener('onSelection', async (e) => {\n                    const selection = e.detail;\n                    if (selection === 0) {\n                        this.fileInputExperience(options, resolve);\n                    }\n                    else {\n                        this.cameraExperience(options, resolve, reject);\n                    }\n                });\n            }\n            else {\n                this.cameraExperience(options, resolve, reject);\n            }\n        });\n    }\n    async pickImages(_options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve) => {\n            this.multipleFileInputExperience(resolve);\n        });\n    }\n    async cameraExperience(options, resolve, reject) {\n        if (customElements.get('pwa-camera-modal')) {\n            const cameraModal = document.createElement('pwa-camera-modal');\n            cameraModal.facingMode =\n                options.direction === CameraDirection.Front ? 'user' : 'environment';\n            document.body.appendChild(cameraModal);\n            try {\n                await cameraModal.componentOnReady();\n                cameraModal.addEventListener('onPhoto', async (e) => {\n                    const photo = e.detail;\n                    if (photo === null) {\n                        reject(new CapacitorException('User cancelled photos app'));\n                    }\n                    else if (photo instanceof Error) {\n                        reject(photo);\n                    }\n                    else {\n                        resolve(await this._getCameraPhoto(photo, options));\n                    }\n                    cameraModal.dismiss();\n                    document.body.removeChild(cameraModal);\n                });\n                cameraModal.present();\n            }\n            catch (e) {\n                this.fileInputExperience(options, resolve);\n            }\n        }\n        else {\n            console.error(`Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements.`);\n            this.fileInputExperience(options, resolve);\n        }\n    }\n    fileInputExperience(options, resolve) {\n        let input = document.querySelector('#_capacitor-camera-input');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input';\n            input.type = 'file';\n            input.hidden = true;\n            document.body.appendChild(input);\n            input.addEventListener('change', (_e) => {\n                const file = input.files[0];\n                let format = 'jpeg';\n                if (file.type === 'image/png') {\n                    format = 'png';\n                }\n                else if (file.type === 'image/gif') {\n                    format = 'gif';\n                }\n                if (options.resultType === 'dataUrl' ||\n                    options.resultType === 'base64') {\n                    const reader = new FileReader();\n                    reader.addEventListener('load', () => {\n                        if (options.resultType === 'dataUrl') {\n                            resolve({\n                                dataUrl: reader.result,\n                                format,\n                            });\n                        }\n                        else if (options.resultType === 'base64') {\n                            const b64 = reader.result.split(',')[1];\n                            resolve({\n                                base64String: b64,\n                                format,\n                            });\n                        }\n                        cleanup();\n                    });\n                    reader.readAsDataURL(file);\n                }\n                else {\n                    resolve({\n                        webPath: URL.createObjectURL(file),\n                        format: format,\n                    });\n                    cleanup();\n                }\n            });\n        }\n        input.accept = 'image/*';\n        input.capture = true;\n        if (options.source === CameraSource.Photos ||\n            options.source === CameraSource.Prompt) {\n            input.removeAttribute('capture');\n        }\n        else if (options.direction === CameraDirection.Front) {\n            input.capture = 'user';\n        }\n        else if (options.direction === CameraDirection.Rear) {\n            input.capture = 'environment';\n        }\n        input.click();\n    }\n    multipleFileInputExperience(resolve) {\n        let input = document.querySelector('#_capacitor-camera-input-multiple');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input-multiple';\n            input.type = 'file';\n            input.hidden = true;\n            input.multiple = true;\n            document.body.appendChild(input);\n            input.addEventListener('change', (_e) => {\n                const photos = [];\n                // eslint-disable-next-line @typescript-eslint/prefer-for-of\n                for (let i = 0; i < input.files.length; i++) {\n                    const file = input.files[i];\n                    let format = 'jpeg';\n                    if (file.type === 'image/png') {\n                        format = 'png';\n                    }\n                    else if (file.type === 'image/gif') {\n                        format = 'gif';\n                    }\n                    photos.push({\n                        webPath: URL.createObjectURL(file),\n                        format: format,\n                    });\n                }\n                resolve({ photos });\n                cleanup();\n            });\n        }\n        input.accept = 'image/*';\n        input.click();\n    }\n    _getCameraPhoto(photo, options) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            const format = photo.type.split('/')[1];\n            if (options.resultType === 'uri') {\n                resolve({\n                    webPath: URL.createObjectURL(photo),\n                    format: format,\n                    saved: false,\n                });\n            }\n            else {\n                reader.readAsDataURL(photo);\n                reader.onloadend = () => {\n                    const r = reader.result;\n                    if (options.resultType === 'dataUrl') {\n                        resolve({\n                            dataUrl: r,\n                            format: format,\n                            saved: false,\n                        });\n                    }\n                    else {\n                        resolve({\n                            base64String: r.split(',')[1],\n                            format: format,\n                            saved: false,\n                        });\n                    }\n                };\n                reader.onerror = e => {\n                    reject(e);\n                };\n            }\n        });\n    }\n    async checkPermissions() {\n        if (typeof navigator === 'undefined' || !navigator.permissions) {\n            throw this.unavailable('Permissions API not available in this browser');\n        }\n        try {\n            // https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\n            // the specific permissions that are supported varies among browsers that implement the\n            // permissions API, so we need a try/catch in case 'camera' is invalid\n            const permission = await window.navigator.permissions.query({\n                name: 'camera',\n            });\n            return {\n                camera: permission.state,\n                photos: 'granted',\n            };\n        }\n        catch (_a) {\n            throw this.unavailable('Camera permissions are not available in this browser');\n        }\n    }\n    async requestPermissions() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    async pickLimitedLibraryPhotos() {\n        throw this.unavailable('Not implemented on web.');\n    }\n    async getLimitedLibraryPhotos() {\n        throw this.unavailable('Not implemented on web.');\n    }\n}\nconst Camera = new CameraWeb();\nexport { Camera };\n//# sourceMappingURL=web.js.map"],"mappings":"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","ignoreList":[]}