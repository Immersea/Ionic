{"version":3,"names":["popoverDatasheetsFilterCss","PopoverDatasheetsFilterStyle0","PopoverDatasheetsFilter","componentWillLoad","this","popover","el","closest","datasheetMajorFamilies","DatasheetsService","getDatasheetMajorFamilies","datasheetFamilies","getDatasheetFamilies","propertyNames","getDatasheetPropertyNames","resetNewFilterCondition","newFilterCondition","FirebaseFilterCondition","field","fieldName","valueName","comparisonField","validateProperty","deleteCondition","index","filter","properties","splice","updateView","handleFilter","ev","detail","name","value","handleMajorFamilySelect","majorFamilyId","handleFamilySelect","familyId","segmentChanged","showBaseFilter","selectPropertyName","selectOperator","operator","selectValue","addNewProperty","push","cloneDeep","showAddNewProperty","isString","isNull","close","popoverController","dismiss","save","render","h","Host","key","translucent","mode","color","onIonChange","interface","label","TranslationService","getTransl","map","type","majorFamilyName","familyName","oldProduct","onFormItemChanged","lines","disabled","length","selectFn","selectOptions","selectValueId","selectValueText","size","fill","onClick","property","nameName","saveTag","tag","text","onCancelEmit","onSaveEmit"],"sources":["src/components/trasteel/popovers/popover-datasheets-filter/popover-datasheets-filter.scss?tag=popover-datasheets-filter","src/components/trasteel/popovers/popover-datasheets-filter/popover-datasheets-filter.tsx"],"sourcesContent":["popover-datasheets-filter {\n  /* Component styles go here */\n  ion-list {\n    min-height: 300px;\n  }\n}\n","import {Component, h, Host, Element, Prop, State} from \"@stencil/core\";\nimport {popoverController} from \"@ionic/core\";\nimport {TranslationService} from \"../../../../services/common/translations\";\nimport {\n  DatasheetFamily,\n  DatasheetFilter,\n  DatasheetMajorFamily,\n  DatasheetPropertyName,\n} from \"../../../../interfaces/trasteel/refractories/datasheets\";\nimport {DatasheetsService} from \"../../../../services/trasteel/refractories/datasheets\";\nimport {FirebaseFilterCondition} from \"../../../../interfaces/common/system/system\";\nimport {cloneDeep, isNull, isString} from \"lodash\";\n\n@Component({\n  tag: \"popover-datasheets-filter\",\n  styleUrl: \"popover-datasheets-filter.scss\",\n})\nexport class PopoverDatasheetsFilter {\n  @Element() el: HTMLElement;\n  @Prop() filter: DatasheetFilter;\n  @State() showBaseFilter = true;\n  @State() propertyNames: DatasheetPropertyName[] = [];\n  @State() newFilterCondition: FirebaseFilterCondition;\n  @State() showAddNewProperty = false;\n  @State() updateView = false;\n  popover: HTMLIonPopoverElement;\n  datasheetMajorFamilies: DatasheetMajorFamily[];\n  datasheetFamilies: DatasheetFamily[];\n\n  componentWillLoad() {\n    this.popover = this.el.closest(\"ion-popover\");\n    this.datasheetMajorFamilies = DatasheetsService.getDatasheetMajorFamilies();\n    this.datasheetFamilies = DatasheetsService.getDatasheetFamilies();\n    this.propertyNames = DatasheetsService.getDatasheetPropertyNames();\n    this.resetNewFilterCondition();\n  }\n\n  resetNewFilterCondition() {\n    this.newFilterCondition = new FirebaseFilterCondition({\n      field: \"properties\",\n      fieldName: \"name\",\n      valueName: \"mgo\",\n      comparisonField: \"lower\",\n    });\n    this.validateProperty();\n  }\n\n  deleteCondition(index) {\n    this.filter.properties.splice(index, 1);\n    this.updateView = !this.updateView;\n  }\n\n  handleFilter(ev) {\n    this.filter[ev.detail.name] = ev.detail.value;\n  }\n\n  handleMajorFamilySelect(ev) {\n    this.filter.majorFamilyId = ev.detail.value;\n  }\n\n  handleFamilySelect(ev) {\n    this.filter.familyId = ev.detail.value;\n  }\n\n  segmentChanged(ev) {\n    if (ev.detail.value == \"base\") {\n      this.showBaseFilter = true;\n    } else {\n      this.showBaseFilter = false;\n    }\n  }\n\n  selectPropertyName(ev) {\n    this.newFilterCondition.valueName = ev.detail.value;\n    this.validateProperty();\n  }\n\n  selectOperator(ev) {\n    this.newFilterCondition.operator = ev.detail.value;\n    this.validateProperty();\n  }\n\n  selectValue(ev) {\n    this.newFilterCondition.value = ev.detail.value;\n    this.validateProperty();\n  }\n\n  addNewProperty() {\n    this.filter.properties.push(cloneDeep(this.newFilterCondition));\n    this.resetNewFilterCondition();\n  }\n\n  validateProperty() {\n    this.showAddNewProperty =\n      isString(this.newFilterCondition.field) &&\n      isString(this.newFilterCondition.fieldName) &&\n      isString(this.newFilterCondition.operator) &&\n      isString(this.newFilterCondition.valueName) &&\n      !isNull(this.newFilterCondition.value);\n  }\n\n  close() {\n    popoverController.dismiss();\n  }\n\n  save() {\n    popoverController.dismiss(this.filter);\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-header translucent>\n          <ion-toolbar>\n            <ion-title>Filter Datasheets</ion-title>\n          </ion-toolbar>\n        </ion-header>\n        <ion-content>\n          <ion-segment\n            mode=\"ios\"\n            color=\"trasteel\"\n            onIonChange={(ev) => this.segmentChanged(ev)}\n            value=\"base\"\n          >\n            <ion-segment-button value=\"base\">\n              <ion-label>Base</ion-label>\n            </ion-segment-button>\n            <ion-segment-button value=\"advanced\">\n              <ion-label>Advanced</ion-label>\n            </ion-segment-button>\n          </ion-segment>\n          <ion-list>\n            {this.showBaseFilter\n              ? [\n                  <ion-item>\n                    <ion-select\n                      color=\"trasteel\"\n                      interface=\"action-sheet\"\n                      label={TranslationService.getTransl(\n                        \"majorFamily\",\n                        \"Major Family\"\n                      )}\n                      label-placement=\"floating\"\n                      onIonChange={(ev) => this.handleMajorFamilySelect(ev)}\n                      value={this.filter.majorFamilyId}\n                    >\n                      {this.datasheetMajorFamilies.map((type) => (\n                        <ion-select-option value={type.majorFamilyId}>\n                          {type.majorFamilyName}\n                        </ion-select-option>\n                      ))}\n                    </ion-select>\n                  </ion-item>,\n                  <ion-item>\n                    <ion-select\n                      color=\"trasteel\"\n                      interface=\"action-sheet\"\n                      label={TranslationService.getTransl(\"family\", \"Family\")}\n                      label-placement=\"floating\"\n                      onIonChange={(ev) => this.handleFamilySelect(ev)}\n                      value={this.filter.familyId}\n                    >\n                      {this.datasheetFamilies.map((type) => (\n                        <ion-select-option value={type.familyId}>\n                          {type.familyName}\n                        </ion-select-option>\n                      ))}\n                    </ion-select>\n                  </ion-item>,\n                  <app-form-item\n                    label-text=\"Show Old Products\"\n                    value={this.filter.oldProduct}\n                    name=\"oldProduct\"\n                    input-type=\"boolean\"\n                    onFormItemChanged={(ev) => this.handleFilter(ev)}\n                  ></app-form-item>,\n                ]\n              : [\n                  <ion-grid>\n                    <ion-row>\n                      <ion-col>\n                        <app-select-search\n                          color=\"trasteel\"\n                          value={this.newFilterCondition.valueName}\n                          lines=\"none\"\n                          disabled={this.propertyNames.length == 0}\n                          selectFn={(ev) => this.selectPropertyName(ev)}\n                          selectOptions={this.propertyNames}\n                          selectValueId=\"nameId\"\n                          selectValueText={[\"nameName\"]}\n                        ></app-select-search>\n                      </ion-col>\n                      <ion-col size=\"3\">\n                        <ion-item lines=\"none\">\n                          <ion-select\n                            color=\"trasteel\"\n                            interface=\"action-sheet\"\n                            onIonChange={(ev) => this.selectOperator(ev)}\n                            value={this.newFilterCondition.operator}\n                          >\n                            <ion-select-option value={\">=\"}>\n                              <ion-label>{\">=\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\">\"}>\n                              <ion-label>{\">\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\"=\"}>\n                              <ion-label>{\"=\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\"<\"}>\n                              <ion-label>{\"<\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\"<=\"}>\n                              <ion-label>{\"<=\"}</ion-label>\n                            </ion-select-option>\n                          </ion-select>\n                        </ion-item>\n                      </ion-col>\n                    </ion-row>\n                    <ion-row>\n                      <ion-col>\n                        <app-form-item\n                          value={this.newFilterCondition.value}\n                          name=\"typical\"\n                          input-type=\"number\"\n                          onFormItemChanged={(ev) => this.selectValue(ev)}\n                        ></app-form-item>\n                      </ion-col>\n\n                      <ion-col size=\"3\">\n                        <ion-button\n                          icon-only\n                          fill=\"outline\"\n                          onClick={() => this.addNewProperty()}\n                          disabled={!this.showAddNewProperty}\n                        >\n                          <ion-icon name=\"add\" color=\"primary\"></ion-icon>\n                        </ion-button>\n                      </ion-col>\n                    </ion-row>\n                  </ion-grid>,\n                  <ion-item-divider>\n                    <ion-label>Conditions</ion-label>\n                  </ion-item-divider>,\n                  this.filter.properties.map((property, index) => (\n                    <ion-item>\n                      <ion-label>\n                        {DatasheetsService.getDatasheetPropertyNames(\n                          \"id\",\n                          property.valueName\n                        )[0].nameName +\n                          \" \" +\n                          property.operator +\n                          \" \" +\n                          property.value}\n                      </ion-label>\n                      <ion-button\n                        icon-only\n                        fill=\"clear\"\n                        onClick={() => this.deleteCondition(index)}\n                      >\n                        <ion-icon name=\"trash\" color=\"danger\"></ion-icon>\n                      </ion-button>\n                    </ion-item>\n                  )),\n                ]}\n          </ion-list>\n        </ion-content>\n        <ion-footer>\n          <app-modal-footer\n            saveTag={{tag: \"filter\", text: \"Filter\"}}\n            onCancelEmit={() => this.close()}\n            onSaveEmit={() => this.save()}\n          />\n        </ion-footer>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}