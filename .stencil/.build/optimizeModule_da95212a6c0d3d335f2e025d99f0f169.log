import{r as e,h as t,H as i,f as s}from"./p-cbe60c68.js";import{O as n,c as o,T as a}from"./p-8f24d722.js";import{l}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{n as c}from"./p-5d4a8e1f.js";import"./p-694b8ade.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const h="popover-new-dive-trip .validation-error{text-align:center;font-size:0.7rem;color:red}";const p=h;const r=class{constructor(t){e(this,t);this.sitesList=[];this.divingCentersList=[];this.tripDive=undefined;this.diveIndex=undefined;this.diveSite=undefined;this.updateView=false;this.noDivePlans=false;this.validTrip=false}async componentWillLoad(){this.sitesList=n.diveSitesList;this.divingCentersList=o.divingCentersList}componentDidLoad(){if(this.tripDive&&this.diveIndex>=0){this.participants=this.tripDive.numberOfParticipants;this.tripDate=this.tripDive.divePlan.dives[0].date;console.log("this.tripDate",this.tripDive,this.tripDate,this.tripDate.toISOString());this.diveSite=this.sitesList.find((e=>e.id===this.tripDive.divePlan.dives[this.diveIndex].diveSiteId));this.divingCenterId=this.tripDive.divePlan.dives[this.diveIndex].divingCenterId;this.setSelectDivePlans();this.divePlanTitle=this.tripDive.divePlan.title;this.divePlanName=this.tripDive.divePlan.configuration?this.tripDive.divePlan.configuration.stdName:null;this.surfaceInterval=this.diveIndex>0?this.tripDive.divePlan.dives[this.diveIndex].surfaceInterval:undefined;this.validateTrip()}}async openSearchSite(){const e=await c.create({component:"popover-search-dive-site",translucent:true});e.onDidDismiss().then((e=>{this.divePlanName=null;const t=e.data;this.diveSite=this.sitesList.find((e=>e.id===t));this.validateTrip();this.setSelectDivePlans()}));e.present()}setSelectDivePlans(){const e=this.el.querySelector("#selectDivePlans");const t={header:a.getTransl("dive-profile","Dive Profile")};e.interfaceOptions=t;const i=Array.from(e.getElementsByTagName("ion-select-option"));i.map((t=>{e.removeChild(t)}));if(this.diveSite.divePlans&&this.diveSite.divePlans.length>0){e.placeholder=a.getTransl("select","Select");this.diveSite.divePlans.map((t=>{const i=document.createElement("ion-select-option");i.value=t;i.textContent=t;e.appendChild(i)}));this.noDivePlans=false;e.disabled=false}else{e.placeholder=a.getTransl("no-profiles","No Dive Profiles available for this site");e.disabled=true;this.noDivePlans=true}const s=this.el.querySelector("#selectDivingCenter");const n={header:a.getTransl("diving-center","Diving Center")};s.interfaceOptions=n;const o=Array.from(s.getElementsByTagName("ion-select-option"));o.map((e=>{s.removeChild(e)}));if(this.diveSite.divingCenters&&this.diveSite.divingCenters.length>0){s.placeholder=a.getTransl("select","Select");const e=document.createElement("ion-select-option");e.value=null;e.textContent="-";s.appendChild(e);this.diveSite.divingCenters.map((e=>{const t=document.createElement("ion-select-option");const i=this.divingCentersList.find((t=>t.id===e));t.value=e;t.textContent=i.displayName;s.appendChild(t)}));s.disabled=false}else{s.placeholder=a.getTransl("no-divecenters","No Diving Centers available for this site");s.disabled=true}this.updateView=!this.updateView}updateDate(e){this.tripDate=new Date(e.detail.value);this.validateTrip()}updateSurfaceInterval(e){this.surfaceInterval=e;this.validateTrip()}updateParticipants(e){this.participants=l.exports.toNumber(e.detail.value);this.validateTrip()}updateTitle(e){this.divePlanTitle=e.detail.value;this.validateTrip()}updateDivePlanName(e){this.divePlanName=e.detail.value}updateDivingCenter(e){this.divingCenterId=e.detail.value}validateTrip(){this.validTrip=(!this.diveIndex&&!this.tripDive||this.diveIndex===0?l.exports.isDate(this.tripDate)&&l.exports.isNumber(this.participants)&&l.exports.isString(this.divePlanTitle):l.exports.isNumber(this.surfaceInterval))&&this.diveSite&&l.exports.isString(this.diveSite.id);this.updateView=!this.updateView}async save(){c.dismiss({participants:this.participants,date:this.tripDate,title:this.divePlanTitle,diveSiteId:this.diveSite.id,divingCenterId:this.divingCenterId,divePlanName:this.divePlanName,surfaceInterval:this.surfaceInterval})}cancel(){c.dismiss()}render(){return t(i,{key:"81f0cf94fd1a6cb8fbbdc2f6d72b1430690cb8f2"},t("ion-toolbar",{key:"4e1013580bcc5c6fd476977896930c2c95cff837"},t("ion-title",{key:"c5244e9ec3d2fc60d5db8aa3e48bfbb0c6d4faf4"},t("my-transl",{key:"ca9ea22590010c77fdd47bd2591815e20b186644",tag:"dive-trip",text:"Dive Trip"}))),!this.diveIndex&&!this.tripDive||this.diveIndex===0?[t("app-form-item",{"label-tag":"date-time","label-text":"Date/Time",value:this.tripDate?this.tripDate.toISOString():null,name:"tripDate","input-type":"date",datePresentation:"date-time",lines:"inset",onFormItemChanged:e=>this.updateDate(e)}),t("app-form-item",{"label-tag":"title","label-text":"Title",value:this.divePlanTitle,name:"divePlanTitle","input-type":"text",lines:"inset",onFormItemChanged:e=>this.updateTitle(e)}),t("app-form-item",{"label-tag":"number-participants","label-text":"Max Number of Participants",value:this.participants,name:"participants","input-type":"number",lines:"inset",onFormItemChanged:e=>this.updateParticipants(e)})]:t("ion-item",null,t("ion-select",{label:a.getTransl("surface-interval","Surface Interval"),onIonChange:e=>this.updateSurfaceInterval(e.detail.value),value:this.surfaceInterval},t("ion-select-option",{value:.5},"0:30"),t("ion-select-option",{value:1},"1:00"),t("ion-select-option",{value:1.5},"1:30"),t("ion-select-option",{value:2},"2:00"),t("ion-select-option",{value:2.5},"2:30"),t("ion-select-option",{value:3},"3:00"),t("ion-select-option",{value:3.5},"3:30"),t("ion-select-option",{value:4},"4:00"),t("ion-select-option",{value:4.5},"4:30"),t("ion-select-option",{value:5},"5:00"),t("ion-select-option",{value:5.5},"5:30"),t("ion-select-option",{value:6},"6:00"),t("ion-select-option",{value:6.5},"6:30"),t("ion-select-option",{value:7},"7:00"),t("ion-select-option",{value:7.5},"7:30"),t("ion-select-option",{value:8},"8:00"),t("ion-select-option",{value:8.5},"8:30"),t("ion-select-option",{value:9},"9:00"),t("ion-select-option",{value:9.5},"9:30"),t("ion-select-option",{value:10},"10:00"),t("ion-select-option",{value:10.5},"10:30"),t("ion-select-option",{value:11},"11:00"),t("ion-select-option",{value:11.5},"11:30"),t("ion-select-option",{value:12},"12:00"))),t("ion-item",{key:"50544edc317ffe15ff3d0e165e8e5cb4ddd67cf3",button:true,onClick:()=>this.openSearchSite()},t("ion-input",{key:"11a4f0f7d02a5eef56b65b9e4054475bf3d5bbbf",label:a.getTransl("dive-site","Dive Site"),"label-placement":"floating",placeholder:a.getTransl("select-dive-site","Select Dive Site"),value:this.diveSite?this.diveSite.displayName:undefined}),t("ion-icon",{key:"806bb73e927628656e03f94252317c148acfb6d0",slot:"end",name:"search-outline"})),t("ion-item",{key:"2110746dccb2de57584e578eb47104233205b111"},t("ion-select",{key:"749c7f389a46aa1e6dd38b41bea1a1b544be1c25",label:a.getTransl("dive-profile","Dive Profile"),id:"selectDivePlans",onIonChange:e=>this.updateDivePlanName(e),disabled:true,value:this.divePlanName})),t("ion-item",{key:"c0c5c579eb718dfe9fe56bb797d1ce06f98611af"},t("ion-select",{key:"83b285cb0e90bf779c5749d023f6f138c54cea0a",label:a.getTransl("diving-center","Diving Center"),id:"selectDivingCenter",onIonChange:e=>this.updateDivingCenter(e),disabled:true,value:this.divingCenterId})),t("app-modal-footer",{key:"1291313254f150345d26d62988cd36251cf3da9a",disableSave:!this.validTrip,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return s(this)}};r.style=p;export{r as popover_new_dive_trip};