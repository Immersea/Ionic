{"version":3,"names":["appAdminClientsListCss","AppAdminClientsListStyle0","AppAdminClientsList","filterClients","ev","this","filter","target","value","clientsFilteredList","clientsList","client","displayName","toLowerCase","includes","componentWillLoad","sub","admin","collectionId","DIVESCHOOLSSCOLLECTION","DivingSchoolsService","selectedDivingSchoolClients$","type","id","selectedDivingSchoolId","customersUrl","DIVECENTERSSCOLLECTION","DivingCentersService","selectedDivingCenterClients$","selectedDivingCenterId","SERVICECENTERSCOLLECTION","ServiceCentersService","selectedServiceCenterClients$","selectedServiceCenterId","clientsSub","subscribe","async","clients","list","clientId","Object","keys","push","UserService","getMapDataUserDetails","orderBy","disconnectedCallback","unsubscribe","render","h","key","color","animated","placeholder","TranslationService","getTransl","onIonInput","map","button","detail","href","ADMINROUTE","photoURL","slot","src","name"],"sources":["src/components/common/app/admin/app-admin-clients-list/app-admin-clients-list.scss?tag=app-admin-clients-list","src/components/common/app/admin/app-admin-clients-list/app-admin-clients-list.tsx"],"sourcesContent":["app-admin-clients-list {\n    /* Component styles go here */\n}\n","import {Component, h, Prop, State} from \"@stencil/core\";\nimport {\n  DIVESCHOOLSSCOLLECTION,\n  DivingSchoolsService,\n} from \"../../../../../services/udive/divingSchools\";\nimport {\n  DIVECENTERSSCOLLECTION,\n  DivingCentersService,\n} from \"../../../../../services/udive/divingCenters\";\nimport {Subscription} from \"rxjs\";\nimport {MapDataUserPubicProfile} from \"../../../../../interfaces/common/user/user-public-profile\";\nimport {UserService} from \"../../../../../services/common/user\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\nimport {ADMINROUTE} from \"../../../../../services/common/router\";\nimport {\n  SERVICECENTERSCOLLECTION,\n  ServiceCentersService,\n} from \"../../../../../services/udive/serviceCenters\";\nimport {Organiser} from \"../../../../../interfaces/udive/dive-trip/diveTrip\";\nimport {Clients} from \"../../../../../interfaces/udive/clients/clients\";\nimport {orderBy} from \"lodash\";\n\n@Component({\n  tag: \"app-admin-clients-list\",\n  styleUrl: \"app-admin-clients-list.scss\",\n})\nexport class AppAdminClientsList {\n  @Prop() admin: Organiser;\n  clients: Clients;\n  clientsList: MapDataUserPubicProfile[];\n\n  @State() clientsFilteredList: MapDataUserPubicProfile[];\n  clientsSub: Subscription;\n  filter: string;\n  customersUrl: string;\n  type: string;\n  id: string;\n\n  async filterClients(ev) {\n    this.filter = ev ? (ev.target ? ev.target.value : ev) : null;\n    if (this.filter) {\n      this.clientsFilteredList = this.clientsList.filter((client) =>\n        client.displayName.toLowerCase().includes(this.filter.toLowerCase())\n      );\n    } else {\n      this.clientsFilteredList = this.clientsList;\n    }\n  }\n  async componentWillLoad() {\n    let sub = null;\n    switch (this.admin.collectionId) {\n      case DIVESCHOOLSSCOLLECTION:\n        sub = DivingSchoolsService.selectedDivingSchoolClients$;\n        this.type = DIVESCHOOLSSCOLLECTION.toLowerCase();\n        this.id = DivingSchoolsService.selectedDivingSchoolId;\n        this.customersUrl = \"members\";\n        break;\n      case DIVECENTERSSCOLLECTION:\n        sub = DivingCentersService.selectedDivingCenterClients$;\n        this.type = DIVECENTERSSCOLLECTION.toLowerCase();\n        this.id = DivingCentersService.selectedDivingCenterId;\n        this.customersUrl = \"customers\";\n        break;\n      case SERVICECENTERSCOLLECTION:\n        sub = ServiceCentersService.selectedServiceCenterClients$;\n        this.type = SERVICECENTERSCOLLECTION.toLowerCase();\n        this.id = ServiceCentersService.selectedServiceCenterId;\n        this.customersUrl = \"customers\";\n        break;\n    }\n    this.clientsSub = sub.subscribe(async (clients) => {\n      this.clients = clients;\n      const list = [];\n      if (clients) {\n        for (let clientId of Object.keys(this.clients)) {\n          list.push(await UserService.getMapDataUserDetails(clientId));\n        }\n      }\n      this.clientsList = orderBy(list, \"displayName\");\n      this.filterClients(this.filter);\n    });\n  }\n  disconnectedCallback() {\n    this.clientsSub.unsubscribe();\n  }\n  render() {\n    return [\n      <ion-header>\n        <ion-toolbar color=\"clients\">\n          <ion-searchbar\n            animated\n            placeholder={TranslationService.getTransl(\"search\", \"Search\")}\n            onIonInput={(ev) => this.filterClients(ev)}\n          ></ion-searchbar>\n        </ion-toolbar>\n      </ion-header>,\n      <ion-content>\n        <ion-list>\n          {this.clientsFilteredList.map((client) => (\n            <ion-item\n              button\n              detail\n              href={\n                \"/\" +\n                ADMINROUTE +\n                \"/\" +\n                this.type +\n                \"/\" +\n                this.id +\n                \"/\" +\n                this.customersUrl +\n                \"/\" +\n                client.id\n              }\n            >\n              {client.photoURL ? (\n                <ion-avatar slot=\"start\">\n                  <img src={client.photoURL} />\n                </ion-avatar>\n              ) : (\n                <ion-icon slot=\"start\" name=\"person\"></ion-icon>\n              )}\n              <ion-label>{client.displayName}</ion-label>\n            </ion-item>\n          ))}\n        </ion-list>\n      </ion-content>,\n    ];\n  }\n}\n"],"mappings":"scAAA,MAAMA,EAAyB,2BAC/B,MAAAC,EAAeD,E,MCyBFE,EAAmB,M,iFAY9B,mBAAMC,CAAcC,GAClBC,KAAKC,OAASF,EAAMA,EAAGG,OAASH,EAAGG,OAAOC,MAAQJ,EAAM,KACxD,GAAIC,KAAKC,OAAQ,CACfD,KAAKI,oBAAsBJ,KAAKK,YAAYJ,QAAQK,GAClDA,EAAOC,YAAYC,cAAcC,SAAST,KAAKC,OAAOO,gB,KAEnD,CACLR,KAAKI,oBAAsBJ,KAAKK,W,EAGpC,uBAAMK,GACJ,IAAIC,EAAM,KACV,OAAQX,KAAKY,MAAMC,cACjB,KAAKC,EACHH,EAAMI,EAAqBC,6BAC3BhB,KAAKiB,KAAOH,EAAuBN,cACnCR,KAAKkB,GAAKH,EAAqBI,uBAC/BnB,KAAKoB,aAAe,UACpB,MACF,KAAKC,EACHV,EAAMW,EAAqBC,6BAC3BvB,KAAKiB,KAAOI,EAAuBb,cACnCR,KAAKkB,GAAKI,EAAqBE,uBAC/BxB,KAAKoB,aAAe,YACpB,MACF,KAAKK,EACHd,EAAMe,EAAsBC,8BAC5B3B,KAAKiB,KAAOQ,EAAyBjB,cACrCR,KAAKkB,GAAKQ,EAAsBE,wBAChC5B,KAAKoB,aAAe,YACpB,MAEJpB,KAAK6B,WAAalB,EAAImB,WAAUC,MAAOC,IACrChC,KAAKgC,QAAUA,EACf,MAAMC,EAAO,GACb,GAAID,EAAS,CACX,IAAK,IAAIE,KAAYC,OAAOC,KAAKpC,KAAKgC,SAAU,CAC9CC,EAAKI,WAAWC,EAAYC,sBAAsBL,G,EAGtDlC,KAAKK,YAAcmC,kBAAQP,EAAM,eACjCjC,KAAKF,cAAcE,KAAKC,OAAO,G,CAGnC,oBAAAwC,GACEzC,KAAK6B,WAAWa,a,CAElB,MAAAC,GACE,MAAO,CACLC,EAAA,cAAAC,IAAA,4CACED,EAAA,eAAAC,IAAA,2CAAaC,MAAM,WACjBF,EAAA,iBAAAC,IAAA,2CACEE,SAAQ,KACRC,YAAaC,EAAmBC,UAAU,SAAU,UACpDC,WAAapD,GAAOC,KAAKF,cAAcC,OAI7C6C,EAAA,eAAAC,IAAA,4CACED,EAAA,YAAAC,IAAA,4CACG7C,KAAKI,oBAAoBgD,KAAK9C,GAC7BsC,EAAA,YACES,OAAM,KACNC,OAAM,KACNC,KACE,IACAC,EACA,IACAxD,KAAKiB,KACL,IACAjB,KAAKkB,GACL,IACAlB,KAAKoB,aACL,IACAd,EAAOY,IAGRZ,EAAOmD,SACNb,EAAA,cAAYc,KAAK,SACfd,EAAA,OAAKe,IAAKrD,EAAOmD,YAGnBb,EAAA,YAAUc,KAAK,QAAQE,KAAK,WAE9BhB,EAAA,iBAAYtC,EAAOC,kB","ignoreList":[]}