import{r as e,h as i,f as t}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{i as a}from"./p-694b8ade.js";import{n as o}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{a4 as s,U as l,a5 as d}from"./p-736235c6.js";import{E as c}from"./p-46038295.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-1819cfda.js";import"./p-7ee16e8d.js";const r="modal-dive-configuration .scrollx{display:flex;flex-wrap:nowrap;overflow-x:auto}modal-dive-configuration .scrollx .item{flex:0 0 0 0}modal-dive-configuration .scrollx ::-webkit-scrollbar{display:none}modal-dive-configuration input{text-align:right}modal-dive-configuration .fixedLabel{min-width:80% !important;max-width:80% !important}modal-dive-configuration ion-item .item-inner{box-shadow:none !important;border-bottom:1px solid #dedede !important}modal-dive-configuration .item-input .label-md,modal-dive-configuration .item-select .label-md,modal-dive-configuration .item-datetime .label-md{color:rgb(0, 0, 0)}";const f=r;const m=class{constructor(i){e(this,i);this.validForm={name:false,depth:false,time:false,bottom:false};this.diveDataToShare=undefined;this.updateView=true;this.showSave=false}componentWillLoad(){this.screenWidth=window.screen.width;this.divePlan=this.diveDataToShare.divePlan;this.diveConfig=this.divePlan.configuration;this.orderTanks();this.ranges=this.divePlan.getParamRanges(this.diveConfig.parameters.units);let e=s.getStdGases();e=n.exports.orderBy(e,"fromDepth","asc");this.bottomGases=n.exports.filter(e,{deco:false});this.decoGases=n.exports.filter(e,{deco:true});let i=l.userSettings.userTanks;i=n.exports.orderBy(i,"volume");const t=n.exports.filter(i,{forDeco:false});const a=n.exports.filter(i,{forDeco:true});this.bottomTanks=[];t.forEach((e=>{this.bottomTanks.push(e.getTank())}));this.decoTanks=[];a.forEach((e=>{this.decoTanks.push(e.getTank())}));this.stdConfigurations=s.getStdConfigurations();this.userStdConfigurations=n.exports.cloneDeep(l.userSettings.userConfigurations)}componentDidLoad(){this.validateAll()}async addTank(e,i,t){let s={tank:t,tanksList:null,stdGasesList:null,ccr:this.diveConfig.parameters.configuration=="CCR",parameters:this.diveConfig.parameters,decoTanks:!i};if(i){s.tanksList=this.bottomTanks;s.stdGasesList=this.bottomGases}else{s.tanksList=this.decoTanks;s.stdGasesList=this.decoGases}var l=undefined;if(a("capacitor")){l="custom-mobile-popover";e=null}const d=await o.create({component:"popover-tank",event:e,translucent:true,backdropDismiss:false,cssClass:l,componentProps:s});d.present();d.onDidDismiss().then((e=>{e=e.data;if(e){let a;if(i){a=this.diveConfig.configuration.bottom}else{a=this.diveConfig.configuration.deco}if(!t){a.push(e)}else{let i=n.exports.indexOf(a,t);a.splice(i,1,e)}this.orderTanks();this.validateForm("tanks")}}))}deleteTank(e,i){let t;if(e){t=this.diveConfig.configuration.bottom}else{t=this.diveConfig.configuration.deco}t.splice(i,1);this.orderTanks()}orderTanks(){this.diveConfig.configuration.bottom=n.exports.orderBy(this.diveConfig.configuration.bottom,"gas.fromDepth");this.diveConfig.configuration.deco=n.exports.orderBy(this.diveConfig.configuration.deco,"gas.fromDepth");this.updateView=!this.updateView}updateParams(e){this.divePlan.parameters=e}save(){this.el.closest("ion-modal").dismiss(this.diveConfig)}close(){this.el.closest("ion-modal").dismiss()}inputHandler(e){this.diveConfig[e.detail.name]=e.detail.value}validateAll(){this.validForm.name=this.diveConfig.stdName.length>=3;this.validForm.depth=this.diveConfig.maxDepth>1;this.validForm.time=this.diveConfig.maxTime>1;this.validateForm("tanks");this.updateView=!this.updateView}validateForm(e,i){if(e=="name"){this.validForm.name=i}else if(e=="time"){this.validForm.time=i}else if(e=="depth"){this.validForm.depth=i}else{this.validForm.bottom=this.bottomTanks.length>0}this.showSave=this.validForm.name&&this.validForm.time&&this.validForm.depth&&this.validForm.bottom}copyConfiguration(e){this.diveConfig=e;this.validateAll()}render(){return[i("app-navbar",{key:"8392c5da0eaf87eb1b4164699841f372425de97e",tag:"dive-configuration",text:"Dive Configuration",color:c.getAppColor(),modal:true}),i("ion-content",{key:"506802238f8491d37fb8820133a8a055cf2a7969"},i("ion-list",{key:"b987c9cae33fe8535bef72704737d2b8ce4bb7c8"},i("ion-list-header",{key:"823995a68e97a91204da1b1aeb6930bcc80d423a"},"Copy from standard configuration"),i("ion-row",{key:"f032ccdfcf3478ac54062053952934525b958672",class:"scrollx",id:"scrollTankGas"},this.userStdConfigurations?this.userStdConfigurations.map((e=>i("ion-col",{class:"item"},i("ion-button",{shape:"round",color:c.getAppColor(),onClick:()=>this.copyConfiguration(e)},e.stdName)))):undefined,this.stdConfigurations?this.stdConfigurations.map((e=>i("ion-col",{class:"item"},i("ion-button",{shape:"round",color:"success",onClick:()=>this.copyConfiguration(e)},"DP-",e.stdName)))):undefined),i("app-form-item",{key:"66009967918901286a1c69a41d5b90d38b34da8c","label-tag":"configuration-name","label-text":"Configuration Name",value:this.diveConfig.stdName,name:"stdName","input-type":"text",onFormItemChanged:e=>this.inputHandler(e),validator:["required"],onIsValid:e=>this.validateForm("name",e.detail)}),i("app-form-item",{key:"dab4817c5d07da4842d4fd0990b42b295e14edb7","label-tag":"max-depth","label-text":"Max Depth (xxx)",labelReplace:{xxx:this.diveConfig.parameters.depthUnit},value:n.exports.toString(this.diveConfig.maxDepth),name:"maxDepth","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),validator:["required",{name:"minvalue",options:{min:1}}],onIsValid:e=>this.validateForm("depth",e.detail)}),i("app-form-item",{key:"032d03e701fbe169bf57088c9b8539f41d8877e6","label-tag":"max-time","label-text":"Max Time (min)",value:n.exports.toString(this.diveConfig.maxTime),name:"maxTime","input-type":"number",onFormItemChanged:e=>this.inputHandler(e),validator:["required",{name:"minvalue",options:{min:1}}],onIsValid:e=>this.validateForm("time",e.detail)}),i("ion-list-header",{key:"fbfd0957fa31c91b33e1b0fc6f47c060a4a86fa5"},i("my-transl",{key:"375c2716854aa43a1aa16cef8dc47d5d7885aa6b",tag:"tanks-configuration",text:"Tank(s) Configuration",isLabel:true})),i("ion-list-header",{key:"27975707e1b66924278abc224b538166ffd8fb45"},i("ion-grid",{key:"433932ff1626f886b83c3f167da2583ec780b5db",class:"ion-no-padding"},i("ion-row",{key:"308a156552b085ecae77b05ef634d579689d4ee6"},i("ion-col",{key:"9727e0abd41d2b8aa3ba48f860d0fe6628c38e11"},i("my-transl",{key:"510aef560e87eca71d502d7534ba52b16eb520a6",tag:"bottom",text:"Bottom",isLabel:true})),i("ion-col",{key:"012f8a4075460a9bc536f506644ee96bba1ed258",size:"1"},i("ion-row",{key:"b6ffb923f23dd501d7a351a1088079acb328db6c",class:"ion-text-center"},i("ion-button",{key:"c4de55be0014c5cd47c0bda17078f1ae5825ccfe","icon-only":true,fill:"clear",color:"primary",onClick:e=>this.addTank(this.screenWidth>=500?e:null,true)},i("ion-icon",{key:"23f03b9118324d7c0c2cabb351b81f8b22e8e009",name:"add-circle"}))))))),this.diveConfig.configuration.bottom.length>0?i("ion-grid",null,i("ion-row",{class:"ion-text-center"},this.diveConfig.configuration.bottom.map(((e,t)=>i("ion-col",{size:"12","size-sm":true},e.name?i("ion-card",null,i("ion-card-header",{class:"ion-text-center"},e.name),i("ion-card-content",{class:"ion-text-center"},i("p",null,e.gas.toString()),i("p",null,e.pressure,d.pressUnit," / ",e.getGasVolume(),d.volumeUnit)),i("ion-grid",{class:"ion-no-padding"},i("ion-row",null,i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:i=>this.addTank(this.screenWidth>=500?i:null,true,e)},i("ion-icon",{name:"create"}),i("my-transl",{tag:"edit",text:"Edit"}))),i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:()=>this.deleteTank(true,t)},i("ion-icon",{name:"trash"}),i("my-transl",{tag:"delete",text:"Delete"})))))):undefined))))):undefined,i("ion-list-header",{key:"d4cb1840a369abc666601d0b0b2acbd18f91daad"},i("ion-grid",{key:"83c1128e647ab419bb914397f5d87b85b2b6f54c",class:"ion-no-padding"},i("ion-row",{key:"1063db52f752d4afdd3a8d56df8316b3af731c99"},i("ion-col",{key:"907b3312d0c3d076c1872a5fa4888a5a8ff09f9a"},i("my-transl",{key:"f8d5e1925cb39d12da673fe81aa82435679b6fff",tag:"deco",text:"Deco",isLabel:true})),i("ion-col",{key:"b448c06fcd1f63dcebb388a66245640b2b46f3d6",size:"1"},i("ion-row",{key:"725103ab265265bac81479559d34ee2b2289c54e",class:"ion-text-center"},i("ion-button",{key:"6246655feb242edda65a92277d0e82bc0b3d6689","icon-only":true,fill:"clear",color:"primary",onClick:e=>this.addTank(this.screenWidth>=500?e:null,false)},i("ion-icon",{key:"9a9c8a51afba3405f462133d95ffa406ededc7c3",name:"add-circle"}))))))),this.diveConfig.configuration.deco.length>0?i("ion-grid",{class:"ion-no-padding"},i("ion-row",{class:"ion-text-center"},this.diveConfig.configuration.deco.map(((e,t)=>i("ion-col",{size:"12","size-sm":true},e.name?i("ion-card",null,i("ion-card-header",{class:"ion-text-center"},e.name),i("ion-card-content",{class:"ion-text-center"},i("p",null,e.gas.toString()),i("p",null,e.pressure,d.pressUnit," / ",e.getGasVolume(),d.volumeUnit)),i("ion-grid",{class:"ion-no-padding"},i("ion-row",null,i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:i=>this.addTank(this.screenWidth>=500?i:null,false,e)},i("ion-icon",{name:"create"}),i("my-transl",{tag:"edit",text:"Edit"}))),i("ion-col",null,i("ion-button",{"icon-left":true,fill:"clear",size:"small",onClick:()=>this.deleteTank(false,t)},i("ion-icon",{name:"trash"}),i("my-transl",{tag:"delete",text:"Delete"})))))):undefined))))):undefined,i("app-decoplanner-settings",{key:"2c4f4ce961e21279d345f17bd599aa3bfcf46d47",diveDataToShare:this.diveDataToShare,onUpdateParamsEvent:e=>this.updateParams(e)}))),i("app-modal-footer",{key:"00a300d3cf70f7580163c3ddb64b048557045c84",disableSave:!this.showSave,onCancelEmit:()=>this.close(),onSaveEmit:()=>this.save()})]}get el(){return t(this)}};m.style=f;export{m as modal_dive_configuration};