import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import{l as s}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as o,m as c}from"./p-c2915cc5.js";import{T as n,U as d,R as l,aW as f}from"./p-6934ed3c.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const b="popover-new-class-activity .validation-error{text-align:center;font-size:0.7rem;color:red}";const r=b;const h=class{constructor(t){e(this,t);this.typeSelectOptions=[];this.stdConfigurations=[];this.activity=undefined;this.showDiveLocation=true;this.updateView=false;this.validActivity=false}componentWillLoad(){this.typeSelectOptions=[{tag:"theory",text:n.getTransl("theory","Theory")},{tag:"dry",text:n.getTransl("dry","Dry")},{tag:"in-water",text:n.getTransl("in-water","In Water")},{tag:"dive",text:n.getTransl("dive","Dive")}];this.stdConfigurations=s.exports.cloneDeep(d.userSettings.userConfigurations);this.validateActivity()}validateActivity(){this.validActivity=s.exports.isNumber(this.activity.day)&&s.exports.isString(this.activity.type)&&s.exports.isString(this.activity.title.tag)&&s.exports.isString(this.activity.title.text);if(this.activity.type=="dive"){this.validActivity=this.validActivity&&this.activity.divePlan!==null}this.updateView=!this.updateView}updateDay(e){this.activity.day=e;this.validateActivity()}updateType(e){if(e!="dive"&&this.activity.type=="dive"){this.activity.divePlan=null}this.activity.type=e;this.validateActivity()}updateTitle(e){let t=e.detail.value;if(e.detail.name=="tag"){t=t.toLowerCase().replace(" ","-").trim()}this.activity.title[e.detail.name]=t;this.validateActivity()}async addDivePlan(){let e=[];s.exports.forEach(this.stdConfigurations,((t,a)=>{e.push({type:"radio",label:t.stdName,value:a,checked:a==0?true:false})}));const t=await o.create({header:n.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:n.getTransl("ok","OK"),handler:async e=>{const t=await l.openModal("modal-dive-template",{selectedConfiguration:this.stdConfigurations[e],stdConfigurations:this.stdConfigurations,dive:0,user:d.userProfile});t.onDidDismiss().then((e=>{const t=e.data;if(t){this.activity.divePlan=t;this.validateActivity();this.updateView=!this.updateView}}))}},{text:n.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});t.present()}async editDivePlan(){const e=await f.presentDiveTemplateUpdate(this.activity.divePlan,0,this.showDiveLocation);if(e){this.activity.divePlan=e;this.updateView=!this.updateView}}async save(){c.dismiss(this.activity)}cancel(){c.dismiss()}render(){return t(a,{key:"401fd2e7ded95af73f94acc02d4160ba0ad68b27"},t("ion-toolbar",{key:"0d88a37c054a0e296b64b3b9bdb2d0675b04e4a9"},t("ion-title",{key:"a44c4dfefb393c354a4b005206bd15335c880a49"},t("my-transl",{key:"f264650c9dccd51087bc756c07b012a63a9885cd",tag:"class-activity",text:"Class Activity"}))),t("ion-item",{key:"eaea5a1aa0954a65a1fdd4cbfd59755c74259e21"},t("ion-label",{key:"46e0a9f1bdaee6ca0808acb1625661342a9c5e00"},t("my-transl",{key:"d759db3e910060c70030e8ea2bc5f30f25e03cdd",tag:"class-day",text:"Class Day"})),t("ion-select",{key:"061683f3d9d9060893f240d9b44d6d6515672c90",value:this.activity.day,onIonChange:e=>this.updateDay(e.detail.value),interface:"popover"},t("ion-select-option",{key:"48037dc3e6a7336d0555bab2b125d44f09ffcb59",value:1},"1"),t("ion-select-option",{key:"ec39f52c15002fc8186395f1b10a9751f5ca04b1",value:2},"2"),t("ion-select-option",{key:"55b0cbeb65103b11bf418356516a936747f691fb",value:3},"3"),t("ion-select-option",{key:"c3383c895bbd8da1c5f8ed3f06cb612d63676c1c",value:4},"4"),t("ion-select-option",{key:"7135328a3415494e3efc7c1ebae0811ff0c931b2",value:5},"5"),t("ion-select-option",{key:"c3e46ef0e0cd97b5f2759d0e2811283a5c2db006",value:6},"6"),t("ion-select-option",{key:"5eab1e6be674c08a6e901f3fdeb462ff99a46ccb",value:7},"7"),t("ion-select-option",{key:"d81ffee87a81e421e2e7ae4212152543eed0aa56",value:8},"8"),t("ion-select-option",{key:"6029f7e3ae394534a0d27a19bd33d8b5aa72bd72",value:9},"9"),t("ion-select-option",{key:"c58b5dfb9da63edfb4723eeafbeefd024fb53e63",value:10},"10"))),t("ion-item",{key:"087ab24f44e4061059ce3309524a104b884504fa"},t("ion-label",{key:"bba28914850a5f33a6382eeba26cb1cc6dd53243"},t("my-transl",{key:"76204aaccf4ae9abbe382333d861107d91e7b4e3",tag:"type",text:"Type"})),t("ion-select",{key:"6106de7564b3004c40e4e56e5ab408832e4a0837",value:this.activity.type,onIonChange:e=>this.updateType(e.detail.value),interface:"popover"},this.typeSelectOptions.map((e=>t("ion-select-option",{value:e.tag},e.text))))),t("app-form-item",{key:"bca41f224df0ea649de0666ce116fb6276269d98","label-tag":"unique-id","label-text":"Unique ID",value:this.activity.title.tag,name:"tag","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"7dcbbedf4e8de721ae10feef005d9bdc453924d7","label-tag":"title","label-text":"Title",value:this.activity.title.text,name:"text","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required"]}),this.activity.type=="dive"?this.activity.divePlan?t("ion-item",null,t("ion-label",null,this.activity.divePlan.dives[0].getDiveDetails().map((e=>t("p",null,e)))),t("ion-button",{"icon-only":true,fill:"clear",onClick:()=>this.editDivePlan()},t("ion-icon",{name:"create-outline"}))):t("ion-button",{expand:"full",onClick:()=>this.addDivePlan()},"Add Dive Plan"):undefined,t("app-modal-footer",{key:"73f21703dcf6911a60681f376e82964eb6837feb",disableSave:!this.validActivity,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};h.style=r;export{h as popover_new_class_activity};