import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import{l as c}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as s,m as o}from"./p-c2915cc5.js";import{T as n,U as l,R as d,aW as f}from"./p-773bd3de.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const b="popover-new-class-activity .validation-error{text-align:center;font-size:0.7rem;color:red}";const r=b;const h=class{constructor(t){e(this,t);this.typeSelectOptions=[];this.stdConfigurations=[];this.activity=undefined;this.showDiveLocation=true;this.updateView=false;this.validActivity=false}componentWillLoad(){this.typeSelectOptions=[{tag:"theory",text:n.getTransl("theory","Theory")},{tag:"dry",text:n.getTransl("dry","Dry")},{tag:"in-water",text:n.getTransl("in-water","In Water")},{tag:"dive",text:n.getTransl("dive","Dive")}];this.stdConfigurations=c.exports.cloneDeep(l.userSettings.userConfigurations);this.validateActivity()}validateActivity(){this.validActivity=c.exports.isNumber(this.activity.day)&&c.exports.isString(this.activity.type)&&c.exports.isString(this.activity.title.tag)&&c.exports.isString(this.activity.title.text);if(this.activity.type=="dive"){this.validActivity=this.validActivity&&this.activity.divePlan!==null}this.updateView=!this.updateView}updateDay(e){this.activity.day=e;this.validateActivity()}updateType(e){if(e!="dive"&&this.activity.type=="dive"){this.activity.divePlan=null}this.activity.type=e;this.validateActivity()}updateTitle(e){let t=e.detail.value;if(e.detail.name=="tag"){t=t.toLowerCase().replace(" ","-").trim()}this.activity.title[e.detail.name]=t;this.validateActivity()}async addDivePlan(){let e=[];c.exports.forEach(this.stdConfigurations,((t,a)=>{e.push({type:"radio",label:t.stdName,value:a,checked:a==0?true:false})}));const t=await s.create({header:n.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:n.getTransl("ok","OK"),handler:async e=>{const t=await d.openModal("modal-dive-template",{selectedConfiguration:this.stdConfigurations[e],stdConfigurations:this.stdConfigurations,dive:0,user:l.userProfile});t.onDidDismiss().then((e=>{const t=e.data;if(t){this.activity.divePlan=t;this.validateActivity();this.updateView=!this.updateView}}))}},{text:n.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});t.present()}async editDivePlan(){const e=await f.presentDiveTemplateUpdate(this.activity.divePlan,0,this.showDiveLocation);if(e){this.activity.divePlan=e;this.updateView=!this.updateView}}async save(){o.dismiss(this.activity)}cancel(){o.dismiss()}render(){return t(a,{key:"5241af5d918c81ae8bbb05f5f6f6e8c2e8e81e7e"},t("ion-toolbar",{key:"5fe1b3d85648e44151f135f0a987d81a294ae59d"},t("ion-title",{key:"0117e956652ce1202294ba3739401d0f91cc7e48"},t("my-transl",{key:"14d660193f72f182930f2f2feae2f6df4eb3441a",tag:"class-activity",text:"Class Activity"}))),t("ion-item",{key:"ac3424cd90a1341e6acd3fe28a0019f40d8977d7"},t("ion-label",{key:"9e6b4f7812982f8815bac40f1d3de340fa850c83"},t("my-transl",{key:"1942355e76aa9bf032c72b56f56770ec3ebf46b4",tag:"class-day",text:"Class Day"})),t("ion-select",{key:"6240a4a9af293d6ea5c4dbda979fc9a21d1c8d58",value:this.activity.day,onIonChange:e=>this.updateDay(e.detail.value),interface:"popover"},t("ion-select-option",{key:"5e13c8ddffb101f4ce115fff1a3fcf0de48aad7a",value:1},"1"),t("ion-select-option",{key:"e56bce6b3f1f3bf1f5daf330e55e2024885f01c3",value:2},"2"),t("ion-select-option",{key:"601e23843e72c9953ba9c76c13182543afbd7742",value:3},"3"),t("ion-select-option",{key:"9cab60f004b78c0ebac55d7debbbbbdce76573f5",value:4},"4"),t("ion-select-option",{key:"4529e3ca82a337d96b35ced4b4e9eb7dcbabd3b8",value:5},"5"),t("ion-select-option",{key:"dee98c343b8cc3de7c0016280b85ab1dfe0b7a56",value:6},"6"),t("ion-select-option",{key:"1c32519ebeb9b18782933e810b78443fda2b0ad6",value:7},"7"),t("ion-select-option",{key:"d96063ce1a2d8a2ba40943b44f657a626bafbeae",value:8},"8"),t("ion-select-option",{key:"a7d71600e7ea39074dc7bb751401e1f452909e44",value:9},"9"),t("ion-select-option",{key:"e04198b5b9b49b8116f280a1c347b999574c1253",value:10},"10"))),t("ion-item",{key:"67b888f485fbd25ca5bb1d7c789a37c5084bd866"},t("ion-label",{key:"ce72334a97049434ac07eef7ede7bf3c09bcd67d"},t("my-transl",{key:"1d0adeee3bc3fe0c1d67a2cf3862c702824e932c",tag:"type",text:"Type"})),t("ion-select",{key:"c3009f6bc52ce3de2f39d0c8accf9007c7344147",value:this.activity.type,onIonChange:e=>this.updateType(e.detail.value),interface:"popover"},this.typeSelectOptions.map((e=>t("ion-select-option",{value:e.tag},e.text))))),t("app-form-item",{key:"43a685e5ab157c3069f13a711422cf61c93c2b6e","label-tag":"unique-id","label-text":"Unique ID",value:this.activity.title.tag,name:"tag","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"0cd1ddf002d44c7bd4cad14eb629c4c6daf36e92","label-tag":"title","label-text":"Title",value:this.activity.title.text,name:"text","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required"]}),this.activity.type=="dive"?this.activity.divePlan?t("ion-item",null,t("ion-label",null,this.activity.divePlan.dives[0].getDiveDetails().map((e=>t("p",null,e)))),t("ion-button",{"icon-only":true,fill:"clear",onClick:()=>this.editDivePlan()},t("ion-icon",{name:"create-outline"}))):t("ion-button",{expand:"full",onClick:()=>this.addDivePlan()},"Add Dive Plan"):undefined,t("app-modal-footer",{key:"5fe66ef3b0431d45cf1c776c957b435fa2bc4f08",disableSave:!this.validActivity,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};h.style=r;export{h as popover_new_class_activity};