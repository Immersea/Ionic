import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import{l as s}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as c,n as o}from"./p-5d4a8e1f.js";import{T as d,U as n,R as l,aE as f}from"./p-736235c6.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1819cfda.js";import"./p-46038295.js";import"./p-7ee16e8d.js";const r="popover-new-class-activity .validation-error{text-align:center;font-size:0.7rem;color:red}";const b=r;const p=class{constructor(t){e(this,t);this.typeSelectOptions=[];this.stdConfigurations=[];this.activity=undefined;this.showDiveLocation=true;this.updateView=false;this.validActivity=false}componentWillLoad(){this.typeSelectOptions=[{tag:"theory",text:d.getTransl("theory","Theory")},{tag:"dry",text:d.getTransl("dry","Dry")},{tag:"in-water",text:d.getTransl("in-water","In Water")},{tag:"dive",text:d.getTransl("dive","Dive")}];this.stdConfigurations=s.exports.cloneDeep(n.userSettings.userConfigurations);this.validateActivity()}validateActivity(){this.validActivity=s.exports.isNumber(this.activity.day)&&s.exports.isString(this.activity.type)&&s.exports.isString(this.activity.title.tag)&&s.exports.isString(this.activity.title.text);if(this.activity.type=="dive"){this.validActivity=this.validActivity&&this.activity.divePlan!==null}this.updateView=!this.updateView}updateDay(e){this.activity.day=e;this.validateActivity()}updateType(e){if(e!="dive"&&this.activity.type=="dive"){this.activity.divePlan=null}this.activity.type=e;this.validateActivity()}updateTitle(e){let t=e.detail.value;if(e.detail.name=="tag"){t=t.toLowerCase().replace(" ","-").trim()}this.activity.title[e.detail.name]=t;this.validateActivity()}async addDivePlan(){let e=[];s.exports.forEach(this.stdConfigurations,((t,a)=>{e.push({type:"radio",label:t.stdName,value:a,checked:a==0?true:false})}));const t=await c.create({header:d.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:d.getTransl("ok","OK"),handler:async e=>{const t=await l.openModal("modal-dive-template",{selectedConfiguration:this.stdConfigurations[e],stdConfigurations:this.stdConfigurations,dive:0,user:n.userProfile});t.onDidDismiss().then((e=>{const t=e.data;if(t){this.activity.divePlan=t;this.validateActivity();this.updateView=!this.updateView}}))}},{text:d.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});t.present()}async editDivePlan(){const e=await f.presentDiveTemplateUpdate(this.activity.divePlan,0,this.showDiveLocation);if(e){this.activity.divePlan=e;this.updateView=!this.updateView}}async save(){o.dismiss(this.activity)}cancel(){o.dismiss()}render(){return t(a,{key:"3170ff95d55374c269a34c66d3e04e9d599ef21c"},t("ion-toolbar",{key:"0c526cc72994039448423c600771f1565b85ad50"},t("ion-title",{key:"9a5a4cd5d9b4affb05ef7b832a8403d54258a356"},t("my-transl",{key:"133e27c909f3b8358fc0b8b70e8ca9ff7933e56a",tag:"class-activity",text:"Class Activity"}))),t("ion-item",{key:"bb8a8acfb59dc3d3644d5a8e54d713b3c43195ec"},t("ion-label",{key:"3ce302c5af7699b4d24468a3970edc24138f2842"},t("my-transl",{key:"7ffd5a1e7b4474d05021f41d53185c9cfeec27f2",tag:"class-day",text:"Class Day"})),t("ion-select",{key:"d04c6b2e2f3f9053d314440952c3ffcdd5abf1a4",value:this.activity.day,onIonChange:e=>this.updateDay(e.detail.value),interface:"popover"},t("ion-select-option",{key:"b5aa5fe83cdd0aef102bb8208ed5c935392308ba",value:1},"1"),t("ion-select-option",{key:"8beec3d280277837e447328b75bf929d4d53e2b0",value:2},"2"),t("ion-select-option",{key:"c2e02969c3376e9e3aaf4a5faad7ab1d42eaf4fc",value:3},"3"),t("ion-select-option",{key:"8d4b3089c148abb4079d976aa842b93a25260946",value:4},"4"),t("ion-select-option",{key:"efabc9e4ccc0662e0285fcc43b86cd45d532d25a",value:5},"5"),t("ion-select-option",{key:"9a1d7d26ad4721bc92c25473e3f15373fb3e3014",value:6},"6"),t("ion-select-option",{key:"8d25df308c96fec2939b224419ce54687dfc6ced",value:7},"7"),t("ion-select-option",{key:"7078ad0215971f28f70b2d6af110fbbad5b00ca8",value:8},"8"),t("ion-select-option",{key:"4ef577592dfcb562084b9c4dc5561a8c3efc03fa",value:9},"9"),t("ion-select-option",{key:"ad8eed9ed51688280239fa2a4f0df2e44677a938",value:10},"10"))),t("ion-item",{key:"abe2ddde318abac8d0a6bb6eabd76a9dd0d48acb"},t("ion-label",{key:"68af294f409627b9f61c8fc5d0ad5d7e039e4c12"},t("my-transl",{key:"6f3e90215180b37309bcffe1dda7a4cd01aba34b",tag:"type",text:"Type"})),t("ion-select",{key:"ddc07d8c9e3adda05f78ea602ba28a46a67b41ce",value:this.activity.type,onIonChange:e=>this.updateType(e.detail.value),interface:"popover"},this.typeSelectOptions.map((e=>t("ion-select-option",{value:e.tag},e.text))))),t("app-form-item",{key:"5b677b7f5b88cec57decbac9e16a567ac3381211","label-tag":"unique-id","label-text":"Unique ID",value:this.activity.title.tag,name:"tag","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"f2771ea0aafd2bd45434a83d03ac95368a4c448d","label-tag":"title","label-text":"Title",value:this.activity.title.text,name:"text","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required"]}),this.activity.type=="dive"?this.activity.divePlan?t("ion-item",null,t("ion-label",null,this.activity.divePlan.dives[0].getDiveDetails().map((e=>t("p",null,e)))),t("ion-button",{"icon-only":true,fill:"clear",onClick:()=>this.editDivePlan()},t("ion-icon",{name:"create-outline"}))):t("ion-button",{expand:"full",onClick:()=>this.addDivePlan()},"Add Dive Plan"):undefined,t("app-modal-footer",{key:"017038eded9b2eeaec361322de13bec18a690f4d",disableSave:!this.validActivity,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};p.style=b;export{p as popover_new_class_activity};