import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s}from"./p-5d4a8e1f.js";import{l as d}from"./p-1af05547.js";import{E as c}from"./p-a9f4af61.js";import{Q as o,W as l,S as f}from"./p-30358c9d.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-2578d979.js";import"./p-7ee16e8d.js";const n="modal-datasheet-family ion-list{width:100%}";const h=n;const r=class{constructor(t){e(this,t);this.index=0;this.datasheetFamilies=undefined;this.datasheetFamily=undefined;this.updateView=true;this.validDatasheetFamily=false}async componentWillLoad(){await this.loadDatasheetFamilies()}async loadDatasheetFamilies(){await o.downloadDatasheetSettings();this.datasheetFamilies=d.exports.cloneDeep(o.getDatasheetFamilies());if(this.datasheetFamilies&&this.datasheetFamilies.length>0){this.datasheetFamily=this.datasheetFamilies[0]}else{this.addDatasheetFamily()}this.validateDatasheet()}selectType(e){this.datasheetFamily=this.datasheetFamilies.find((t=>t.familyId==e.detail.value));this.validateDatasheet()}handleChange(e){const t=e.detail.name;let a=e.detail.value;if(t=="familyId"){a=a.replace(/\s+/g,"-").trim().toLowerCase()}this.datasheetFamily[t]=a;this.validateDatasheet()}validateDatasheet(){this.validDatasheetFamily=d.exports.isString(this.datasheetFamily.familyId)&&d.exports.isString(this.datasheetFamily.familyName);this.updateView=!this.updateView}addDatasheetFamily(){this.datasheetFamily=new l;this.datasheetFamilies.push(this.datasheetFamily);this.index=this.datasheetFamilies.length-1}duplicateDatasheetFamily(){this.datasheetFamily=d.exports.cloneDeep(this.datasheetFamily);this.datasheetFamily.familyId=this.datasheetFamily.familyId+"_rev.";this.datasheetFamilies.push(this.datasheetFamily);this.index=this.datasheetFamilies.length-1}async deleteDatasheetFamily(){try{this.datasheetFamilies.splice(this.index,1);this.index=0;this.datasheetFamily=this.datasheetFamilies[0];this.validateDatasheet()}catch(e){if(e)f.presentAlertError(e)}}async save(e=true){await o.uploadDatasheetSettings("family",this.datasheetFamilies);return e?s.dismiss():true}async cancel(){return s.dismiss()}render(){return t(a,{key:"cce0685f1c7a5456f1b8edbad826622d8fe98fc5"},t("ion-content",{key:"5c2660d522b24119fc444fe099979a0a0f2d682d"},t("ion-grid",{key:"463a32b233e8d9ce57e99ff9ba8fb583eaf69b5e"},t("ion-row",{key:"9d6864d5b34d9a8a04a083d558358dbb63642ccb"},t("ion-col",{key:"f07de29d7f5f0af545d55e4ff08dcc0c734c4cb7"},t("app-select-search",{key:"1c547c96e6644de8faa8ffd77e068b581cdd431e",color:"trasteel",label:{tag:"datasheet_family",text:"Datasheet Family"},value:this.index?this.datasheetFamilies[this.index].familyId:this.datasheetFamilies[0].familyId,lines:"none","label-placement":"floating",selectFn:e=>this.selectType(e),selectOptions:this.datasheetFamilies,selectValueId:"familyId",selectValueText:["familyName"],disabled:!this.validDatasheetFamily})),t("ion-col",{key:"f3dd95fa7f786ad9a807a7d3435d7a45acef07ed",size:"1",class:"ion-text-center"},t("ion-button",{key:"82b4d87c9cc19d48f2c65e794164faa518b2f96f",fill:"clear",disabled:!this.validDatasheetFamily,onClick:()=>this.addDatasheetFamily()},t("ion-icon",{key:"deea04d155abe2371371f1f9f09cfd5cf19a0390",name:"add",slot:"start"}))),t("ion-col",{key:"5fce071916c8480aef65158a3e1db1e28bdaa213",size:"1",class:"ion-text-center"},t("ion-button",{key:"6981068551ad167cf65ec03bc17c5517edabe770",fill:"clear",disabled:!this.validDatasheetFamily,onClick:()=>this.duplicateDatasheetFamily()},t("ion-icon",{key:"1674af073129ea896848a40c9ddc6ff89b295032",slot:"start",name:"duplicate"}))),t("ion-col",{key:"f80e66a3c8f11caa74309f343d873478954efa1a",size:"1",class:"ion-text-center"},t("ion-button",{key:"80d808376a3a52f202fd9d844ab61178351ac559",fill:"clear",color:"danger",disabled:this.datasheetFamilies.length==0,onClick:()=>this.deleteDatasheetFamily()},t("ion-icon",{key:"4815eac2fb747350da16be36d570a09a6c0dd47b",slot:"start",name:"trash"}))))),t("app-form-item",{key:"e7ee76a41daac3bc1e44acf164811e2dbd3d20f6","label-text":"ID",value:this.datasheetFamily.familyId,name:"familyId","input-type":"string",onFormItemChanged:e=>this.handleChange(e),labelPosition:"fixed",validator:["required",{name:"uniqueid",options:{type:"list",index:"familyId",list:o.getDatasheetFamilies()}}]}),t("app-form-item",{key:"27bdf3e6525ac7c6defd67d5c5994eeb73fe307e","label-text":"Name",value:this.datasheetFamily.familyName,name:"familyName","input-type":"string",onFormItemChanged:e=>this.handleChange(e),labelPosition:"fixed",validator:["required"]})),t("app-modal-footer",{key:"c6d84d78c341fcbab5ec7487c1c5545d0ba1f1f2",color:c.getAppColor(),disableSave:!this.validDatasheetFamily,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};r.style=h;export{r as modal_datasheet_family};