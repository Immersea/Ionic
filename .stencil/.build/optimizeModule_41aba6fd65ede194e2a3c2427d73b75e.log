import{r as e,h as t,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s}from"./p-c2915cc5.js";import{l as d}from"./p-1af05547.js";import{S as c,ag as o,E as r,v as n}from"./p-773bd3de.js";import{S as p}from"./p-a75993af.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";const f="modal-dive-certification-update ion-list{width:100%}";const l=f;const h=class{constructor(t){e(this,t);this.agencyId=undefined;this.diveCertification=undefined;this.validCert=false;this.newCert=false;this.updateView=false;this.titles=[{tag:"details"},{tag:"schedule"}];this.slider=undefined}async componentWillLoad(){this.newCert=!this.diveCertification.id;this.certGroups=c.systemPreferences.selectOptions.certificationGroups;if(this.diveCertification.activities)this.diveCertification.activities=this.diveCertification.activities.map((e=>{if(e.divePlan)e.divePlan=new o(e.divePlan);return e}))}async componentDidLoad(){this.slider=new p(".slider-dive-cert",{speed:400,spaceBetween:100,allowTouchMove:true,autoHeight:true});this.validateCert()}handleCertChange(e){if(e.detail.name=="maxDepth"||e.detail.name=="numberOfStudents"){this.diveCertification[e.detail.name]=d.exports.toNumber(e.detail.value)}else{this.diveCertification[e.detail.name]=e.detail.value}this.validateCert()}updateCertGroup(e){this.diveCertification.group=e;this.validateCert()}uniqueIdValid(e){this.validCert=this.validCert&&e.detail}updateImageUrls(e){const t=e.detail.type;const i=e.detail.url;if(t=="photo"){this.diveCertification.photoURL=i}else{this.diveCertification.coverURL=i}}validateCert(){this.validCert=d.exports.isString(this.diveCertification.id)&&d.exports.isString(this.diveCertification.name)&&this.diveCertification.numberOfStudents>0&&this.diveCertification.maxDepth>0}async save(){return s.dismiss(this.diveCertification)}async cancel(){return s.dismiss()}render(){return t(i,{key:"86d068ff5ab7b8eb4a7d5959940923e2f7d71c87"},t("ion-header",{key:"01cb96381467cd23d88428bd03c36dd9b84f342a"},this.diveCertification.id?t("app-upload-cover",{item:{collection:n,id:this.agencyId+"-"+this.diveCertification.id,photoURL:this.diveCertification.photoURL,coverURL:this.diveCertification.coverURL},onCoverUploaded:e=>this.updateImageUrls(e)}):undefined),t("app-header-segment-toolbar",{key:"b22df169656ac433b057864e01625bd8618c8393",color:r.getAppColor(),swiper:this.slider,titles:this.titles}),t("ion-content",{key:"1f8ebec2b32c05b03d8867bb6b76fc173a866696",class:"slides"},t("swiper-container",{key:"c53d3315c08e1622f07d98b40baa5905fa450913",class:"slider-dive-cert swiper"},t("swiper-wrapper",{key:"14a9a7cdb787c3696704e1d6554d95e9d867a079",class:"swiper-wrapper"},t("swiper-slide",{key:"286d675eb45cf1ecfabc23b7321108cea4dcf559",class:"swiper-slide"},t("ion-list",{key:"bf5dbcbf4f3c18d876005e22b2d3efb8e4308667"},t("app-form-item",{key:"9728a9ca972714d0cb5d3b61b5891bd879cc8c0b","label-tag":"unique-id","label-text":"Unique ID",value:this.diveCertification.id,disabled:!this.newCert,name:"id","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),onIsValid:e=>this.uniqueIdValid(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"b30b79c31d9f156c3120ced404116fde7c3552ae","label-tag":"name","label-text":"Name",value:this.diveCertification.name,name:"name","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"e4da22b5ec6bc5b7747c191db19d56521eb60b5c","label-tag":"max-depth","label-text":"Max. Depth",value:d.exports.toString(this.diveCertification.maxDepth),name:"maxDepth","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"31831fbe9f297fb8c65c2eb76384247f1d583cda","label-tag":"max-students","label-text":"Max. number of students",value:d.exports.toString(this.diveCertification.numberOfStudents),name:"numberOfStudents","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("ion-item",{key:"426ebd1ec3836538cb5810851c83f2a6a7ffabaf"},t("ion-label",{key:"14adb3933f3c19d7ccf5c79a0c94f4ee8ad7c2a9"},"Certification Group"),t("ion-select",{key:"d2a928f5d5160a63432cbb7327bf2aea84f1a022",value:this.diveCertification.group,onIonChange:e=>this.updateCertGroup(e.detail.value),interface:"popover"},this.certGroups.map((e=>t("ion-select-option",{value:e.tag},e.text))))))),t("swiper-slide",{key:"f45e4cf2f8b510463eb8b9df9e8bf08430073810",class:"swiper-slide"},t("app-dive-course-activities",{key:"dfbfe7bd0068e269cc4aa8829f663c82cfc08a53",schedule:this.diveCertification.activities,showDiveLocation:false,onScheduleEmit:e=>this.diveCertification.activities=e.detail,editable:true}))))),t("app-modal-footer",{key:"bd606d54ff42b0daa9526aa3973da29f387741f1",disableSave:!this.validCert,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};h.style=l;export{h as modal_dive_certification_update};