import{r as s,h as t,H as e,f as i}from"./p-cbe60c68.js";import{U as a,b as c,M as n,O as o,Q as r,V as h,c as p,C as l,W as d,f as b,g as m,d as f,e as u,D as k,a as g,X as y,E as x}from"./p-773bd3de.js";import"./p-c7ee7cfe.js";import"./p-694b8ade.js";import"./p-1af05547.js";import"./p-e9c4f463.js";import"./p-c2915cc5.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const v="app-map-popup .margin{margin-bottom:10px}app-map-popup .center{text-align:center}app-map-popup h2{padding-left:5px;padding-right:5px}app-map-popup ion-thumbnail{position:relative;margin-top:-50px;margin-bottom:0;margin-right:auto;margin-left:auto;width:50px;height:50px}app-map-popup ion-thumbnail img{border-radius:50%;padding:0.08em;border:solid 0.25em lightsteelblue;background-color:white}app-map-popup .cover{position:relative;background-color:lightblue;background-size:cover;background-position:center;background-repeat:no-repeat;overflow:hidden;box-shadow:0 4px 8px 0 rgba(0, 0, 0, 0.2);width:100%;height:80px}";const j=v;const w=class{constructor(t){s(this,t);this.properties=undefined}componentWillLoad(){this.propObject=JSON.parse(this.properties);this.propObject.item=JSON.parse(this.propObject.item);this.mapElement=this.el.closest("app-map");this.userRoles=a.userRoles;this.setLinesForItem()}disconnectedCallback(){this.removeLinesForItem()}setLinesForItem(){if(this.propObject.collection==c&&this.propObject.item.diveSites&&this.propObject.item.diveSites.length>0){const s=this.propObject.item.diveSites;this.propObject.item=new n(this.propObject.item);const t=[this.propObject.item];s.forEach((async s=>{const e=o.getDiveSitesDetails(s);t.push(e);this.mapElement["createLine"](s,this.propObject.item,e)}));this.mapElement["fitToBounds"](t)}else if(this.propObject.collection==r&&this.propObject.item.divingCenters&&this.propObject.item.divingCenters.length>0){const s=this.propObject.item.divingCenters;this.propObject.item=new h(this.propObject.item);const t=[this.propObject.item];s.forEach((async s=>{const e=p.getDivingCenterDetails(s);t.push(e);this.mapElement["createLine"](s,this.propObject.item,e)}));this.mapElement["fitToBounds"](t)}}removeLinesForItem(){if(this.propObject.collection==c&&this.propObject.item.diveSites&&this.propObject.item.diveSites.length>0){const s=this.propObject.item.diveSites;s.forEach((async s=>{this.mapElement["removeLine"](s)}))}else if(this.propObject.collection==r&&this.propObject.item.divingCenters&&this.propObject.item.divingCenters.length>0){const s=this.propObject.item.divingCenters;s.forEach((async s=>{this.mapElement["removeLine"](s)}))}}async openModal(){switch(this.propObject.collection){case y:a.presentUserDetails(this.propObject.id);break;case r:o.presentDiveSiteDetails(this.propObject.id);break;case c:p.presentDivingCenterDetails(this.propObject.id);break;case k:g.presentDiveCommunityDetails(this.propObject.id);break;case f:u.presentDivingSchoolDetails(this.propObject.id);break;case b:m.presentServiceCenterDetails(this.propObject.id);break;case"markers-feature":if(this.propObject.item.collection==l)d.presentCustomerDetails(this.propObject.item.id);break}this.mapElement["closePopup"]()}async planDive(){o.presentDiveSiteDetails(this.propObject.id,true);this.mapElement["closePopup"]()}async editModal(){switch(this.propObject.collection){case y:a.presentUserDetails(this.propObject.id);break;case r:o.presentDiveSiteUpdate(this.propObject.id);break;case c:p.presentDivingCenterUpdate(this.propObject.id);break;case k:g.presentDiveCommunityUpdate(this.propObject.id);break;case f:u.presentDivingSchoolUpdate(this.propObject.id);break;case b:m.presentServiceCenterUpdate(this.propObject.id);break}this.mapElement["closePopup"]()}async delete(){switch(this.propObject.collection){case"userPublicProfiles":break;case r:o.deleteDiveSite(this.propObject.id);break;case c:p.deleteDivingCenter(this.propObject.id);break;case k:g.deleteDiveCommunity(this.propObject.id);break;case f:u.deleteDivingSchool(this.propObject.id);break;case b:m.deleteServiceCenter(this.propObject.id);break}this.mapElement["closePopup"]()}render(){return t(e,{key:"017ec6c91151a4fea3c33ec00adeb91b8e4ad471"},this.propObject.item.coverURL?t("div",{class:"cover",style:this.propObject.item.coverURL?{backgroundImage:"url("+this.propObject.item.coverURL+")"}:undefined}):undefined,this.propObject.item.photoURL?t("ion-thumbnail",null,t("img",{src:this.propObject.item.photoURL?this.propObject.item.photoURL:"assets/images/avatar.png"})):undefined,t("h2",{key:"7c913e7a4d87b843d3e89bd2a9ae0856561a1d97",class:"center"},this.propObject.item.displayName),t("div",{key:"067ffcfae9b1d4275498215f22a2529b6a8f488b",class:"center"},t("ion-button",{key:"828ace0b29a46ec41a6fe71791e95c15f9ed56ce",expand:"full",fill:"outline",color:"dark",onClick:()=>this.openModal()},t("my-transl",{key:"54047d44f7c540509a55ced8123286a73c97e88c",tag:"details",text:"Details"}))),this.propObject.collection==r?t("div",{class:"center"},t("ion-button",{expand:"full",fill:"outline",color:"secondary",onClick:()=>this.planDive()},t("my-transl",{tag:"plan-dive",text:"Plan a Dive"}))):undefined,!x.isTrasteel()&&this.userRoles&&this.userRoles.isSuperAdmin()?[t("div",{class:"center"},t("ion-button",{expand:"full",fill:"outline",color:"primary",onClick:()=>this.editModal()},t("my-transl",{tag:"edit",text:"Edit"}))),t("div",{class:"center"},t("ion-button",{expand:"full",fill:"outline",color:"danger",onClick:()=>this.delete()},t("my-transl",{tag:"delete",text:"Delete"})))]:undefined,t("div",{key:"84a0ff3727fc2c2ea3946d8915a9ae0dec8dad05",class:"margin"}))}get el(){return i(this)}};w.style=j;export{w as app_map_popup};