import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s}from"./p-5d4a8e1f.js";import{l as d}from"./p-1af05547.js";import{S as o,a1 as c,t as r}from"./p-736235c6.js";import{S as n}from"./p-a75993af.js";import{E as p}from"./p-46038295.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";import"./p-1819cfda.js";import"./p-7ee16e8d.js";const f="modal-dive-certification-update ion-list{width:100%}";const l=f;const h=class{constructor(t){e(this,t);this.agencyId=undefined;this.diveCertification=undefined;this.validCert=false;this.newCert=false;this.updateView=false;this.titles=[{tag:"details"},{tag:"schedule"}];this.slider=undefined}async componentWillLoad(){this.newCert=!this.diveCertification.id;this.certGroups=o.systemPreferences.selectOptions.certificationGroups;if(this.diveCertification.activities)this.diveCertification.activities=this.diveCertification.activities.map((e=>{if(e.divePlan)e.divePlan=new c(e.divePlan);return e}))}async componentDidLoad(){this.slider=new n(".slider-dive-cert",{speed:400,spaceBetween:100,allowTouchMove:true,autoHeight:true});this.validateCert()}handleCertChange(e){if(e.detail.name=="maxDepth"||e.detail.name=="numberOfStudents"){this.diveCertification[e.detail.name]=d.exports.toNumber(e.detail.value)}else{this.diveCertification[e.detail.name]=e.detail.value}this.validateCert()}updateCertGroup(e){this.diveCertification.group=e;this.validateCert()}uniqueIdValid(e){this.validCert=this.validCert&&e.detail}updateImageUrls(e){const t=e.detail.type;const a=e.detail.url;if(t=="photo"){this.diveCertification.photoURL=a}else{this.diveCertification.coverURL=a}}validateCert(){this.validCert=d.exports.isString(this.diveCertification.id)&&d.exports.isString(this.diveCertification.name)&&this.diveCertification.numberOfStudents>0&&this.diveCertification.maxDepth>0}async save(){return s.dismiss(this.diveCertification)}async cancel(){return s.dismiss()}render(){return t(a,{key:"00d619bd779ba9072b100eac114ea172dd275b1d"},t("ion-header",{key:"c054da00a2390528cb871044a2aa030c4fd15ff9"},this.diveCertification.id?t("app-upload-cover",{item:{collection:r,id:this.agencyId+"-"+this.diveCertification.id,photoURL:this.diveCertification.photoURL,coverURL:this.diveCertification.coverURL},onCoverUploaded:e=>this.updateImageUrls(e)}):undefined),t("app-header-segment-toolbar",{key:"564fa87d20a55de43a261febba0979ede8a8aab4",color:p.getAppColor(),swiper:this.slider,titles:this.titles}),t("ion-content",{key:"9483195a832949f0381f9b4fa652e53bde93d2c1",class:"slides"},t("swiper-container",{key:"373a1f6077bc3a41576e4d7ef81c3c9a5670c034",class:"slider-dive-cert swiper"},t("swiper-wrapper",{key:"d30bc64c263c781de88b60cc046247f4de187efd",class:"swiper-wrapper"},t("swiper-slide",{key:"6fe7d97fdfae5458c9bf0ffc5870d6ec875fceef",class:"swiper-slide"},t("ion-list",{key:"f994a2df39058e4e3f6a138e89ef66d9c1ae6dc8"},t("app-form-item",{key:"664f558c39fed63581631607b92a8d7cc1d9a665","label-tag":"unique-id","label-text":"Unique ID",value:this.diveCertification.id,disabled:!this.newCert,name:"id","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),onIsValid:e=>this.uniqueIdValid(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"ad821257587be23c6cedaaa34bb720cc3259aba1","label-tag":"name","label-text":"Name",value:this.diveCertification.name,name:"name","input-type":"text",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"a985b3b5fbf344728e2a70607d7ea73c6d0c94d7","label-tag":"max-depth","label-text":"Max. Depth",value:d.exports.toString(this.diveCertification.maxDepth),name:"maxDepth","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("app-form-item",{key:"767adc7faa48111ad9acb2aba98b2d33b2098318","label-tag":"max-students","label-text":"Max. number of students",value:d.exports.toString(this.diveCertification.numberOfStudents),name:"numberOfStudents","input-type":"number",onFormItemChanged:e=>this.handleCertChange(e),validator:["required"]}),t("ion-item",{key:"4d78eb058937173a9b494860abe14fc9bf8ad76b"},t("ion-label",{key:"11d0135e7368aa6ca391c0f76c7cc32e596a73d4"},"Certification Group"),t("ion-select",{key:"34bc3024b25e4734874ba2d233fd21cc78a1c699",value:this.diveCertification.group,onIonChange:e=>this.updateCertGroup(e.detail.value),interface:"popover"},this.certGroups.map((e=>t("ion-select-option",{value:e.tag},e.text))))))),t("swiper-slide",{key:"ad03dfcf219db05544bc2751f44e0a20a81589c2",class:"swiper-slide"},t("app-dive-course-activities",{key:"19756dc4d0b98551ffce8ea6249408e4b27654af",schedule:this.diveCertification.activities,showDiveLocation:false,onScheduleEmit:e=>this.diveCertification.activities=e.detail,editable:true}))))),t("app-modal-footer",{key:"ec607eaf45b4b30f7a54db39503a3a0bd33ee95f",disableSave:!this.validCert,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};h.style=l;export{h as modal_dive_certification_update};