import{r as e,h as i,H as t,f as s}from"./p-cbe60c68.js";import{T as a,aq as d,ar as c,U as o}from"./p-c24c8a77.js";import"./p-c7ee7cfe.js";import{n as r}from"./p-c2915cc5.js";import{l as n}from"./p-1af05547.js";import{S as p}from"./p-a75993af.js";import"./p-694b8ade.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const h="modal-dive-trip-update ion-list{width:100%}modal-dive-trip-update ion-segment-button{--color-checked:var(--ion-color-divetrip-contrast)}";const l=h;const f=class{constructor(i){e(this,i);this.diveTripId=undefined;this.collectionId=undefined;this.organiserId=undefined;this.diveTrip=undefined;this.updateView=true;this.validTrip=false;this.titles=[{tag:"dives"},{tag:"team"},{tag:"bookings"}];this.slider=undefined}async componentWillLoad(){await this.loadDiveTrip();this.placeholder=a.getTransl("insert-title","Insert title")}async loadDiveTrip(){if(this.diveTripId){this.diveTrip=await d.getDiveTrip(this.diveTripId)}else{this.diveTrip=new c;this.diveTrip.organiser={collectionId:this.collectionId,id:this.organiserId};this.diveTrip.users={[o.userRoles.uid]:["owner"]}}}async componentDidLoad(){this.slider=new p(".slider-dive-trip",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null}}});this.validateTrip()}async addDiveTrip(e,i){this.diveTrip=await d.addDiveTrip(this.diveTrip,e,i);this.validateTrip()}removeDiveTrip(e){this.diveTrip=d.removeDiveTrip(this.diveTrip,e);this.validateTrip()}removeTripDive(e,i){this.diveTrip=d.removeTripDive(this.diveTrip,e,i);this.updateView=!this.updateView}setTitle(e){this.diveTrip.displayName=e.target.value;this.validateTrip()}validateTrip(){this.diveTrip.tripDives=n.exports.orderBy(this.diveTrip.tripDives,"divePlan.dives[0].date");this.validTrip=n.exports.isString(this.diveTrip.displayName)&&this.diveTrip.displayName.length>3&&this.diveTrip.tripDives.length>0;this.updateView=!this.updateView}async save(){await d.updateDiveTrip(this.diveTripId,this.diveTrip);return r.dismiss(false)}async cancel(){return r.dismiss(true)}render(){return i(t,{key:"bd3381cad058b3206ee36c2a3a27f33283c43d53"},i("ion-header",{key:"7e1bededc7fe4f2b58591953871b9d89c5b39f9a"},i("ion-toolbar",{key:"5167cf1e925c6d3ee1eb41c801852d2b47cc82bf",color:"divetrip"},i("ion-title",{key:"c6d6be9b34ca369f30d5006eee312297f6cf5b02"},i("ion-input",{key:"38ad71be9e2bc3766acaf181a620485803ad619b",placeholder:this.placeholder+"...",inputmode:"text",onIonInput:e=>this.setTitle(e),value:this.diveTrip.displayName})))),i("app-header-segment-toolbar",{key:"a578af200afb0c119d034bfd50108a0ea77717c5",color:"divetrip",swiper:this.slider,titles:this.titles}),i("ion-content",{key:"fbbd92bfa9fa92012940e54515d9a6b17e7b98a5",class:"slides"},i("swiper-container",{key:"a47900682a6eddae890038c973e9304578258031",class:"slider-dive-trip swiper"},i("swiper-wrapper",{key:"53581f6970c4931aab1f1e46e6c31f535335fee2",class:"swiper-wrapper"},i("swiper-slide",{key:"439e25c717ebdc90dc2016d0403e23e63bb2bc8b",class:"swiper-slide"},i("ion-grid",{key:"1fbcc4921c3a0c4c0898529be83a6d3b5eae7e56"},i("ion-row",{key:"c2c12798ee8ba5683dd199360f879f7c62134337",class:"ion-text-start"},this.diveTrip.tripDives.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4"},i("app-dive-trip-card",{tripDive:e,editable:true,updateView:this.updateView,onAddDiveEmit:()=>this.addDiveTrip(t),onRemoveDiveTripEmit:()=>this.removeDiveTrip(t),onRemoveTripDiveEmit:e=>this.removeTripDive(t,n.exports.toNumber(e.detail)),onUpdateDiveEmit:e=>this.addDiveTrip(t,n.exports.toNumber(e.detail))})))),i("ion-col",{key:"17bf9defff94260c058c7810e4f7be583c46eb0e","size-sm":"12","size-md":"6","size-lg":"4"},i("ion-card",{key:"f55fd1c305e05fdc9b1141607add124ed672ae7d",onClick:()=>this.addDiveTrip()},i("ion-card-content",{key:"0609851185da612a370d45d11f1c2541907cbc87",class:"ion-text-center"},i("ion-icon",{key:"4358375a9b2000d4f829e767db142902104de1d8",name:"add-circle-outline",style:{fontSize:"130px"}}))))))),i("swiper-slide",{key:"3dfb0e8e613e8eb03a6e3c97589c4075b9022571",class:"swiper-slide"},i("app-users-list",{key:"0dadb0b153432bced916320a0c9cecd54faf37b4",item:this.diveTrip,editable:true,show:["owner","divemaster","instructor"]})),i("swiper-slide",{key:"0590b4fb55482918ad2ce368c141ecc51ce14b86",class:"swiper-slide"},i("ion-grid",{key:"44af2d0495a29b1f35674b306e1333cc4580a745"},i("ion-row",{key:"384eddd1aca00d21d2c1d627fa9f0edc84919303"},Object.keys(this.diveTrip.tripDives).map((e=>i("ion-col",{"size-sm":"12","size-md":"12","size-lg":"12"},i("app-dive-trip-bookings",{diveTrip:this.diveTrip,diveTripId:this.diveTripId,tripDiveIndex:n.exports.toNumber(e),editable:true})))))))))),i("app-modal-footer",{key:"32519dc53f456eb97f1edb87a7c88028d744139c",disableSave:!this.validTrip,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return s(this)}};f.style=l;export{f as modal_dive_trip_update};