import{r as e,h as t,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s,a as n}from"./p-c2915cc5.js";import{o,aw as l,q as d,E as c}from"./p-c24c8a77.js";import{T as r}from"./p-169038af.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1af05547.js";import"./p-e9c4f463.js";class f{getUserRoles(){return["registered","translator","superAdmin"]}}const m=new f;const h="modal-edit-user-roles ion-list{width:100%}";const p=h;const b=class{constructor(t){e(this,t);this.uid=undefined;this.userRoles=undefined;this.updateView=false}async componentWillLoad(){const e=await o.getDocument(l,this.uid);this.userRoles=new d(e)}async save(){await o.updateDocument(l,this.uid,this.userRoles);s.dismiss()}async cancel(){s.dismiss()}async presentActionSheet(){let e=[];let t=[];if(c.isTrasteel()){t=r.getUserRoles()}else if(c.isDecoplanner()||c.isUdive()){t=m.getUserRoles()}t.forEach((t=>{if(!this.userRoles.roles.includes(t)){e.push({text:t,handler:()=>{this.userRoles.roles.push(t);this.updateView=!this.updateView}})}}));e.push({text:"Close",icon:"close",role:"cancel",handler:()=>{}});const i=await n.create({header:"Add",buttons:e});await i.present()}updateLicense(e,t){this.userRoles.licences[e]=t.detail.checked;this.updateView=!this.updateView}handleChange(e){if(e.detail.name=="fromDate"){this.userRoles.licences.trial.fromDate=new Date(e.detail.value)}else{this.userRoles.licences.trial[e.detail.name]=e.detail.value}this.updateView=!this.updateView}deleteRole(e){const t=this.itemSliding.getElementsByClassName("item-sliding-"+e)[0];t.closeOpened();this.userRoles.roles.splice(e,1);this.updateView=!this.updateView}render(){return t(i,{key:"c6397fec65d2af6f6b1568115801afea0a06d8f1"},t("ion-header",{key:"8aaa1a5ddd265a79e41cec21922c3a37417c2139"},t("ion-toolbar",{key:"29a9fb361c31fa5a3a9b1745f501ad3e9d25a4bb",color:c.getAppColor()},t("ion-title",{key:"5667ad061cfc8b38e4db0768d3ed877ff93a1c30"},"User Roles Manager"))),t("ion-content",{key:"2f7acf4f62e30ddfde7e6beb522f715e7b3593f2"},t("ion-list",{key:"a0dfdc1850e9a20e190d8bc508b3bd57c465dc24"},t("ion-item",{key:"1ec7a93a44726515c0ca49e658a599ca1af9fe6f"},"uid: ",this.userRoles.uid),t("ion-item",{key:"2e182245c617ac1f26bc414db6639b3959860c28"},"email: ",this.userRoles.email),!c.isTrasteel&&Object.keys(this.userRoles.licences).length>0?[t("ion-item-divider",null,"User Licences"),Object.keys(this.userRoles.licences).map((e=>e=="trial"?[t("ion-item-divider",null,t("ion-label",null,"Trial")),t("app-form-item",{"label-tag":"duration","label-text":"Duration",value:this.userRoles.licences.trial.duration,name:"duration","input-type":"number",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{"label-tag":"fromDate","label-text":"From Date",value:this.userRoles.licences.trial.fromDate!==null?this.userRoles.licences.trial.fromDate.toISOString():(new Date).toISOString(),name:"fromDate","input-type":"date",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{"label-tag":"level","label-text":"Level",value:this.userRoles.licences.trial.level,name:"level","input-type":"string",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("ion-item",null,t("ion-label",null,t("p",null,"Trial Days:"," ",this.userRoles.licences.trialDays())))]:[t("ion-item",null,t("ion-label",null,e),t("ion-toggle",{slot:"end",onIonChange:t=>this.updateLicense(e,t),checked:this.userRoles.licences[e]}))]))]:null),t("ion-list",{key:"221fa55cf489a3fa6500c879affa925a730a3885"},t("ion-item-divider",{key:"443f3b985d9dbff4c1fe21ae195e9613072486c5"},"User Roles"),this.userRoles.roles.map(((e,i)=>t("ion-item-sliding",{class:"item-sliding-"+i},t("ion-item",null,t("ion-label",null,e)),t("ion-item-options",null,t("ion-item-option",{color:"danger",onClick:()=>this.deleteRole(i)},"Delete"))))),t("ion-item",{key:"f65d332e1ffa0d0527a0f01f50d4e37c067cd46c",button:true,onClick:()=>this.presentActionSheet()},t("ion-icon",{key:"5cf157382e3a60d2333ab336a0aa63ed4b6d6d97",name:"add"}),t("ion-label",{key:"de05eb2ff094765746f6a179a7da526eb6d6e71e"},"Add")))),t("app-modal-footer",{key:"6b2aa596806269390e2d3bcaa0687e9021d33067",color:c.getAppColor(),onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get itemSliding(){return a(this)}};b.style=p;export{b as modal_edit_user_roles};