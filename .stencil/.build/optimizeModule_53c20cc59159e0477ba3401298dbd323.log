import{r as e,h as i,H as t,f as s}from"./p-cbe60c68.js";import{T as a,aa as d,ab as o,U as c}from"./p-736235c6.js";import"./p-c7ee7cfe.js";import{o as r}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{S as p}from"./p-a75993af.js";import"./p-1819cfda.js";import"./p-e9c4f463.js";import"./p-46038295.js";import"./p-694b8ade.js";import"./p-7ee16e8d.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const f="modal-dive-trip-update ion-list{width:100%}modal-dive-trip-update ion-segment-button{--color-checked:var(--ion-color-divetrip-contrast)}";const h=f;const l=class{constructor(i){e(this,i);this.diveTripId=undefined;this.collectionId=undefined;this.organiserId=undefined;this.diveTrip=undefined;this.updateView=true;this.validTrip=false;this.titles=[{tag:"dives"},{tag:"team"},{tag:"bookings"}];this.slider=undefined}async componentWillLoad(){await this.loadDiveTrip();this.placeholder=a.getTransl("insert-title","Insert title")}async loadDiveTrip(){if(this.diveTripId){this.diveTrip=await d.getDiveTrip(this.diveTripId)}else{this.diveTrip=new o;this.diveTrip.organiser={collectionId:this.collectionId,id:this.organiserId};this.diveTrip.users={[c.userRoles.uid]:["owner"]}}}async componentDidLoad(){this.slider=new p(".slider-dive-trip",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null}}});this.validateTrip()}async addDiveTrip(e,i){this.diveTrip=await d.addDiveTrip(this.diveTrip,e,i);this.validateTrip()}removeDiveTrip(e){this.diveTrip=d.removeDiveTrip(this.diveTrip,e);this.validateTrip()}removeTripDive(e,i){this.diveTrip=d.removeTripDive(this.diveTrip,e,i);this.updateView=!this.updateView}setTitle(e){this.diveTrip.displayName=e.target.value;this.validateTrip()}validateTrip(){this.diveTrip.tripDives=n.exports.orderBy(this.diveTrip.tripDives,"divePlan.dives[0].date");this.validTrip=n.exports.isString(this.diveTrip.displayName)&&this.diveTrip.displayName.length>3&&this.diveTrip.tripDives.length>0;this.updateView=!this.updateView}async save(){await d.updateDiveTrip(this.diveTripId,this.diveTrip);return r.dismiss(false)}async cancel(){return r.dismiss(true)}render(){return i(t,{key:"279846d0f15dc36a325c771d5e96500d9fc59e72"},i("ion-header",{key:"65be55fd63684614eeb0eb02d2a5ccf2d2b8cbb4"},i("ion-toolbar",{key:"bf50a83fba2ae8b9c482b6f3c8321b7691035948",color:"divetrip"},i("ion-title",{key:"86f5ec627df6a7ddc5c904866ee4355a64068945"},i("ion-input",{key:"7e1ec7492987ae78be123421cf3f39f23e8181ba",placeholder:this.placeholder+"...",inputmode:"text",onIonInput:e=>this.setTitle(e),value:this.diveTrip.displayName})))),i("app-header-segment-toolbar",{key:"e627b5b6c0a78cc54937bf2cfe9db4a607e03888",color:"divetrip",swiper:this.slider,titles:this.titles}),i("ion-content",{key:"6983209d9f0e68adf81ce7efa1a8508928270f29",class:"slides"},i("swiper-container",{key:"17f5c8ba41c0453e0a6d32b8b707553ef066e3d3",class:"slider-dive-trip swiper"},i("swiper-wrapper",{key:"b0d7655c6c71f2f41423b7115b41eaa54970672f",class:"swiper-wrapper"},i("swiper-slide",{key:"3d4f1fddf4b12b67f27c91b79f5259d58c8e8489",class:"swiper-slide"},i("ion-grid",{key:"12136e4bf5497ac435b001bd4cb6df9ac5a085ae"},i("ion-row",{key:"c1a119c313a0d08ba37168f95624484f52affc47",class:"ion-text-start"},this.diveTrip.tripDives.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4"},i("app-dive-trip-card",{tripDive:e,editable:true,updateView:this.updateView,onAddDiveEmit:()=>this.addDiveTrip(t),onRemoveDiveTripEmit:()=>this.removeDiveTrip(t),onRemoveTripDiveEmit:e=>this.removeTripDive(t,n.exports.toNumber(e.detail)),onUpdateDiveEmit:e=>this.addDiveTrip(t,n.exports.toNumber(e.detail))})))),i("ion-col",{key:"e3daea9f440c257d883b7918cd4e6741c3ead026","size-sm":"12","size-md":"6","size-lg":"4"},i("ion-card",{key:"e53ab23114b134fd4806a938668f36a1162108af",onClick:()=>this.addDiveTrip()},i("ion-card-content",{key:"fc689d745a5bcd59dcb2643afba45dfeea0be43a",class:"ion-text-center"},i("ion-icon",{key:"711fb1b02db363d01b240df39137c97d576d1b9a",name:"add-circle-outline",style:{fontSize:"130px"}}))))))),i("swiper-slide",{key:"a41d3dc735f0420a9d2a1738b4da26239d7c7c73",class:"swiper-slide"},i("app-users-list",{key:"8f45d79eb9f9ff658dd37424ce6a39f6da119a7c",item:this.diveTrip,editable:true,show:["owner","divemaster","instructor"]})),i("swiper-slide",{key:"0a629563487f740c473e762dbbb06b0e7aba1fc7",class:"swiper-slide"},i("ion-grid",{key:"78c4f4047948c97c042e95312c412f37567ac33f"},i("ion-row",{key:"3a3efaba9aa03cb10155f123160511c1bae96a32"},Object.keys(this.diveTrip.tripDives).map((e=>i("ion-col",{"size-sm":"12","size-md":"12","size-lg":"12"},i("app-dive-trip-bookings",{diveTrip:this.diveTrip,diveTripId:this.diveTripId,tripDiveIndex:n.exports.toNumber(e),editable:true})))))))))),i("app-modal-footer",{key:"8f378e7fefb649ae910c59d413403b80e057f25a",disableSave:!this.validTrip,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return s(this)}};l.style=h;export{l as modal_dive_trip_update};