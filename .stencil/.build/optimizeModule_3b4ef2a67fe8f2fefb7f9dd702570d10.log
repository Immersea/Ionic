import{r as t,h as e,f as o}from"./p-cbe60c68.js";import{ay as s,W as c,i as r,P as i}from"./p-6934ed3c.js";import{l as a}from"./p-1af05547.js";import{T as p}from"./p-8f5c3082.js";import"./p-c7ee7cfe.js";import"./p-694b8ade.js";import"./p-c2915cc5.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";const d="page-projects{}";const n=d;const l=class{constructor(e){t(this,e);this.projectsList=[];this.filteredProjectsList=[];this.loading=true;this.updateView=true}componentWillLoad(){s.projectsList$.subscribe((async t=>{const e=[];t.map((t=>{const o=a.exports.cloneDeep(t);const s=c.getCustomersDetails(t.customerId);if(s){o.customerId=s.fullName;e.push(o)}}));this.updateList(e);this.loading=false}))}componentDidLoad(){this.searchToolbar=this.el.querySelector("#searchToolbar");this.updateList(this.projectsList)}updateList(t){this.projectsList=t;this.searchToolbar?this.searchToolbar.forceFilter(this.projectsList):undefined;this.updateView=!this.updateView}addProject(){s.presentProjectUpdate()}getOptions(){if(p.isRefraDBAdmin()){return[{tag:"delete",text:"Delete",icon:"trash",color:"danger",func:t=>s.deleteProject(t,false)},{tag:"duplicate",text:"Duplicate",icon:"duplicate",color:"secondary",func:t=>s.duplicateProject(t)},{tag:"edit",text:"Edit",icon:"create",color:"primary",func:t=>s.presentProjectUpdate(t)}]}else return null}render(){return[e("ion-header",{key:"1a8a687ac18c4c6667ed7781af6e4f0b0dbb3ca1"},e("app-navbar",{key:"6cad593153d47841905a15d36aaafedaa7cf448c",tag:"projects",text:"Projects",color:"trasteel"}),e("app-search-toolbar",{key:"6662fce6fe16a2d3b78f6df1cd22b65c1f5d0923",id:"searchToolbar",searchTitle:"projects",list:this.projectsList,orderFields:["customerId","projectLocalId"],color:"trasteel",placeholder:"Search by customer or project",filterBy:["customerId","projectLocalId","projectDescription"],onFilteredList:t=>this.filteredProjectsList=t.detail})),e("ion-content",{key:"7257e1a12b925c1bf73d40ba056909ed14070fe5"},p.isRefraDBAdmin()?e("ion-fab",{vertical:"top",horizontal:"end",slot:"fixed",edge:true},e("ion-fab-button",{size:"small",onClick:()=>this.addProject(),color:"trasteel"},e("ion-icon",{name:"add"}))):undefined,e("app-infinite-scroll",{key:"5f59db26396ba6af7194ba96eeb9cb06cd6e1eb4",list:this.filteredProjectsList,loading:this.loading,showFields:["projectLocalId"],showNotes:["projectDescription"],groupBy:["customerId"],options:this.getOptions(),returnField:"id",icon:r.getMapDocs(i).icon.name,onItemClicked:t=>s.presentProjectDetails(t.detail)}))]}get el(){return o(this)}};l.style=n;export{l as page_projects};