import{bn as t,bo as n,bp as s,bq as i,br as e,bs as o,bt as r,bu as a,bv as c,bw as h,bx as u,a$ as l,b1 as d,by as w,b0 as f,bz as p,bA as y,bB as b,bC as m,bD as v,bE as g,bF as I,bG as W,bH as E,bI as k,bJ as C,bK as P,bL as N,bM as R,bN as U,bO as A,bP as j,bQ as S,bR as G,bS as L,bT as O,bU as T,bV as M,bW as V,bX as $,bY as D,bZ as F,b_ as x,b$ as Y,c0 as J,c1 as q}from"./p-6934ed3c.js";import"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import"./p-694b8ade.js";import"./p-1af05547.js";import"./p-e9c4f463.js";import"./p-c2915cc5.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";class z extends t{constructor(){super();this.lastConfirmationResult=new Map;const t=n();t.onAuthStateChanged((t=>this.handleAuthStateChange(t)))}async applyActionCode(t){const i=n();return s(i,t.oobCode)}async createUserWithEmailAndPassword(t){const s=n();const e=await i(s,t.email,t.password);return this.createSignInResult(e,null)}async confirmPasswordReset(t){const s=n();return e(s,t.oobCode,t.newPassword)}async confirmVerificationCode(t){const{verificationCode:n,verificationId:s}=t;const i=this.lastConfirmationResult.get(s);if(!i){throw new Error(z.ERROR_CONFIRMATION_RESULT_MISSING)}const e=await i.confirm(n);return this.createSignInResult(e,null)}async deleteUser(){const t=n();const s=t.currentUser;if(!s){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}return o(s)}async fetchSignInMethodsForEmail(t){const s=n();const i=await r(s,t.email);return{signInMethods:i}}async getPendingAuthResult(){this.throwNotAvailableError()}async getCurrentUser(){const t=n();const s=this.createUserResult(t.currentUser);const i={user:s};return i}async getIdToken(t){const s=n();if(!s.currentUser){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}const i=await s.currentUser.getIdToken(t===null||t===void 0?void 0:t.forceRefresh);const e={token:i||""};return e}async getRedirectResult(){const t=n();const s=await a(t);const i=s?c.credentialFromResult(s):null;return this.createSignInResult(s,i)}async getTenantId(){const t=n();return{tenantId:t.tenantId}}async isSignInWithEmailLink(t){const s=n();return{isSignInWithEmailLink:h(s,t.emailLink)}}async linkWithApple(t){const n=new c(u.APPLE);this.applySignInOptions(t||{},n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async linkWithEmailAndPassword(t){const n=l.credential(t.email,t.password);const s=await this.linkCurrentUserWithCredential(n);return this.createSignInResult(s,n)}async linkWithEmailLink(t){const n=l.credentialWithLink(t.email,t.emailLink);const s=await this.linkCurrentUserWithCredential(n);return this.createSignInResult(s,n)}async linkWithFacebook(t){const n=new d;this.applySignInOptions(t||{},n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=d.credentialFromResult(s);return this.createSignInResult(s,i)}async linkWithGameCenter(){this.throwNotAvailableError()}async linkWithGithub(t){const n=new w;this.applySignInOptions(t||{},n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=w.credentialFromResult(s);return this.createSignInResult(s,i)}async linkWithGoogle(t){const n=new f;this.applySignInOptions(t||{},n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=f.credentialFromResult(s);return this.createSignInResult(s,i)}async linkWithMicrosoft(t){const n=new c(u.MICROSOFT);this.applySignInOptions(t||{},n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async linkWithOpenIdConnect(t){const n=new c(t.providerId);this.applySignInOptions(t,n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async linkWithPhoneNumber(t){const s=n();const i=s.currentUser;if(!i){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}if(!t.phoneNumber){throw new Error(z.ERROR_PHONE_NUMBER_MISSING)}if(!t.recaptchaVerifier||!(t.recaptchaVerifier instanceof p)){throw new Error(z.ERROR_RECAPTCHA_VERIFIER_MISSING)}try{const n=await y(i,t.phoneNumber,t.recaptchaVerifier);const{verificationId:s}=n;this.lastConfirmationResult.set(s,n);const e={verificationId:s};this.notifyListeners(z.PHONE_CODE_SENT_EVENT,e)}catch(t){const n={message:this.getErrorMessage(t)};this.notifyListeners(z.PHONE_VERIFICATION_FAILED_EVENT,n)}}async linkWithPlayGames(){this.throwNotAvailableError()}async linkWithTwitter(t){const n=new b;this.applySignInOptions(t||{},n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=b.credentialFromResult(s);return this.createSignInResult(s,i)}async linkWithYahoo(t){const n=new c(u.YAHOO);this.applySignInOptions(t||{},n);const s=await this.linkCurrentUserWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async reload(){const t=n();const s=t.currentUser;if(!s){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}return m(s)}async revokeAccessToken(t){const s=n();return v(s,t.token)}async sendEmailVerification(t){const s=n();const i=s.currentUser;if(!i){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}return g(i,t===null||t===void 0?void 0:t.actionCodeSettings)}async sendPasswordResetEmail(t){const s=n();return I(s,t.email,t.actionCodeSettings)}async sendSignInLinkToEmail(t){const s=n();return W(s,t.email,t.actionCodeSettings)}async setLanguageCode(t){const s=n();s.languageCode=t.languageCode}async setPersistence(t){const s=n();switch(t.persistence){case E.BrowserLocal:await k(s,N);break;case E.BrowserSession:await k(s,P);break;case E.IndexedDbLocal:await k(s,C);break;case E.InMemory:await k(s,q);break}}async setTenantId(t){const s=n();s.tenantId=t.tenantId}async signInAnonymously(){const t=n();const s=await R(t);return this.createSignInResult(s,null)}async signInWithApple(t){const n=new c(u.APPLE);this.applySignInOptions(t||{},n);const s=await this.signInWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async signInWithCustomToken(t){const s=n();const i=await U(s,t.token);return this.createSignInResult(i,null)}async signInWithEmailAndPassword(t){const s=n();const i=await A(s,t.email,t.password);return this.createSignInResult(i,null)}async signInWithEmailLink(t){const s=n();const i=await j(s,t.email,t.emailLink);return this.createSignInResult(i,null)}async signInWithFacebook(t){const n=new d;this.applySignInOptions(t||{},n);const s=await this.signInWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=d.credentialFromResult(s);return this.createSignInResult(s,i)}async signInWithGithub(t){const n=new w;this.applySignInOptions(t||{},n);const s=await this.signInWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=w.credentialFromResult(s);return this.createSignInResult(s,i)}async signInWithGoogle(t){const n=new f;this.applySignInOptions(t||{},n);const s=await this.signInWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=f.credentialFromResult(s);return this.createSignInResult(s,i)}async signInWithMicrosoft(t){const n=new c(u.MICROSOFT);this.applySignInOptions(t||{},n);const s=await this.signInWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async signInWithOpenIdConnect(t){const n=new c(t.providerId);this.applySignInOptions(t,n);const s=await this.signInWithPopupOrRedirect(n,t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async signInWithPhoneNumber(t){if(!t.phoneNumber){throw new Error(z.ERROR_PHONE_NUMBER_MISSING)}if(!t.recaptchaVerifier||!(t.recaptchaVerifier instanceof p)){throw new Error(z.ERROR_RECAPTCHA_VERIFIER_MISSING)}const s=n();try{const n=await S(s,t.phoneNumber,t.recaptchaVerifier);const{verificationId:i}=n;this.lastConfirmationResult.set(i,n);const e={verificationId:i};this.notifyListeners(z.PHONE_CODE_SENT_EVENT,e)}catch(t){const n={message:this.getErrorMessage(t)};this.notifyListeners(z.PHONE_VERIFICATION_FAILED_EVENT,n)}}async signInWithPlayGames(){this.throwNotAvailableError()}async signInWithGameCenter(){this.throwNotAvailableError()}async signInWithTwitter(t){const n=new b;this.applySignInOptions(t||{},n);const s=await this.signInWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=b.credentialFromResult(s);return this.createSignInResult(s,i)}async signInWithYahoo(t){const n=new c(u.YAHOO);this.applySignInOptions(t||{},n);const s=await this.signInWithPopupOrRedirect(n,t===null||t===void 0?void 0:t.mode);const i=c.credentialFromResult(s);return this.createSignInResult(s,i)}async signOut(){const t=n();await t.signOut()}async unlink(t){const s=n();if(!s.currentUser){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}const i=await G(s.currentUser,t.providerId);const e=this.createUserResult(i);const o={user:e};return o}async updateEmail(t){const s=n();const i=s.currentUser;if(!i){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}return L(i,t.newEmail)}async updatePassword(t){const s=n();const i=s.currentUser;if(!i){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}return O(i,t.newPassword)}async updateProfile(t){const s=n();const i=s.currentUser;if(!i){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}return T(i,{displayName:t.displayName,photoURL:t.photoUrl})}async useAppLanguage(){const t=n();t.useDeviceLanguage()}async useEmulator(t){const s=n();const i=t.port||9099;const e=t.scheme||"http";if(t.host.includes("://")){M(s,`${t.host}:${i}`)}else{M(s,`${e}://${t.host}:${i}`)}}handleAuthStateChange(t){const n=this.createUserResult(t);const s={user:n};this.notifyListeners(z.AUTH_STATE_CHANGE_EVENT,s,true)}applySignInOptions(t,n){if(t.customParameters){const s={};t.customParameters.map((t=>{s[t.key]=t.value}));n.setCustomParameters(s)}if(t.scopes){for(const s of t.scopes){n.addScope(s)}}}signInWithPopupOrRedirect(t,s){const i=n();if(s==="redirect"){return V(i,t)}else{return $(i,t)}}linkCurrentUserWithPopupOrRedirect(t,s){const i=n();if(!i.currentUser){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}if(s==="redirect"){return D(i.currentUser,t)}else{return F(i.currentUser,t)}}linkCurrentUserWithCredential(t){const s=n();if(!s.currentUser){throw new Error(z.ERROR_NO_USER_SIGNED_IN)}return x(s.currentUser,t)}createSignInResult(t,n){const s=this.createUserResult((t===null||t===void 0?void 0:t.user)||null);const i=this.createCredentialResult(n);const e=this.createAdditionalUserInfoResult(t);const o={user:s,credential:i,additionalUserInfo:e};return o}createCredentialResult(t){if(!t){return null}const n={providerId:t.providerId};if(t instanceof Y){n.accessToken=t.accessToken;n.idToken=t.idToken;n.secret=t.secret}return n}createUserResult(t){if(!t){return null}const n={displayName:t.displayName,email:t.email,emailVerified:t.emailVerified,isAnonymous:t.isAnonymous,metadata:this.createUserMetadataResult(t.metadata),phoneNumber:t.phoneNumber,photoUrl:t.photoURL,providerData:this.createUserProviderDataResult(t.providerData),providerId:t.providerId,tenantId:t.tenantId,uid:t.uid};return n}createUserMetadataResult(t){const n={};if(t.creationTime){n.creationTime=Date.parse(t.creationTime)}if(t.lastSignInTime){n.lastSignInTime=Date.parse(t.lastSignInTime)}return n}createUserProviderDataResult(t){return t.map((t=>({displayName:t.displayName,email:t.email,phoneNumber:t.phoneNumber,photoUrl:t.photoURL,providerId:t.providerId,uid:t.uid})))}createAdditionalUserInfoResult(t){if(!t){return null}const n=J(t);if(!n){return null}const{isNewUser:s,profile:i,providerId:e,username:o}=n;const r={isNewUser:s};if(e!==null){r.providerId=e}if(i!==null){r.profile=i}if(o!==null&&o!==undefined){r.username=o}return r}getErrorMessage(t){if(t instanceof Object&&"message"in t&&typeof t["message"]==="string"){return t["message"]}return JSON.stringify(t)}throwNotAvailableError(){throw new Error("Not available on web.")}}z.AUTH_STATE_CHANGE_EVENT="authStateChange";z.PHONE_CODE_SENT_EVENT="phoneCodeSent";z.PHONE_VERIFICATION_FAILED_EVENT="phoneVerificationFailed";z.ERROR_NO_USER_SIGNED_IN="No user is signed in.";z.ERROR_PHONE_NUMBER_MISSING="phoneNumber must be provided.";z.ERROR_RECAPTCHA_VERIFIER_MISSING="recaptchaVerifier must be provided and must be an instance of RecaptchaVerifier.";z.ERROR_CONFIRMATION_RESULT_MISSING="No confirmation result with this verification id was found.";export{z as FirebaseAuthenticationWeb};