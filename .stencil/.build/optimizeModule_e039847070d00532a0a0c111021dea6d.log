import{r as e,h as t,f as i}from"./p-cbe60c68.js";import{S as a,W as s,R as n,ai as l,E as o,aP as d}from"./p-26083a07.js";import{S as c}from"./p-a75993af.js";import{T as r}from"./p-436f9b66.js";import"./p-c7ee7cfe.js";import"./p-694b8ade.js";import"./p-1af05547.js";import"./p-e9c4f463.js";import"./p-c2915cc5.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const p="page-customer-details{}";const b=p;const h=class{constructor(t){e(this,t);this.markers=[];this.titles=[{tag:"information",text:"Information",disabled:false},{tag:"locations",text:"Locations",disabled:false},{tag:"operating-conditions",text:"Operating Conditions",disabled:false},{tag:"map",text:"Map",disabled:false}];this.itemId=undefined;this.customer=undefined;this.locationTypeSegment=0;this.slider=undefined}async componentWillLoad(){await this.loadCustomer()}async loadCustomer(){await a.presentLoading("loading");try{this.customer=await s.getCustomer(this.itemId);a.dismissLoading();this.markers=[];if(this.customer.locations.length>0){this.customer.locations.forEach((e=>{if(e.position&&e.position.geopoint){const t={latitude:e.position.geopoint.latitude,longitude:e.position.geopoint.longitude,icon:{type:"ionicon",name:"location",color:"secondary",size:"large"}};this.markers.push(t)}}));if(this.markers.length>0)this.loadMap();this.titles[1].disabled=this.customer.locations.length==0;this.titles[2].disabled=!(this.customer.conditions.EAF.length>0||this.customer.conditions.LF.length>0||this.customer.conditions.CCM.length>0);this.titles[3].disabled=this.customer.locations.length==0||this.markers.length==0}}catch(e){a.dismissLoading();n.goBack();a.presentAlertError(e)}}async componentDidLoad(){this.slider=new c(".slider-customer",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null}}});if(this.markers.length>0)this.loadMap()}async loadMap(){await customElements.whenDefined("app-map");this.mapElement=this.el.querySelector("#map");if(this.mapElement){const e=this.el.querySelector("#map-container");e.setAttribute("style","height: "+(l(this.customer)+20)+"px");setTimeout((()=>{this.mapElement.triggerMapResize();this.mapElement.fitToBounds(this.markers)}))}this.updateSlider()}async editCustomer(){const e=await s.presentCustomerUpdate(this.itemId);e.onDidDismiss().then((()=>this.loadCustomer()))}locationTypeSegmentChanged(e){this.locationTypeSegment=e.detail.value;this.updateSlider()}async openOperatingCondition(e,t){await n.openModal("modal-operating-conditions-questionnaire",{condition:e,conditionData:t,editable:false})}updateSlider(){setTimeout((()=>{this.slider?this.slider.update():undefined}),100)}render(){return[this.customer.coverURL||this.customer.photoURL?t("ion-header",null,t("app-item-cover",{item:this.customer})):undefined,t("ion-header",{key:"4b4161cbb05ad283285e7a3081a1b9fcea1c6090"},t("app-navbar",{key:"669baf1ecb4c6b8080b6775245854676761374b1",text:this.customer.fullName,color:"trasteel",backButton:this.customer&&!this.customer.coverURL&&!this.customer.photoURL,rightButtonText:r.isCustomerDBAdmin()?{icon:"create",fill:"outline",tag:"edit",text:"Edit"}:null,rightButtonFc:()=>this.editCustomer()})),t("app-header-segment-toolbar",{key:"b8b569145927b28018cff5c8bf3202a7486a4479",color:o.getAppColor(),swiper:this.slider,titles:this.titles}),t("ion-content",{key:"3714d54f1b9ad952f0ee4735b4fff6628be00255",class:"slides"},t("ion-fab",{key:"d4322260604b5e271d905fd40310b600ad2c851d",vertical:"top",horizontal:"start",slot:"fixed",style:{marginTop:d(2)}},t("ion-fab-button",{key:"67815707ff8b4920b0da99a822d57ea60ead66e5",onClick:()=>n.goBack(),class:"fab-icon"},t("ion-icon",{key:"08c173b336b9f16cc6b272d7c56fdeb7a566cf4f",name:"arrow-back-circle-outline"}))),t("swiper-container",{key:"b9db6c5c70671fdbdc73c5c6e63d7910c26b3391",class:"slider-customer swiper"},t("swiper-wrapper",{key:"55a29643ec27d26242b66c06871d57ed9677150a",class:"swiper-wrapper"},t("swiper-slide",{key:"045df17e91618c58c8b0bf67c2f2477d43d4395c",class:"swiper-slide"},t("ion-list",{key:"8c2f6c9c22b19348933b7987d1bd46de85004c97",class:"ion-no-padding"},t("app-item-detail",{key:"b3f57b955044c8e0168f51a73f1ab63529cb6d3d",lines:"none",labelTag:"plant_type",labelText:"Plant Type",detailText:s.getCustomerTypes(this.customer.typeId)[0].typeName}),t("app-item-detail",{key:"c930f82178d4a2a9e1db6143f8bff5124c026d6d",lines:"none",labelTag:"name",labelText:"Name",detailText:this.customer.fullName}),t("app-item-detail",{key:"953bac47b09ea7c2ab5a66dec44dc34b8dc7c315",lines:"none",labelTag:"local_name",labelText:"Local Name",detailText:this.customer.fullNameOther}),t("app-item-detail",{key:"6781702ca1727da1542395653d1605fa1ad5a305",lines:"none",labelTag:"other_name",labelText:"Other Name",detailText:this.customer.otherPlantName}),t("app-item-detail",{key:"d8759c432d727f8d2eadcf86042968286d0c24a9",lines:"none",labelTag:"other_name",labelText:"Other Local Name",detailText:this.customer.otherPlantNameOther}),t("app-item-detail",{key:"6ae134333358d68ec8b903ed0abb8eec44eb6ff9",lines:"none",labelTag:"short_name",labelText:"Short Name",detailText:this.customer.shortName}),this.customer.group.map(((e,i)=>t("app-item-detail",{lines:"none",labelTag:i==0?"group":null,labelText:i==0?"Group":null,detailText:e.groupName+" ["+e.groupOwnershipPerc+"%]"}))),t("app-item-detail",{key:"85921164667e739ad0e4fbb33b935310c464e2f0",lines:"none",labelTag:"owner",labelText:"Owner",detailText:this.customer.owner.groupName}),t("app-customer-plant-production",{key:"ba0b49609128eeddc9723e79a941e0cf4c0c4912",customer:this.customer}))),t("swiper-slide",{key:"218417a3f334fdcaa409d9344e537280cca02079",class:"swiper-slide"},t("div",{key:"54ad7f886856db7098cbcd98551b3cd525c0b729"},this.customer.locations.length>0?[t("ion-toolbar",null,t("ion-segment",{mode:"ios",scrollable:true,onIonChange:e=>this.locationTypeSegmentChanged(e),value:this.locationTypeSegment},this.customer.locations.map(((e,i)=>t("ion-segment-button",{value:i,layout:"icon-start"},t("ion-label",null,s.getLocationsTypes(e.type)[0].locationName)))))),this.customer.locations.map(((e,i)=>t("div",null,this.locationTypeSegment==i?t("div",null,t("app-location",{locations:s.getLocationsTypes(),location:e,slider:this.slider,editable:false})):undefined)))]:undefined)),t("swiper-slide",{key:"37457fdce56725dc5d24c9d1ece91f8d3e4c4182",class:"swiper-slide"},t("ion-list",{key:"21883b3ec829ae0be867fde6d432fa88db8dad56"},t("ion-item-divider",{key:"43b0d17826e09eca08a43bef1a9072f8be748def"},"EAF"),this.customer.conditions.EAF.map((e=>t("ion-item",{button:true,detail:true,onClick:()=>this.openOperatingCondition("EAF",e)},t("ion-label",null,new Date(e.date).toLocaleDateString())))),t("ion-item-divider",{key:"adf173f719bb0736d08c62c113742d90da3d318a"},"LF"),this.customer.conditions.LF.map((e=>t("ion-item",{button:true,detail:true,onClick:()=>this.openOperatingCondition("EAF",e)},t("ion-label",null,new Date(e.date).toLocaleDateString())))),t("ion-item-divider",{key:"02f1c4614c0721e49e97c65fa6ef8b8cd48f50d4"},"CCM"),this.customer.conditions.CCM.map((e=>t("ion-item",null,t("ion-label",null,new Date(e.date).toLocaleDateString())))))),t("swiper-slide",{key:"b4684fc6361de4a75c220cba8fa126fc344f0c69",class:"swiper-slide"},this.customer.locations.length>0&&this.markers.length>0?t("div",{id:"map-container"},t("app-map",{id:"map",pageId:"customer-details",center:this.customer.locations[0],markers:this.markers})):t("div",null,t("ion-item",null,"NO MAP AVAILABLE"))))))]}get el(){return i(this)}};h.style=b;export{h as page_customer_details};