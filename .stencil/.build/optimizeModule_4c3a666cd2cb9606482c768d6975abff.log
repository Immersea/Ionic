import{r as e,h as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{m as s}from"./p-c2915cc5.js";import{x as t,E as o,T as d}from"./p-6934ed3c.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1af05547.js";import"./p-e9c4f463.js";const c="";const a=c;const l=class{constructor(i){e(this,i);this.inProgress={};this.urls={};this.files=undefined;this.collectionId=undefined;this.itemId=undefined;this.updateView=false}uploadProgressHandler(e){const i=e.detail;if(i.state==="completed"){this.urls[this.uploadingId]=i.url;let e=true;Object.keys(this.inProgress).forEach((i=>{e=e&&this.inProgress[i].uploadProgress===100}));this.updateView=!this.updateView;if(e){s.dismiss(this.urls)}else{this.uploadMedia()}}else if(i.state==="error"){s.dismiss(false)}else{this.inProgress[this.uploadingId].uploadProgress=i.progress;this.updateView=!this.updateView}}componentDidLoad(){this.inProgress={};Object.keys(this.files).forEach((e=>{this.inProgress[e]={size:this.files[e].file.size,uploadProgress:0}}));this.uploadMedia()}async cancel(){s.dismiss(false)}uploadMedia(){let e=null;Object.keys(this.inProgress).forEach((i=>{if(this.inProgress[i].uploadProgress==0){e=i;return}}));this.uploadingId=e;const i=this.files[e].file;const s=this.files[e].media;t.uploadFile(this.collectionId,this.itemId,s,i)}render(){return[i("ion-header",{key:"b467fa46cc85c27bef94270d4230d49d0c1db288"},i("ion-toolbar",{key:"0b6edc1de146aebefc195b3f08fab77703e14848",color:o.getAppColor()},i("ion-title",{key:"4c67d24bf5d6f49c0f2a0e80274d51b8e36d30b6"},d.getTransl("media-uploader","Media Uploader")))),i("ion-content",{key:"096720a80d9542f797704179df094d82235643bf"},i("ion-list",{key:"fb23af895c1c22f6463fa99626c172b77a894988"},Object.keys(this.files).map((e=>[i("ion-item",null,i("ion-label",null,i("h4",null,this.files[e].media.title),this.inProgress&&this.inProgress[e]?[i("h5",null,d.getTransl("file-size","File Size"),": ",this.inProgress[e].size),i("p",null,d.getTransl("uploaded","Uploaded"),":"," ",this.inProgress[e].uploadProgress,"%")]:undefined)),this.inProgress&&this.inProgress[e]?i("ion-progress-bar",{value:this.inProgress[e].uploadProgress}):undefined]))),i("ion-button",{key:"b36df3d0aec774b34fbd7e20f83301235d255dd2",expand:"block",fill:"outline",onClick:()=>this.cancel()},i("ion-label",{key:"05f7a5404433c3ac3fd96b7450ab859524192988"},d.getTransl("cancel","Cancel"))))]}};l.style=a;export{l as popover_media_uploader};