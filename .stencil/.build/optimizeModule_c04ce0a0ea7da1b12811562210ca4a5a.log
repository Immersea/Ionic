import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import{l as s}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as o,n as c}from"./p-5d4a8e1f.js";import{T as n,U as d,R as l,aE as f}from"./p-341ae8a8.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1819cfda.js";import"./p-46038295.js";import"./p-7ee16e8d.js";const b="popover-new-class-activity .validation-error{text-align:center;font-size:0.7rem;color:red}";const r=b;const p=class{constructor(t){e(this,t);this.typeSelectOptions=[];this.stdConfigurations=[];this.activity=undefined;this.showDiveLocation=true;this.updateView=false;this.validActivity=false}componentWillLoad(){this.typeSelectOptions=[{tag:"theory",text:n.getTransl("theory","Theory")},{tag:"dry",text:n.getTransl("dry","Dry")},{tag:"in-water",text:n.getTransl("in-water","In Water")},{tag:"dive",text:n.getTransl("dive","Dive")}];this.stdConfigurations=s.exports.cloneDeep(d.userSettings.userConfigurations);this.validateActivity()}validateActivity(){this.validActivity=s.exports.isNumber(this.activity.day)&&s.exports.isString(this.activity.type)&&s.exports.isString(this.activity.title.tag)&&s.exports.isString(this.activity.title.text);if(this.activity.type=="dive"){this.validActivity=this.validActivity&&this.activity.divePlan!==null}this.updateView=!this.updateView}updateDay(e){this.activity.day=e;this.validateActivity()}updateType(e){if(e!="dive"&&this.activity.type=="dive"){this.activity.divePlan=null}this.activity.type=e;this.validateActivity()}updateTitle(e){let t=e.detail.value;if(e.detail.name=="tag"){t=t.toLowerCase().replace(" ","-").trim()}this.activity.title[e.detail.name]=t;this.validateActivity()}async addDivePlan(){let e=[];s.exports.forEach(this.stdConfigurations,((t,a)=>{e.push({type:"radio",label:t.stdName,value:a,checked:a==0?true:false})}));const t=await o.create({header:n.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:n.getTransl("ok","OK"),handler:async e=>{const t=await l.openModal("modal-dive-template",{selectedConfiguration:this.stdConfigurations[e],stdConfigurations:this.stdConfigurations,dive:0,user:d.userProfile});t.onDidDismiss().then((e=>{const t=e.data;if(t){this.activity.divePlan=t;this.validateActivity();this.updateView=!this.updateView}}))}},{text:n.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});t.present()}async editDivePlan(){const e=await f.presentDiveTemplateUpdate(this.activity.divePlan,0,this.showDiveLocation);if(e){this.activity.divePlan=e;this.updateView=!this.updateView}}async save(){c.dismiss(this.activity)}cancel(){c.dismiss()}render(){return t(a,{key:"d4d0e9be6f45e56fe4e03ad78a47978cbab43dde"},t("ion-toolbar",{key:"65d9a5e58ef3b21f10d42bfe1686e4845f6ea171"},t("ion-title",{key:"e5995dfb099bbe6c679804afea749649367ddbf8"},t("my-transl",{key:"68826d8c37eb7c06acc9bcd1a7895042bf83566c",tag:"class-activity",text:"Class Activity"}))),t("ion-item",{key:"095b55f83dfaa19dde26e245972bb8fcc4532740"},t("ion-label",{key:"322cc0a7a0704206b77403c444471b8acf3e4d0d"},t("my-transl",{key:"40b2cb0891b7a8f2a7ffb933d9f1503a029691de",tag:"class-day",text:"Class Day"})),t("ion-select",{key:"24e0225a18e51339824c67cfa3231522ce3c820a",value:this.activity.day,onIonChange:e=>this.updateDay(e.detail.value),interface:"popover"},t("ion-select-option",{key:"e195e28bc66e54edc22d4ce7f0a1a04f2d8d1db0",value:1},"1"),t("ion-select-option",{key:"9a73d626293ee0d17aea184a17846d9099b7a15a",value:2},"2"),t("ion-select-option",{key:"cd43af2f3c5d3a2e25b5693fad8c12f167ecf9e5",value:3},"3"),t("ion-select-option",{key:"bb1686c796a766e21f6642655b271af6761d2094",value:4},"4"),t("ion-select-option",{key:"cfd541b8a6040e073b273c6552f1e4b20533f244",value:5},"5"),t("ion-select-option",{key:"34581e0e2382104fad59fbf0266debbe03ddeba8",value:6},"6"),t("ion-select-option",{key:"c7c0f1089e2b632bccebf5491bfcc2fa87c974d9",value:7},"7"),t("ion-select-option",{key:"d4f7aa700b5bfc1b897103337912257eb3a4da28",value:8},"8"),t("ion-select-option",{key:"3e49eff67d9a449b497b9bc8b81a0c8ba2b37095",value:9},"9"),t("ion-select-option",{key:"9ee875abaf290d2e2456828a835dddda8a5fe3ed",value:10},"10"))),t("ion-item",{key:"850f42509dc0b53eb0f8957031e9534213be36b7"},t("ion-label",{key:"ae8bb45862a0cd03d55edd10c3c825f3a05c5b96"},t("my-transl",{key:"5b672aebcc9d228ae67ffe6a1b1b06e503c289fa",tag:"type",text:"Type"})),t("ion-select",{key:"392be81fcd84d087b1f8001755bc0fe9829f4a5c",value:this.activity.type,onIonChange:e=>this.updateType(e.detail.value),interface:"popover"},this.typeSelectOptions.map((e=>t("ion-select-option",{value:e.tag},e.text))))),t("app-form-item",{key:"7e93f0bb9d64c23b4c6be34ee2002061f54178d9","label-tag":"unique-id","label-text":"Unique ID",value:this.activity.title.tag,name:"tag","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"fa72667c4ceea9f972ca8fbe8f2fdb0b9f36eb68","label-tag":"title","label-text":"Title",value:this.activity.title.text,name:"text","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required"]}),this.activity.type=="dive"?this.activity.divePlan?t("ion-item",null,t("ion-label",null,this.activity.divePlan.dives[0].getDiveDetails().map((e=>t("p",null,e)))),t("ion-button",{"icon-only":true,fill:"clear",onClick:()=>this.editDivePlan()},t("ion-icon",{name:"create-outline"}))):t("ion-button",{expand:"full",onClick:()=>this.addDivePlan()},"Add Dive Plan"):undefined,t("app-modal-footer",{key:"f6820c730f32ab46e73ebf47a3894d83ece17d0e",disableSave:!this.validActivity,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};p.style=r;export{p as popover_new_class_activity};