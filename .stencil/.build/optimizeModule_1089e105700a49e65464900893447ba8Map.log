{"version":3,"names":["modalDatasheetPropertytypeCss","ModalDatasheetPropertytypeStyle0","ModalDatasheetPropertyType","componentWillLoad","this","loadDatasheetPropertyTypes","DatasheetsService","downloadDatasheetSettings","datasheetPropertyTypes","cloneDeep","getDatasheetPropertyTypes","length","datasheetPropertyType","addDatasheetPropertyType","validateDatasheet","selectType","ev","find","x","typeId","detail","value","handleChange","n","name","v","replace","trim","toLowerCase","validDatasheetPropertyType","isString","typeName","updateView","DatasheetPropertyType","push","index","duplicateDatasheetPropertyType","deleteDatasheetPropertyType","splice","error","SystemService","presentAlertError","save","dismiss","uploadDatasheetSettings","modalController","cancel","render","h","Host","key","color","label","tag","text","lines","selectFn","selectOptions","selectValueId","selectValueText","disabled","size","class","fill","onClick","slot","onFormItemChanged","labelPosition","validator","options","type","list","typeLeft","multiLanguage","typeRight","typeLimit","Environment","getAppColor","disableSave","onCancelEmit","onSaveEmit"],"sources":["src/components/trasteel/modals/modal-datasheet-propertytype/modal-datasheet-propertytype.scss?tag=modal-datasheet-propertytype","src/components/trasteel/modals/modal-datasheet-propertytype/modal-datasheet-propertytype.tsx"],"sourcesContent":["modal-datasheet-propertytype {\n  ion-list {\n    width: 100%;\n  }\n}\n","import {Component, h, Host, State, Element} from \"@stencil/core\";\nimport {modalController} from \"@ionic/core\";\nimport {cloneDeep, isString} from \"lodash\";\nimport {Environment} from \"../../../../global/env\";\nimport {SystemService} from \"../../../../services/common/system\";\nimport {DatasheetPropertyType} from \"../../../../interfaces/trasteel/refractories/datasheets\";\nimport {DatasheetsService} from \"../../../../services/trasteel/refractories/datasheets\";\n\n@Component({\n  tag: \"modal-datasheet-propertytype\",\n  styleUrl: \"modal-datasheet-propertytype.scss\",\n})\nexport class ModalDatasheetPropertyType {\n  @Element() el: HTMLElement;\n  @State() index: number = 0;\n  @State() datasheetPropertyTypes: DatasheetPropertyType[];\n  @State() datasheetPropertyType: DatasheetPropertyType;\n  @State() updateView = true;\n  @State() validDatasheetPropertyType = false;\n\n  async componentWillLoad() {\n    await this.loadDatasheetPropertyTypes();\n  }\n\n  async loadDatasheetPropertyTypes() {\n    await DatasheetsService.downloadDatasheetSettings();\n    this.datasheetPropertyTypes = cloneDeep(\n      DatasheetsService.getDatasheetPropertyTypes()\n    );\n    if (this.datasheetPropertyTypes && this.datasheetPropertyTypes.length > 0) {\n      this.datasheetPropertyType = this.datasheetPropertyTypes[0];\n    } else {\n      //create new and add to list\n      this.addDatasheetPropertyType();\n    }\n    this.validateDatasheet();\n  }\n\n  selectType(ev) {\n    this.datasheetPropertyType = this.datasheetPropertyTypes.find(\n      (x) => x.typeId == ev.detail.value\n    );\n    this.validateDatasheet();\n  }\n\n  handleChange(ev) {\n    const n = ev.detail.name;\n    let v = ev.detail.value;\n    if (n == \"typeId\") {\n      //remove spaces and lowercase\n      v = v.replace(/\\s+/g, \"-\").trim().toLowerCase();\n    }\n    this.datasheetPropertyType[n] = v;\n    this.validateDatasheet();\n  }\n\n  validateDatasheet() {\n    this.validDatasheetPropertyType =\n      isString(this.datasheetPropertyType.typeId) &&\n      isString(this.datasheetPropertyType.typeName);\n    this.updateView = !this.updateView;\n  }\n\n  addDatasheetPropertyType() {\n    this.datasheetPropertyType = new DatasheetPropertyType();\n    this.datasheetPropertyTypes.push(this.datasheetPropertyType);\n    this.index = this.datasheetPropertyTypes.length - 1;\n  }\n\n  duplicateDatasheetPropertyType() {\n    this.datasheetPropertyType = cloneDeep(this.datasheetPropertyType);\n    this.datasheetPropertyType.typeId =\n      this.datasheetPropertyType.typeId + \"_rev.\";\n    this.datasheetPropertyTypes.push(this.datasheetPropertyType);\n    this.index = this.datasheetPropertyTypes.length - 1;\n  }\n\n  async deleteDatasheetPropertyType() {\n    try {\n      this.datasheetPropertyTypes.splice(this.index, 1);\n      this.index = 0;\n      this.datasheetPropertyType = this.datasheetPropertyTypes[0];\n      this.validateDatasheet();\n    } catch (error) {\n      if (error) SystemService.presentAlertError(error);\n    }\n  }\n\n  async save(dismiss = true) {\n    await DatasheetsService.uploadDatasheetSettings(\n      \"propertyType\",\n      this.datasheetPropertyTypes\n    );\n    return dismiss ? modalController.dismiss() : true;\n  }\n\n  async cancel() {\n    return modalController.dismiss();\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-content>\n          <ion-grid>\n            <ion-row>\n              <ion-col>\n                <app-select-search\n                  color=\"trasteel\"\n                  label={{\n                    tag: \"datasheet_major_family\",\n                    text: \"Datasheet Major Family\",\n                  }}\n                  value={\n                    this.index\n                      ? this.datasheetPropertyTypes[this.index].typeId\n                      : this.datasheetPropertyTypes[0].typeId\n                  }\n                  lines=\"none\"\n                  label-placement=\"floating\"\n                  selectFn={(ev) => this.selectType(ev)}\n                  selectOptions={this.datasheetPropertyTypes}\n                  selectValueId=\"typeId\"\n                  selectValueText={[\"typeName\"]}\n                  disabled={!this.validDatasheetPropertyType}\n                ></app-select-search>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  disabled={!this.validDatasheetPropertyType}\n                  onClick={() => this.addDatasheetPropertyType()}\n                >\n                  <ion-icon name=\"add\" slot=\"start\" />\n                </ion-button>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  disabled={!this.validDatasheetPropertyType}\n                  onClick={() => this.duplicateDatasheetPropertyType()}\n                >\n                  <ion-icon slot=\"start\" name=\"duplicate\"></ion-icon>\n                </ion-button>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  color=\"danger\"\n                  disabled={this.datasheetPropertyTypes.length == 0}\n                  onClick={() => this.deleteDatasheetPropertyType()}\n                >\n                  <ion-icon slot=\"start\" name=\"trash\"></ion-icon>\n                </ion-button>\n              </ion-col>\n            </ion-row>\n          </ion-grid>\n          <app-form-item\n            label-text=\"ID\"\n            value={this.datasheetPropertyType.typeId}\n            name=\"typeId\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n            labelPosition=\"fixed\"\n            validator={[\n              \"required\",\n              {\n                name: \"uniqueid\",\n                options: {\n                  type: \"list\",\n                  index: \"propertyTypeId\",\n                  list: DatasheetsService.getDatasheetPropertyTypes(),\n                },\n              },\n            ]}\n          ></app-form-item>\n          <app-form-item\n            label-text=\"Name\"\n            value={this.datasheetPropertyType.typeName}\n            name=\"typeName\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n            labelPosition=\"fixed\"\n            validator={[\"required\"]}\n          ></app-form-item>\n          <app-form-item\n            label-text=\"Value Left Description\"\n            value={this.datasheetPropertyType.typeLeft}\n            name=\"typeLeft\"\n            input-type=\"text\"\n            multiLanguage={true}\n            text-rows=\"1\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n          ></app-form-item>\n          <app-form-item\n            label-text=\"Value Right Description\"\n            value={this.datasheetPropertyType.typeRight}\n            name=\"typeRight\"\n            input-type=\"text\"\n            multiLanguage={true}\n            text-rows=\"1\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n          ></app-form-item>\n          <app-form-item\n            label-text=\"Value Limit Description\"\n            value={this.datasheetPropertyType.typeLimit}\n            name=\"typeLimit\"\n            input-type=\"text\"\n            multiLanguage={true}\n            text-rows=\"1\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n          ></app-form-item>\n        </ion-content>\n        <app-modal-footer\n          color={Environment.getAppColor()}\n          disableSave={!this.validDatasheetPropertyType}\n          onCancelEmit={() => this.cancel()}\n          onSaveEmit={() => this.save()}\n        />\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}