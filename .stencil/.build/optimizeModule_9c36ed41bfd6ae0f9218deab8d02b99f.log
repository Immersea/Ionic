import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import{l as s}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as c,n as o}from"./p-5d4a8e1f.js";import{T as n,U as d,R as l,aE as f}from"./p-30358c9d.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-2578d979.js";import"./p-a9f4af61.js";import"./p-7ee16e8d.js";const r="popover-new-class-activity .validation-error{text-align:center;font-size:0.7rem;color:red}";const p=r;const h=class{constructor(t){e(this,t);this.typeSelectOptions=[];this.stdConfigurations=[];this.activity=undefined;this.showDiveLocation=true;this.updateView=false;this.validActivity=false}componentWillLoad(){this.typeSelectOptions=[{tag:"theory",text:n.getTransl("theory","Theory")},{tag:"dry",text:n.getTransl("dry","Dry")},{tag:"in-water",text:n.getTransl("in-water","In Water")},{tag:"dive",text:n.getTransl("dive","Dive")}];this.stdConfigurations=s.exports.cloneDeep(d.userSettings.userConfigurations);this.validateActivity()}validateActivity(){this.validActivity=s.exports.isNumber(this.activity.day)&&s.exports.isString(this.activity.type)&&s.exports.isString(this.activity.title.tag)&&s.exports.isString(this.activity.title.text);if(this.activity.type=="dive"){this.validActivity=this.validActivity&&this.activity.divePlan!==null}this.updateView=!this.updateView}updateDay(e){this.activity.day=e;this.validateActivity()}updateType(e){if(e!="dive"&&this.activity.type=="dive"){this.activity.divePlan=null}this.activity.type=e;this.validateActivity()}updateTitle(e){let t=e.detail.value;if(e.detail.name=="tag"){t=t.toLowerCase().replace(" ","-").trim()}this.activity.title[e.detail.name]=t;this.validateActivity()}async addDivePlan(){let e=[];s.exports.forEach(this.stdConfigurations,((t,a)=>{e.push({type:"radio",label:t.stdName,value:a,checked:a==0?true:false})}));const t=await c.create({header:n.getTransl("select-standard-configuration","Select standard configuration"),buttons:[{text:n.getTransl("ok","OK"),handler:async e=>{const t=await l.openModal("modal-dive-template",{selectedConfiguration:this.stdConfigurations[e],stdConfigurations:this.stdConfigurations,dive:0,user:d.userProfile});t.onDidDismiss().then((e=>{const t=e.data;if(t){this.activity.divePlan=t;this.validateActivity();this.updateView=!this.updateView}}))}},{text:n.getTransl("cancel","Cancel"),role:"cancel",cssClass:"secondary"}],inputs:e});t.present()}async editDivePlan(){const e=await f.presentDiveTemplateUpdate(this.activity.divePlan,0,this.showDiveLocation);if(e){this.activity.divePlan=e;this.updateView=!this.updateView}}async save(){o.dismiss(this.activity)}cancel(){o.dismiss()}render(){return t(a,{key:"673254271905b80acca8ee108ab24dd3de3b56e2"},t("ion-toolbar",{key:"fec6e6c87f6b2f6c6b07c3cefdb20eca70a854a8"},t("ion-title",{key:"65e1ea702636519158a9754099ba15300fab31d6"},t("my-transl",{key:"a236a72baff8cf9f1887c1979dab77968d8cbe13",tag:"class-activity",text:"Class Activity"}))),t("ion-item",{key:"e33e34e736ffe994d1c3879cbc5674383ad107d6"},t("ion-label",{key:"47ad9eb1491a80c7a6a7caf9a3534d98ced87142"},t("my-transl",{key:"64d8a49981ce51584b3951671be37dfe9a286152",tag:"class-day",text:"Class Day"})),t("ion-select",{key:"4cd8d7e8fe2d5cebdf7cb7b76182735846587c6d",value:this.activity.day,onIonChange:e=>this.updateDay(e.detail.value),interface:"popover"},t("ion-select-option",{key:"c4ad1aadf2926f014c2efe2969b2194f143e97fc",value:1},"1"),t("ion-select-option",{key:"8a86c32a600067e9c5467e2ea916f876b2c78ef6",value:2},"2"),t("ion-select-option",{key:"5cbf0c7d2a0a74ed037bdb70efd3d36041d1130a",value:3},"3"),t("ion-select-option",{key:"d7bec71454b5f009ec536d3485e8fc93a37f7b82",value:4},"4"),t("ion-select-option",{key:"3397519c431ecd9e6dc17caa60e7da35677d56f7",value:5},"5"),t("ion-select-option",{key:"b2a32777421af88fdd4a730a431a023fc1d71b8f",value:6},"6"),t("ion-select-option",{key:"ceb172e2714dacea550f339eb3825d75823b86f5",value:7},"7"),t("ion-select-option",{key:"ad24a2a84e98191f13b6d639a78cdade914774e5",value:8},"8"),t("ion-select-option",{key:"530710cb9dc6538a2d57573a607254b86a64cace",value:9},"9"),t("ion-select-option",{key:"4e6b59f7016a2b71af2e7b0ed22b840f91a664c3",value:10},"10"))),t("ion-item",{key:"e0cc743e9d7cd24b3a19d24f18d3c16bcf4cc8e1"},t("ion-label",{key:"81913eeb6a0e3a963208328a5b211893e29e7775"},t("my-transl",{key:"3ce657b1343c1f91d25a44c5da8de88f24731afb",tag:"type",text:"Type"})),t("ion-select",{key:"bceadd1d2d3a61bf7aaffa6992b4f71874ff35bf",value:this.activity.type,onIonChange:e=>this.updateType(e.detail.value),interface:"popover"},this.typeSelectOptions.map((e=>t("ion-select-option",{value:e.tag},e.text))))),t("app-form-item",{key:"3eefc3a7ae44d22a58c62f62f33736c9686401a9","label-tag":"unique-id","label-text":"Unique ID",value:this.activity.title.tag,name:"tag","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required",{name:"uniqueid",options:{type:null}}]}),t("app-form-item",{key:"e71ec31e36d63bf3e79635def8de221f4a69c258","label-tag":"title","label-text":"Title",value:this.activity.title.text,name:"text","input-type":"text",onFormItemChanged:e=>this.updateTitle(e),validator:["required"]}),this.activity.type=="dive"?this.activity.divePlan?t("ion-item",null,t("ion-label",null,this.activity.divePlan.dives[0].getDiveDetails().map((e=>t("p",null,e)))),t("ion-button",{"icon-only":true,fill:"clear",onClick:()=>this.editDivePlan()},t("ion-icon",{name:"create-outline"}))):t("ion-button",{expand:"full",onClick:()=>this.addDivePlan()},"Add Dive Plan"):undefined,t("app-modal-footer",{key:"cafb927c4a902cb130992248a09639ce3229dce4",disableSave:!this.validActivity,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};h.style=p;export{h as popover_new_class_activity};