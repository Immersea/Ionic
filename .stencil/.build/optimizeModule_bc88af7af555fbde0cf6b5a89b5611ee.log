import{r as e,h as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s}from"./p-5d4a8e1f.js";import{E as t}from"./p-46038295.js";import{v as o,T as d}from"./p-736235c6.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1819cfda.js";import"./p-1af05547.js";import"./p-e9c4f463.js";import"./p-7ee16e8d.js";const a="";const l=a;const n=class{constructor(i){e(this,i);this.inProgress={};this.urls={};this.files=undefined;this.collectionId=undefined;this.itemId=undefined;this.updateView=false}uploadProgressHandler(e){const i=e.detail;if(i.state==="completed"){this.urls[this.uploadingId]=i.url;let e=true;Object.keys(this.inProgress).forEach((i=>{e=e&&this.inProgress[i].uploadProgress===100}));this.updateView=!this.updateView;if(e){s.dismiss(this.urls)}else{this.uploadMedia()}}else if(i.state==="error"){s.dismiss(false)}else{this.inProgress[this.uploadingId].uploadProgress=i.progress;this.updateView=!this.updateView}}componentDidLoad(){this.inProgress={};Object.keys(this.files).forEach((e=>{this.inProgress[e]={size:this.files[e].file.size,uploadProgress:0}}));this.uploadMedia()}async cancel(){s.dismiss(false)}uploadMedia(){let e=null;Object.keys(this.inProgress).forEach((i=>{if(this.inProgress[i].uploadProgress==0){e=i;return}}));this.uploadingId=e;const i=this.files[e].file;const s=this.files[e].media;o.uploadFile(this.collectionId,this.itemId,s,i)}render(){return[i("ion-header",{key:"988330e1d0aefa084ee2558b176dedab81d48ee7"},i("ion-toolbar",{key:"1ba0cb58a9add9fa10d7ad7a81788e3f89dfe417",color:t.getAppColor()},i("ion-title",{key:"77c29f206ec6effe0a046f976c429598f6bba49d"},d.getTransl("media-uploader","Media Uploader")))),i("ion-content",{key:"9616cd7a54dfbf43941bb9e617f3dec4a7739926"},i("ion-list",{key:"563cf089957b3a14200869d73b91b3494244160b"},Object.keys(this.files).map((e=>[i("ion-item",null,i("ion-label",null,i("h4",null,this.files[e].media.title),this.inProgress&&this.inProgress[e]?[i("h5",null,d.getTransl("file-size","File Size"),": ",this.inProgress[e].size),i("p",null,d.getTransl("uploaded","Uploaded"),":"," ",this.inProgress[e].uploadProgress,"%")]:undefined)),this.inProgress&&this.inProgress[e]?i("ion-progress-bar",{value:this.inProgress[e].uploadProgress}):undefined]))),i("ion-button",{key:"5c1dedf772ed54260214e15da187c0447bccc815",expand:"block",fill:"outline",onClick:()=>this.cancel()},i("ion-label",{key:"3e217072f97e68e9311c4804d8bd616593d072c2"},d.getTransl("cancel","Cancel"))))]}};n.style=l;export{n as popover_media_uploader};