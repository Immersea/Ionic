import{r as e,h as i,H as t,f as s}from"./p-cbe60c68.js";import{T as a,aq as d,ar as c,U as o}from"./p-773bd3de.js";import"./p-c7ee7cfe.js";import{n as r}from"./p-c2915cc5.js";import{l as n}from"./p-1af05547.js";import{S as p}from"./p-a75993af.js";import"./p-694b8ade.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const f="modal-dive-trip-update ion-list{width:100%}modal-dive-trip-update ion-segment-button{--color-checked:var(--ion-color-divetrip-contrast)}";const h=f;const l=class{constructor(i){e(this,i);this.diveTripId=undefined;this.collectionId=undefined;this.organiserId=undefined;this.diveTrip=undefined;this.updateView=true;this.validTrip=false;this.titles=[{tag:"dives"},{tag:"team"},{tag:"bookings"}];this.slider=undefined}async componentWillLoad(){await this.loadDiveTrip();this.placeholder=a.getTransl("insert-title","Insert title")}async loadDiveTrip(){if(this.diveTripId){this.diveTrip=await d.getDiveTrip(this.diveTripId)}else{this.diveTrip=new c;this.diveTrip.organiser={collectionId:this.collectionId,id:this.organiserId};this.diveTrip.users={[o.userRoles.uid]:["owner"]}}}async componentDidLoad(){this.slider=new p(".slider-dive-trip",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null}}});this.validateTrip()}async addDiveTrip(e,i){this.diveTrip=await d.addDiveTrip(this.diveTrip,e,i);this.validateTrip()}removeDiveTrip(e){this.diveTrip=d.removeDiveTrip(this.diveTrip,e);this.validateTrip()}removeTripDive(e,i){this.diveTrip=d.removeTripDive(this.diveTrip,e,i);this.updateView=!this.updateView}setTitle(e){this.diveTrip.displayName=e.target.value;this.validateTrip()}validateTrip(){this.diveTrip.tripDives=n.exports.orderBy(this.diveTrip.tripDives,"divePlan.dives[0].date");this.validTrip=n.exports.isString(this.diveTrip.displayName)&&this.diveTrip.displayName.length>3&&this.diveTrip.tripDives.length>0;this.updateView=!this.updateView}async save(){await d.updateDiveTrip(this.diveTripId,this.diveTrip);return r.dismiss(false)}async cancel(){return r.dismiss(true)}render(){return i(t,{key:"ffd407d559fc0d4d3eb0c7fee93c1e3ac4a29577"},i("ion-header",{key:"ac4222a6dedf067c05e43ea643828ef1fefe712c"},i("ion-toolbar",{key:"a41bbf27e212a8950fae737fa60ad141e137f3a8",color:"divetrip"},i("ion-title",{key:"3a227de29a1dca18d1c1a9df7a8a9a0ec691a9dd"},i("ion-input",{key:"f1d363ca74d688229ef46caf8863b1d0a1f6c4d9",placeholder:this.placeholder+"...",inputmode:"text",onIonInput:e=>this.setTitle(e),value:this.diveTrip.displayName})))),i("app-header-segment-toolbar",{key:"fe4daf7cfc6273de932661b1e0031f645ca37ff7",color:"divetrip",swiper:this.slider,titles:this.titles}),i("ion-content",{key:"dce44785d42d30642ac732ffc4bbd55c3863ea0c",class:"slides"},i("swiper-container",{key:"f2cd95d994aebcf162f22110d11f3c266b1a34f0",class:"slider-dive-trip swiper"},i("swiper-wrapper",{key:"efb37dfb7279a0a83eb1e5418c6915ad7a7e9db0",class:"swiper-wrapper"},i("swiper-slide",{key:"7c4016a1222b3505632ccaf76f67cc9580889fc6",class:"swiper-slide"},i("ion-grid",{key:"d77028843a5e1c757915a560bb4fe4334b26fc77"},i("ion-row",{key:"90801336cf5ffb5aae48bb5dec351bc4dcc95e99",class:"ion-text-start"},this.diveTrip.tripDives.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4"},i("app-dive-trip-card",{tripDive:e,editable:true,updateView:this.updateView,onAddDiveEmit:()=>this.addDiveTrip(t),onRemoveDiveTripEmit:()=>this.removeDiveTrip(t),onRemoveTripDiveEmit:e=>this.removeTripDive(t,n.exports.toNumber(e.detail)),onUpdateDiveEmit:e=>this.addDiveTrip(t,n.exports.toNumber(e.detail))})))),i("ion-col",{key:"cedd72c5b2dad93e0a85799683d72cb30464bd1b","size-sm":"12","size-md":"6","size-lg":"4"},i("ion-card",{key:"ca868ce61c6aa25ca6373cb926d7880f10b7c084",onClick:()=>this.addDiveTrip()},i("ion-card-content",{key:"8afe7c0d8c66340fe84e0f5270214afadf4266a3",class:"ion-text-center"},i("ion-icon",{key:"e5b87dde0ce95833009adc6ac554436108b8110e",name:"add-circle-outline",style:{fontSize:"130px"}}))))))),i("swiper-slide",{key:"0cf033936029e96ad81737c70e9ce81841e5a177",class:"swiper-slide"},i("app-users-list",{key:"df9d86bc0ce6858c5600d8117aba1a0835de8521",item:this.diveTrip,editable:true,show:["owner","divemaster","instructor"]})),i("swiper-slide",{key:"2d7e477c55060a440e0d60b659d29b7d92dbfc77",class:"swiper-slide"},i("ion-grid",{key:"a1c62dcbd9268e1ff83a2ceb91a011ba854f6d7f"},i("ion-row",{key:"2069d0c93f9abe31fc59f1c870bc9cdab6852e39"},Object.keys(this.diveTrip.tripDives).map((e=>i("ion-col",{"size-sm":"12","size-md":"12","size-lg":"12"},i("app-dive-trip-bookings",{diveTrip:this.diveTrip,diveTripId:this.diveTripId,tripDiveIndex:n.exports.toNumber(e),editable:true})))))))))),i("app-modal-footer",{key:"c7872ab724906e7d64099753f97f573d90e948da",disableSave:!this.validTrip,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return s(this)}};l.style=h;export{l as modal_dive_trip_update};