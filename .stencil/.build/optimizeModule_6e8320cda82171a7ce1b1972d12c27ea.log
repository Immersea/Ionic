import{r as e,h as t,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s,a as o}from"./p-5d4a8e1f.js";import{m as n,ag as l,p as d}from"./p-30358c9d.js";import{E as c}from"./p-a9f4af61.js";import{T as r}from"./p-87afedc7.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-2578d979.js";import"./p-1af05547.js";import"./p-e9c4f463.js";import"./p-7ee16e8d.js";class f{getUserRoles(){return["registered","translator","superAdmin"]}}const m=new f;const h="modal-edit-user-roles ion-list{width:100%}";const p=h;const b=class{constructor(t){e(this,t);this.uid=undefined;this.userRoles=undefined;this.updateView=false}async componentWillLoad(){const e=await n.getDocument(l,this.uid);this.userRoles=new d(e)}async save(){await n.updateDocument(l,this.uid,this.userRoles);s.dismiss()}async cancel(){s.dismiss()}async presentActionSheet(){let e=[];let t=[];if(c.isTrasteel()){t=r.getUserRoles()}else if(c.isDecoplanner()||c.isUdive()){t=m.getUserRoles()}t.forEach((t=>{if(!this.userRoles.roles.includes(t)){e.push({text:t,handler:()=>{this.userRoles.roles.push(t);this.updateView=!this.updateView}})}}));e.push({text:"Close",icon:"close",role:"cancel",handler:()=>{}});const i=await o.create({header:"Add",buttons:e});await i.present()}updateLicense(e,t){this.userRoles.licences[e]=t.detail.checked;this.updateView=!this.updateView}handleChange(e){if(e.detail.name=="fromDate"){this.userRoles.licences.trial.fromDate=new Date(e.detail.value)}else{this.userRoles.licences.trial[e.detail.name]=e.detail.value}this.updateView=!this.updateView}deleteRole(e){const t=this.itemSliding.getElementsByClassName("item-sliding-"+e)[0];t.closeOpened();this.userRoles.roles.splice(e,1);this.updateView=!this.updateView}render(){return t(i,{key:"c95ab77ea93e03a875f7ce23c4dc00a60b34831f"},t("ion-header",{key:"7ea05eef41d5b7a1c0cb74ffc42ba221edbc3608"},t("ion-toolbar",{key:"70c162862f2fd67b6c89fe9078f31c984f568643",color:c.getAppColor()},t("ion-title",{key:"304469b5009d4fceca47e6047a2f9c1056848489"},"User Roles Manager"))),t("ion-content",{key:"c16709b3fc8dfe2b45607498f26e68aaafd396c3"},t("ion-list",{key:"fc6a912e32db2e0bd39da276871f52c560961021"},t("ion-item",{key:"d06c4c7235d4c6ec7e73bd6fb8f237056d10a124"},"uid: ",this.userRoles.uid),t("ion-item",{key:"ab54ca3bfb4350e36ee075d33ca665f62034b5be"},"email: ",this.userRoles.email),!c.isTrasteel&&Object.keys(this.userRoles.licences).length>0?[t("ion-item-divider",null,"User Licences"),Object.keys(this.userRoles.licences).map((e=>e=="trial"?[t("ion-item-divider",null,t("ion-label",null,"Trial")),t("app-form-item",{"label-tag":"duration","label-text":"Duration",value:this.userRoles.licences.trial.duration,name:"duration","input-type":"number",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{"label-tag":"fromDate","label-text":"From Date",value:this.userRoles.licences.trial.fromDate!==null?this.userRoles.licences.trial.fromDate.toISOString():(new Date).toISOString(),name:"fromDate","input-type":"date",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{"label-tag":"level","label-text":"Level",value:this.userRoles.licences.trial.level,name:"level","input-type":"string",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("ion-item",null,t("ion-label",null,t("p",null,"Trial Days:"," ",this.userRoles.licences.trialDays())))]:[t("ion-item",null,t("ion-label",null,e),t("ion-toggle",{slot:"end",onIonChange:t=>this.updateLicense(e,t),checked:this.userRoles.licences[e]}))]))]:null),t("ion-list",{key:"ae9311a792dab2d83d861aa0101d706ed3a3883e"},t("ion-item-divider",{key:"83c1c27f064d5e82c40d041c7f2a738210ef9fb6"},"User Roles"),this.userRoles.roles.map(((e,i)=>t("ion-item-sliding",{class:"item-sliding-"+i},t("ion-item",null,t("ion-label",null,e)),t("ion-item-options",null,t("ion-item-option",{color:"danger",onClick:()=>this.deleteRole(i)},"Delete"))))),t("ion-item",{key:"c9918e41312dd80c1636bf26d0f6f5c251c62ef0",button:true,onClick:()=>this.presentActionSheet()},t("ion-icon",{key:"2f744f7d9288f208d6d535a836bfa6074bb693c6",name:"add"}),t("ion-label",{key:"ea9e2624d00903917a07c791a9f740d026b5c3d7"},"Add")))),t("app-modal-footer",{key:"2a75d616b990f8b65f6f12a1ea3bba17d0724050",color:c.getAppColor(),onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get itemSliding(){return a(this)}};b.style=p;export{b as modal_edit_user_roles};