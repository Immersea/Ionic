import{r as s,h as t,f as i}from"./p-cbe60c68.js";import{S as e,aQ as a,H as n,J as o,F as l,an as r,aR as h,o as c,aS as d,U as p,T as f,G as b}from"./p-944b5726.js";import{S as u}from"./p-a75993af.js";import{l as m}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import"./p-694b8ade.js";import"./p-c2915cc5.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";const g="page-admin-translations app-admin-translations{width:100%;height:100%}";const y=g;const w=class{constructor(t){s(this,t);this.segment="translations";this.slider=undefined;this.translations=[];this.filteredTranslations=[];this.filter="";this.translationsBackup=[];this.translationsChanged={};this.updateView=false}componentWillLoad(){this.languages=e.getLanguages();this.selectedLanguage=this.languages[0];this.translationsSub=a(n(l(b,d),o("input")),(s=>{this.translations=[];s.forEach((s=>{const t=s.data();t["id"]=s.id;this.translations.push(t)}));this.translationsBackup=m.exports.cloneDeep(this.translations);this.filterTranslations()}))}componentDidLoad(){this.setSliderHeight()}setSliderHeight(){this.slider=new u(".slider-translations",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null;this.slider.updateSize()}}});const s=Array.from(this.el.getElementsByClassName("slide-container"));s.map((s=>{s.setAttribute("style","height: "+r(null,4)+"px")}));this.slider.updateSize();this.updateView=!this.updateView}disconnectedCallback(){this.translationsSub()}segmentChanged(s){if(s.detail.value){this.segment=s.detail.value;if(s.detail.value=="admin"){this.slider.slideTo(1)}else if(s.detail.value=="translations"){this.slider.slideTo(0)}this.updateView=!this.updateView}}selectLanguage(s){this.selectedLanguage=s.target.value;this.updateView=!this.updateView}async runTranslationsScript(){try{await h.updateTranslations();e.presentAlert("Done","Translations saved!")}catch(s){console.log("error runTranslationsScript",s)}}translationChanged(s){if(s&&s.detail){const t=s.detail;this.translationsChanged[t.id]=t;let i=this.translations.findIndex((s=>s.id===t.id));this.translations[i]=t;this.translations=[...this.translations];i=this.filteredTranslations.findIndex((s=>s.id===t.id));this.filteredTranslations[i]=t;this.filteredTranslations=[...this.filteredTranslations];this.updateView=!this.updateView}}filterTranslations(s){if(s&&s.target.value){this.filter=s.target.value}if(this.filter&&this.filter!==""){this.filteredTranslations=this.translations.filter((s=>s.input.toLowerCase().includes(this.filter.toLowerCase())))}else{this.filteredTranslations=m.exports.cloneDeep(this.translations)}this.updateView=!this.updateView}close(){this.translations=m.exports.cloneDeep(this.translationsBackup);this.filterTranslations()}async save(){const s=[];Object.keys(this.translationsChanged).map((t=>{const i=this.translationsChanged[t];delete i.id;s.push(c.updateDocument(d,t,i))}));await Promise.all(s);this.translationsChanged=[]}render(){return[t("ion-header",{key:"93ef8eb002d033cb609eba7d18f63440cd644f7e"},t("app-navbar",{key:"b22e1c10459764e916262895985c94d7454f33bc",color:"udive",tag:"translations",text:"Translations"})),p.userRoles&&p.userRoles.isSuperAdmin()?[t("ion-header",null,t("ion-toolbar",{color:"udive",class:"no-safe-padding"},t("ion-segment",{mode:"md",onIonChange:s=>this.segmentChanged(s),value:this.segment},t("ion-segment-button",{value:"translations",layout:"icon-start"},t("ion-label",null,"TRANSLATIONS")),t("ion-segment-button",{value:"admin",layout:"icon-start"},t("ion-label",null,"ADMIN"))))),this.segment=="translations"?t("ion-header",null,t("ion-toolbar",{color:"udive"},t("ion-searchbar",{animated:true,placeholder:f.getTransl("search","Search"),value:this.filter,debounce:250,onIonInput:s=>this.filterTranslations(s)})),t("ion-toolbar",{color:"udive"},t("ion-item",null,t("ion-select",{label:f.getTransl("language","Language"),labelPlacement:"floating",interface:"action-sheet",value:this.selectedLanguage,onIonChange:s=>this.selectLanguage(s)},this.languages.map((s=>t("ion-select-option",{value:s},s.label)))),t("ion-icon",{slot:"end",class:"flag-icon flag-icon-"+(this.selectedLanguage.countryCode=="en"?"gb":this.selectedLanguage.countryCode)})))):undefined]:undefined,t("ion-content",{key:"00e0a6f793b24ff0e60009887e4e0ab3f62f54a8"},t("swiper-container",{key:"42f010ca377cd2db56e6ab60d0c925bf368eff7f",class:"slider-translations swiper"},t("swiper-wrapper",{key:"0efc8631fd2b09b63f23e50bb7902602b4290cf9",class:"swiper-wrapper"},t("swiper-slide",{key:"fe5e4290b22750458e25e6890dd6e614d4663366",class:"swiper-slide"},t("ion-content",{key:"d47d018a97941ea5d3439866d92190b2c33c3922",class:"slide-container"},t("ion-grid",{key:"ba8a3d08a0f8dff7f265b9aa7decde2d131e2b53"},t("ion-row",{key:"ab18875dba39d0bb43f854e88e44ec244ce29e78"},t("ion-col",{key:"9b8d12beed121b6adb8f87bae6da59e0e7b0e9c3"},t("app-admin-translations",{key:"4a2df05daa77033b409c648787bb9329696a9ba3",translations:this.filteredTranslations,language:this.selectedLanguage.value,onTranslationChanged:s=>this.translationChanged(s)})))))),p.userRoles&&p.userRoles.isSuperAdmin()?t("swiper-slide",{class:"swiper-slide"},t("ion-content",{class:"slide-container"},t("ion-button",{size:"large",onClick:()=>this.runTranslationsScript()},"Run Translations Script"))):undefined))),Object.keys(this.translationsChanged).length>0?t("app-modal-footer",{onCancelEmit:()=>this.close(),onSaveEmit:()=>this.save()}):undefined]}get el(){return i(this)}};w.style=y;export{w as page_admin_translations};