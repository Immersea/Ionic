{"version":3,"names":["pageContactDetailsCss","PageContactDetailsStyle0","PageContactDetails","componentWillLoad","this","loadContact","segmentTitles","information","TranslationService","getTransl","SystemService","presentLoading","contact","ContactsService","getContact","itemId","error","dismissLoading","componentDidLoad","slider","Swiper","speed","spaceBetween","allowTouchMove","autoHeight","on","slideChange","updateAutoHeight","editContact","modal","presentContactUpdate","onDidDismiss","then","segmentChanged","ev","detail","value","segment","update","slideTo","updateSlider","setTimeout","undefined","render","coverURL","photoURL","h","item","key","text","lastName","firstName","color","backButton","rightButtonText","TrasteelService","isCustomerDBAdmin","icon","fill","tag","rightButtonFc","mode","Environment","getAppColor","scrollable","onIonChange","layout","class","vertical","horizontal","slot","style","marginTop","fabButtonTopMarginString","onClick","RouterService","goBack","name","isLabel","lines","labelTag","labelText","detailText","customerId","CustomersService","getCustomersDetails","fullName","customerLocationId","getLocationsTypes","locationName","workPosition","officePhone","mobilePhone","email"],"sources":["src/components/trasteel/pages/crm/page-contact-details/page-contact-details.scss?tag=page-contact-details","src/components/trasteel/pages/crm/page-contact-details/page-contact-details.tsx"],"sourcesContent":["page-contact-details {\n  /* Component styles go here */\n}\n","import {Component, Element, Prop, State, h} from \"@stencil/core\";\nimport {Contact} from \"../../../../../interfaces/trasteel/contact/contact\";\nimport Swiper from \"swiper\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\nimport {SystemService} from \"../../../../../services/common/system\";\nimport {ContactsService} from \"../../../../../services/trasteel/crm/contacts\";\nimport {RouterService} from \"../../../../../services/common/router\";\nimport {fabButtonTopMarginString} from \"../../../../../helpers/utils\";\nimport {CustomersService} from \"../../../../../services/trasteel/crm/customers\";\nimport {TrasteelService} from \"../../../../../services/trasteel/common/services\";\nimport {Environment} from \"../../../../../global/env\";\n\n@Component({\n  tag: \"page-contact-details\",\n  styleUrl: \"page-contact-details.scss\",\n})\nexport class PageContactDetails {\n  @Element() el: HTMLElement;\n  @Prop() itemId: string;\n  @State() contact: Contact;\n  @State() segment = \"information\";\n\n  segmentTitles: {\n    information: string;\n  };\n  @State() slider: Swiper;\n\n  async componentWillLoad() {\n    await this.loadContact();\n    this.segmentTitles = {\n      information: TranslationService.getTransl(\"information\", \"Information\"),\n    };\n  }\n\n  async loadContact() {\n    await SystemService.presentLoading(\"loading\");\n    try {\n      this.contact = await ContactsService.getContact(this.itemId);\n    } catch (error) {}\n    SystemService.dismissLoading();\n  }\n\n  async componentDidLoad() {\n    this.slider = new Swiper(\".slider-contact\", {\n      speed: 400,\n      spaceBetween: 100,\n      allowTouchMove: false,\n      autoHeight: true,\n      on: {\n        slideChange: () => {\n          this.slider ? this.slider.updateAutoHeight() : null;\n        },\n      },\n    });\n  }\n\n  async editContact() {\n    const modal = await ContactsService.presentContactUpdate(this.itemId);\n    //update contact data after modal dismiss\n    modal.onDidDismiss().then(() => this.loadContact());\n  }\n\n  segmentChanged(ev) {\n    if (ev.detail.value) {\n      this.segment = ev.detail.value;\n      this.slider.update();\n      switch (this.segment) {\n        case \"information\":\n          this.slider.slideTo(0);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  updateSlider() {\n    setTimeout(() => {\n      //reset slider height to show address\n      this.slider ? this.slider.update() : undefined;\n    }, 100);\n  }\n\n  render() {\n    return [\n      this.contact.coverURL || this.contact.photoURL ? (\n        <ion-header>\n          <app-item-cover item={this.contact}></app-item-cover>\n        </ion-header>\n      ) : undefined,\n\n      <ion-header>\n        <app-navbar\n          text={this.contact.lastName + \" \" + this.contact.firstName}\n          color=\"trasteel\"\n          backButton={\n            this.contact && !this.contact.coverURL && !this.contact.photoURL\n          }\n          rightButtonText={\n            TrasteelService.isCustomerDBAdmin()\n              ? {\n                  icon: \"create\",\n                  fill: \"outline\",\n                  tag: \"edit\",\n                  text: \"Edit\",\n                }\n              : null\n          }\n          rightButtonFc={() => this.editContact()}\n        ></app-navbar>\n      </ion-header>,\n      <ion-header>\n        <ion-toolbar>\n          <ion-segment\n            mode=\"md\"\n            color={Environment.getAppColor()}\n            scrollable\n            onIonChange={(ev) => this.segmentChanged(ev)}\n            value={this.segment}\n          >\n            <ion-segment-button value=\"information\" layout=\"icon-start\">\n              <ion-label>{this.segmentTitles.information}</ion-label>\n            </ion-segment-button>\n          </ion-segment>\n        </ion-toolbar>\n      </ion-header>,\n      <ion-content class=\"slides\">\n        <ion-fab\n          vertical=\"top\"\n          horizontal=\"start\"\n          slot=\"fixed\"\n          style={{marginTop: fabButtonTopMarginString(2)}}\n        >\n          <ion-fab-button\n            onClick={() => RouterService.goBack()}\n            class=\"fab-icon\"\n          >\n            <ion-icon name=\"arrow-back-circle-outline\"></ion-icon>\n          </ion-fab-button>\n        </ion-fab>\n        <swiper-container class=\"slider-contact swiper\">\n          <swiper-wrapper class=\"swiper-wrapper\">\n            <swiper-slide class=\"swiper-slide\">\n              <ion-list class=\"ion-no-padding\">\n                <ion-list-header>\n                  <my-transl\n                    tag=\"general-information\"\n                    text=\"General Information\"\n                    isLabel\n                  />\n                </ion-list-header>\n                <app-item-detail\n                  lines=\"none\"\n                  labelTag=\"customer\"\n                  labelText=\"Customer\"\n                  detailText={\n                    this.contact.customerId &&\n                    CustomersService.getCustomersDetails(\n                      this.contact.customerId\n                    )\n                      ? CustomersService.getCustomersDetails(\n                          this.contact.customerId\n                        ).fullName\n                      : null\n                  }\n                ></app-item-detail>\n                <app-item-detail\n                  lines=\"none\"\n                  labelTag=\"location\"\n                  labelText=\"Location\"\n                  detailText={\n                    this.contact.customerLocationId &&\n                    CustomersService.getLocationsTypes(\n                      this.contact.customerLocationId\n                    )\n                      ? CustomersService.getLocationsTypes(\n                          this.contact.customerLocationId\n                        )[0].locationName\n                      : null\n                  }\n                ></app-item-detail>\n\n                <app-form-item\n                  label-tag=\"name\"\n                  label-text=\"Name\"\n                  value={this.contact.firstName}\n                  read-only={true}\n                ></app-form-item>\n                <app-form-item\n                  label-tag=\"surname\"\n                  label-text=\"Surname\"\n                  value={this.contact.lastName}\n                  read-only={true}\n                ></app-form-item>\n                <app-form-item\n                  label-tag=\"work-position\"\n                  label-text=\"Work Position\"\n                  value={this.contact.workPosition}\n                  read-only={true}\n                ></app-form-item>\n                <app-form-item\n                  label-tag=\"office-phone\"\n                  label-text=\"Office Phone\"\n                  value={this.contact.officePhone}\n                  read-only={true}\n                ></app-form-item>\n                <app-form-item\n                  label-tag=\"mobile-phone\"\n                  label-text=\"Mobile Phone\"\n                  value={this.contact.mobilePhone}\n                  read-only={true}\n                ></app-form-item>\n                <app-form-item\n                  label-tag=\"email\"\n                  label-text=\"Email\"\n                  value={this.contact.email}\n                  read-only={true}\n                ></app-form-item>\n              </ion-list>\n            </swiper-slide>\n          </swiper-wrapper>\n        </swiper-container>\n      </ion-content>,\n    ];\n  }\n}\n"],"mappings":"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","ignoreList":[]}