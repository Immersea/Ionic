{"version":3,"names":["popoverEditCustomerOwnerCss","PopoverEditCustomerOwnerStyle0","PopoverEditCustomerEwner","componentWillLoad","this","popover","el","closest","selectedOwner","CustomerGroup","sharePerc","owner","groupOwnershipPerc","custGroups","CustomersService","getCustomerGroups","groupId","find","x","newOwnerName","groupName","componentDidLoad","setOwnersSelect","updateView","selectOwnerElement","querySelector","customOwnerPopoverOptions","header","TranslationService","getTransl","group","interfaceOptions","selectOwnerOptions","Array","from","getElementsByTagName","map","option","removeChild","placeholder","selectOption","document","createElement","value","textContent","appendChild","handleSelect","ev","detail","handleChange","name","close","popoverController","dismiss","save","slugify","new","length","render","h","Host","key","translucent","lines","color","id","interface","label","disabled","onIonChange","onFormItemChanged","validator","options","min","max","undefined","saveTag","tag","text","onCancelEmit","onSaveEmit"],"sources":["src/components/trasteel/popovers/popover-edit-customer-owner/popover-edit-customer-owner.scss?tag=popover-edit-customer-owner","src/components/trasteel/popovers/popover-edit-customer-owner/popover-edit-customer-owner.tsx"],"sourcesContent":["popover-edit-customer-owner {\n  /* Component styles go here */\n  ion-list {\n    min-height: 300px;\n  }\n}\n","import {Component, h, Host, Element, Prop, State} from \"@stencil/core\";\nimport {popoverController} from \"@ionic/core\";\nimport {CustomerGroup} from \"../../../../interfaces/trasteel/customer/customer\";\nimport {CustomersService} from \"../../../../services/trasteel/crm/customers\";\nimport {TranslationService} from \"../../../../services/common/translations\";\nimport {slugify} from \"../../../../helpers/utils\";\n\n@Component({\n  tag: \"popover-edit-customer-owner\",\n  styleUrl: \"popover-edit-customer-owner.scss\",\n})\nexport class PopoverEditCustomerEwner {\n  @Prop() owner: CustomerGroup;\n  @Prop() group: boolean = false;\n  @Element() el: HTMLElement;\n  selectedOwner: CustomerGroup;\n  newOwnerName: string;\n  sharePerc: number;\n  custGroups: CustomerGroup[];\n  popover: HTMLIonPopoverElement;\n  @State() updateView = false;\n\n  componentWillLoad() {\n    this.popover = this.el.closest(\"ion-popover\");\n    this.selectedOwner = new CustomerGroup();\n    this.sharePerc = this.owner.groupOwnershipPerc;\n    this.custGroups = CustomersService.getCustomerGroups();\n    if (this.owner && this.owner.groupId) {\n      this.selectedOwner = this.custGroups.find(\n        (x) => x.groupId == this.owner.groupId\n      );\n      if (!this.selectedOwner) {\n        //in case not found in the list\n        this.newOwnerName = this.owner.groupName;\n      }\n    }\n  }\n\n  componentDidLoad() {\n    this.setOwnersSelect();\n    this.updateView = !this.updateView;\n  }\n\n  setOwnersSelect() {\n    const selectOwnerElement: HTMLIonSelectElement =\n      this.el.querySelector(\"#selectOwner\");\n    const customOwnerPopoverOptions = {\n      header: TranslationService.getTransl(\n        this.group ? \"customer_group\" : \"customer_owner\",\n        this.group ? \"Customer Group\" : \"Customer Owner\"\n      ),\n    };\n    selectOwnerElement.interfaceOptions = customOwnerPopoverOptions;\n    //remove previously defined options\n    const selectOwnerOptions = Array.from(\n      selectOwnerElement.getElementsByTagName(\"ion-select-option\")\n    );\n    selectOwnerOptions.map((option) => {\n      selectOwnerElement.removeChild(option);\n    });\n    selectOwnerElement.placeholder = TranslationService.getTransl(\n      \"select\",\n      \"Select\"\n    );\n    this.custGroups.map((group) => {\n      const selectOption = document.createElement(\"ion-select-option\");\n      selectOption.value = group;\n      selectOption.textContent = group.groupName;\n      selectOwnerElement.appendChild(selectOption);\n    });\n  }\n\n  handleSelect(ev) {\n    this.selectedOwner = ev.detail.value;\n  }\n\n  handleChange(ev) {\n    this[ev.detail.name] = ev.detail.value;\n    this.updateView = !this.updateView;\n  }\n\n  close() {\n    popoverController.dismiss();\n  }\n\n  save() {\n    if (this.newOwnerName) {\n      this.owner.groupId = slugify(this.newOwnerName);\n      this.owner.groupName = this.newOwnerName;\n    } else {\n      this.owner.groupId = this.selectedOwner.groupId;\n      this.owner.groupName = this.selectedOwner.groupName;\n    }\n    this.owner.groupOwnershipPerc = this.sharePerc;\n    popoverController.dismiss({\n      owner: this.owner,\n      new: this.newOwnerName && this.newOwnerName.length > 0,\n    });\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-header translucent>\n          <ion-toolbar>\n            <ion-title>Select Owner/Group</ion-title>\n          </ion-toolbar>\n        </ion-header>\n        <ion-content>\n          <ion-item lines=\"none\">\n            <ion-select\n              color=\"trasteel\"\n              id=\"selectOwner\"\n              interface=\"action-sheet\"\n              label=\"Customer\"\n              label-placement=\"floating\"\n              disabled={this.newOwnerName && this.newOwnerName.length > 0}\n              onIonChange={(ev) => this.handleSelect(ev)}\n              value={this.selectedOwner}\n            ></ion-select>\n          </ion-item>\n          <ion-item-divider> - or insert new - </ion-item-divider>\n          <app-form-item\n            lines=\"none\"\n            label-tag=\"name\"\n            label-text=\"Name\"\n            value={this.newOwnerName}\n            name=\"newOwnerName\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n          ></app-form-item>\n          {this.group ? (\n            <app-form-item\n              lines=\"full\"\n              label-tag=\"share_perc\"\n              label-text=\"Share Percentage\"\n              value={this.sharePerc}\n              name=\"sharePerc\"\n              input-type=\"number\"\n              onFormItemChanged={(ev) => this.handleChange(ev)}\n              validator={[\n                {\n                  name: \"minmaxvalue\",\n                  options: {min: 0, max: 100},\n                },\n              ]}\n            ></app-form-item>\n          ) : undefined}\n        </ion-content>\n        <ion-footer>\n          <app-modal-footer\n            saveTag={{tag: \"ok\", text: \"ok\"}}\n            onCancelEmit={() => this.close()}\n            onSaveEmit={() => this.save()}\n          />\n        </ion-footer>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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","ignoreList":[]}