import{r as t,h as s}from"./p-cbe60c68.js";import{w as e,B as i,m as n,v as a,T as r,x as c}from"./p-773bd3de.js";import{l as o}from"./p-1af05547.js";import"./p-c7ee7cfe.js";import{b as d,m as h}from"./p-c2915cc5.js";import"./p-694b8ade.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-c11a967f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";class l{constructor(t){this.id=t&&t.id?t.id:e();this.order=t&&t.order?t.order:0;this.title=t&&t.title?t.title:"";this.subtitle=t&&t.subtitle?t.subtitle:"";this.description=t&&t.description?t.description:"";this.coverURL=t&&t.coverURL?t.coverURL:null;this.link=t&&t.link?t.link:"";this.active=t&&t.active?true:false}}const p="advertising";class m{constructor(){this.advertisingObservable$=new i([])}async getAdvertisingObservable(){const t=await n.getDocumentObservable(a,p);this.advertisingDocSub=t.subscribe((t=>{this.advertisingDoc={};Object.keys(t).map((s=>{this.advertisingDoc[s]=new l(t[s])}));this.advertisingObservable$.next(this.getAdvertisingArray())}))}unsubscribeAdvertising(){this.advertisingDocSub?this.advertisingDocSub.unsubscribe():undefined}async getActiveAdvertising(){const t=await n.getDocument(a,p);this.advertisingDoc={};if(t){Object.keys(t).map((s=>{if(t[s].active){this.advertisingDoc[s]=t[s]}}))}return this.getAdvertisingArray()}getAdvertisingArray(){const t=[];Object.keys(this.advertisingDoc).map((s=>{t.push(this.advertisingDoc[s])}));return o.exports.orderBy(t,"order")}async updateAdvertising(t){this.advertisingDoc[t.id]=t;this.reorderAdvertDoc();await this.saveAdvertDoc()}reorderAdvertDoc(){let t=[];Object.keys(this.advertisingDoc).map((s=>{t.push(this.advertisingDoc[s])}));t=o.exports.orderBy(t,"order");let s=0;t.map((t=>{t.order=s;s++;this.advertisingDoc[t.id]=t}))}async saveAdvertDoc(){await n.updateDocument(a,p,this.advertisingDoc)}async removeAdvertising(t){const s=await d.create({header:r.getTransl("delete-advertising-header","Delete Advertising?"),message:r.getTransl("delete-advertising-message","This advertising will be deleted! Are you sure?"),buttons:[{text:r.getTransl("cancel","Cancel"),role:"cancel",handler:()=>{}},{text:r.getTransl("ok","OK"),handler:()=>{delete this.advertisingDoc[t.id];c.deletePhotoURLs(p,t.id);this.reorderAdvertDoc();this.saveAdvertDoc()}}]});s.present()}followAdvertisingLink(t){window.open("http://"+t.link,"_blank")}}const v=new m;const g="app-admin-advertising{}";const u=g;const b=class{constructor(s){t(this,s);this.editable=true;this.advertisingArray=[]}async componentWillLoad(){this.advertisingSub=v.advertisingObservable$.subscribe((t=>{this.advertisingArray=t}));v.getAdvertisingObservable()}async disconnectedCallback(){this.advertisingSub.unsubscribe();v.unsubscribeAdvertising()}async editAdvertising(t,s){t.stopPropagation();const e=await h.create({component:"popover-edit-advertising",componentProps:{advertising:s},event:null,translucent:true});e.onDidDismiss().then((async t=>{if(t){const s=t.data;await v.updateAdvertising(s)}}));e.present()}async removeAdvertising(t,s){t.stopPropagation();await v.removeAdvertising(s)}render(){return s("ion-content",{key:"123ca215509ac0cbe1e713e00af26a4a7ebbd998"},this.editable?s("ion-item",{button:true,onClick:t=>this.editAdvertising(t,null),color:"light"},s("ion-icon",{name:"add-circle",slot:"start",color:"beach"}),s("ion-label",null,s("my-transl",{tag:"add",text:"Add"}))):undefined,this.advertisingArray.map((t=>s("app-advertising-card",{edit:true,advertising:t,onEditEmit:s=>this.editAdvertising(s,t)}))))}};b.style=u;export{b as app_admin_advertising};