import{r as t,h as e,H as i,f as a}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{o as s}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{ax as c,aA as o,S as d,E as l,T as f}from"./p-a7a717b1.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-e9c4f463.js";const h="modal-project-quantityunit ion-list{width:100%}";const r=h;const b=class{constructor(e){t(this,e);this.index=0;this.quantityUnits=undefined;this.quantityUnit=undefined;this.updateView=true;this.validQuantityUnit=false}async componentWillLoad(){await this.loadQuantityUnits()}async loadQuantityUnits(){await c.downloadProjectSettings();this.quantityUnits=n.exports.cloneDeep(c.getQuantityUnits());if(this.quantityUnits&&this.quantityUnits.length>0){this.quantityUnit=this.quantityUnits[0]}else{this.addQuantityUnit()}this.validateProject()}selectType(t){this.quantityUnit=this.quantityUnits[t.detail.value];this.validateProject()}handleChange(t){const e=t.detail.name;let i=t.detail.value;if(e=="familyId"){i=i.replace(/\s+/g,"-").trim().toLowerCase()}this.quantityUnit[e]=i;this.validateProject()}validateProject(){this.validQuantityUnit=n.exports.isString(this.quantityUnit.quantityUnitId)&&n.exports.isString(this.quantityUnit.quantityUnitId);this.updateView=!this.updateView}addQuantityUnit(){this.quantityUnit=new o;this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}duplicateQuantityUnit(){this.quantityUnit=n.exports.cloneDeep(this.quantityUnit);this.quantityUnit.quantityUnitId=this.quantityUnit.quantityUnitId+"_rev.";this.quantityUnits.push(this.quantityUnit);this.index=this.quantityUnits.length-1}async deleteQuantityUnit(){try{this.quantityUnits.splice(this.index,1);this.index=0;this.quantityUnit=this.quantityUnits[0];this.validateProject()}catch(t){if(t)d.presentAlertError(t)}}async save(t=true){await c.uploadProjectSettings("quantityUnit",this.quantityUnits);return t?s.dismiss():true}async cancel(){return s.dismiss()}render(){return e(i,{key:"a710b9ffc34e2c0655751de746303ee43e46a3fd"},e("ion-content",{key:"f7ae067f800ae6e99925e46c66c44724b4ee9ff0"},e("ion-grid",{key:"25e345ad3228e137b7e0601573f1c964f3796d1b"},e("ion-row",{key:"9201f45073a92c89a4d0b390c8d0b74bbb87c50e"},e("ion-col",{key:"a1dae88f8f073e9ac7517faf62a828c2d1e86486"},e("ion-item",{key:"9eab589d3958203957f858064049cb63580aae35",lines:"none"},e("ion-select",{key:"7c0b1aea440909c752ca4b99b3ad7b1ec9b7e9bd",color:"trasteel",id:"selectType",interface:"action-sheet",label:f.getTransl("project_quantityunit","Project Quantity Unit"),disabled:!this.validQuantityUnit,"label-placement":"floating",onIonChange:t=>this.selectType(t),value:this.index?this.index:0},this.quantityUnits.map(((t,i)=>e("ion-select-option",{value:i},t.quantityUnitId+" | "+t.quantityUnitName.en)))))),e("ion-col",{key:"d8c34f0e0c13653f6930a88e707f5618a407aaf6",size:"1",class:"ion-text-center"},e("ion-button",{key:"686e725edb088958fe99f6eaf0a8c75bdbc43f8c",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.addQuantityUnit()},e("ion-icon",{key:"70e96b85cba33238e5a818a6e89b5bb85a939721",name:"add",slot:"start"}))),e("ion-col",{key:"f460deb1428d89184d44ee01da08aa9768cbc121",size:"1",class:"ion-text-center"},e("ion-button",{key:"c14965f25d0c2c4da4f872c4d6246be7c551b209",fill:"clear",disabled:!this.validQuantityUnit,onClick:()=>this.duplicateQuantityUnit()},e("ion-icon",{key:"cd62d81384683fdaa719a6862e01abaf1b63e4d0",slot:"start",name:"duplicate"}))),e("ion-col",{key:"ad5e194597a5e256460cfe3fa0689d5c9aaf77ec",size:"1",class:"ion-text-center"},e("ion-button",{key:"3b4d77e5dd29b829c0ae3107107cd43ff1f2cfdf",fill:"clear",color:"danger",disabled:this.quantityUnits.length==0,onClick:()=>this.deleteQuantityUnit()},e("ion-icon",{key:"2e8d4ec2ba2478c6c60d74f9b1efdf8080c59acd",slot:"start",name:"trash"}))))),e("app-form-item",{key:"986d874882147a047e631129f8ffff140474da08","label-text":"ID",value:this.quantityUnit.quantityUnitId,name:"quantityUnitId","input-type":"string",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required",{name:"uniqueid",options:{type:"list",index:"quantityUnitId",list:c.getQuantityUnits()}}]}),e("app-form-item",{key:"01dbec5650cced0084ef73314e5284953626325d","label-text":"Name",value:this.quantityUnit.quantityUnitName,name:"quantityUnitName","input-type":"text",multiLanguage:true,"text-rows":"1",onFormItemChanged:t=>this.handleChange(t),labelPosition:"fixed",validator:["required"]})),e("app-modal-footer",{key:"5c0f4b54b3b83a948efac99be6939f757612002e",color:l.getAppColor(),disableSave:!this.validQuantityUnit,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return a(this)}};b.style=r;export{b as modal_project_quantityunit};