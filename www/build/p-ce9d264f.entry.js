import{r as e,h as i,H as t,f as s}from"./p-cbe60c68.js";import{T as a,aa as d,ab as c,U as o}from"./p-4a2e1f71.js";import"./p-c7ee7cfe.js";import{o as r}from"./p-5d4a8e1f.js";import{l as n}from"./p-1af05547.js";import{S as p}from"./p-a75993af.js";import"./p-2578d979.js";import"./p-e9c4f463.js";import"./p-a9f4af61.js";import"./p-694b8ade.js";import"./p-7ee16e8d.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const f="modal-dive-trip-update ion-list{width:100%}modal-dive-trip-update ion-segment-button{--color-checked:var(--ion-color-divetrip-contrast)}";const h=f;const l=class{constructor(i){e(this,i);this.diveTripId=undefined;this.collectionId=undefined;this.organiserId=undefined;this.diveTrip=undefined;this.updateView=true;this.validTrip=false;this.titles=[{tag:"dives"},{tag:"team"},{tag:"bookings"}];this.slider=undefined}async componentWillLoad(){await this.loadDiveTrip();this.placeholder=a.getTransl("insert-title","Insert title")}async loadDiveTrip(){if(this.diveTripId){this.diveTrip=await d.getDiveTrip(this.diveTripId)}else{this.diveTrip=new c;this.diveTrip.organiser={collectionId:this.collectionId,id:this.organiserId};this.diveTrip.users={[o.userRoles.uid]:["owner"]}}}async componentDidLoad(){this.slider=new p(".slider-dive-trip",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true,on:{slideChange:()=>{this.slider?this.slider.updateAutoHeight():null}}});this.validateTrip()}async addDiveTrip(e,i){this.diveTrip=await d.addDiveTrip(this.diveTrip,e,i);this.validateTrip()}removeDiveTrip(e){this.diveTrip=d.removeDiveTrip(this.diveTrip,e);this.validateTrip()}removeTripDive(e,i){this.diveTrip=d.removeTripDive(this.diveTrip,e,i);this.updateView=!this.updateView}setTitle(e){this.diveTrip.displayName=e.target.value;this.validateTrip()}validateTrip(){this.diveTrip.tripDives=n.exports.orderBy(this.diveTrip.tripDives,"divePlan.dives[0].date");this.validTrip=n.exports.isString(this.diveTrip.displayName)&&this.diveTrip.displayName.length>3&&this.diveTrip.tripDives.length>0;this.updateView=!this.updateView}async save(){await d.updateDiveTrip(this.diveTripId,this.diveTrip);return r.dismiss(false)}async cancel(){return r.dismiss(true)}render(){return i(t,{key:"887190467636ed4eadce843b842d7294babd086c"},i("ion-header",{key:"49baac88ee3118c0f961f02b2c6967dab37861f7"},i("ion-toolbar",{key:"123fc6d901cb4c92bc03598a3c50a34ac66e080e",color:"divetrip"},i("ion-title",{key:"9f4b159fd4a62c95348a750c6fb4df3f25d96882"},i("ion-input",{key:"26069cedd5e437752df87d65f406266472a0dc44",placeholder:this.placeholder+"...",inputmode:"text",onIonInput:e=>this.setTitle(e),value:this.diveTrip.displayName})))),i("app-header-segment-toolbar",{key:"29c5cf55c5770734adac22d70550c182322b42a0",color:"divetrip",swiper:this.slider,titles:this.titles}),i("ion-content",{key:"c478b28234ccc25762da7d8a45f135626717be9d",class:"slides"},i("swiper-container",{key:"769ca18f444a7c8b8367119527ed877043bcc083",class:"slider-dive-trip swiper"},i("swiper-wrapper",{key:"89f8dc52282a151aaad02b7e4359e83846bc4afd",class:"swiper-wrapper"},i("swiper-slide",{key:"48e0b2eb428cc2cda49e977b2acb296082feb802",class:"swiper-slide"},i("ion-grid",{key:"7fab2de24a7204846681ebd894f7ad448f56fda4"},i("ion-row",{key:"4ae22004e888629c4d566fe319e4bff26e77bb6e",class:"ion-text-start"},this.diveTrip.tripDives.map(((e,t)=>i("ion-col",{"size-sm":"12","size-md":"6","size-lg":"4"},i("app-dive-trip-card",{tripDive:e,editable:true,updateView:this.updateView,onAddDiveEmit:()=>this.addDiveTrip(t),onRemoveDiveTripEmit:()=>this.removeDiveTrip(t),onRemoveTripDiveEmit:e=>this.removeTripDive(t,n.exports.toNumber(e.detail)),onUpdateDiveEmit:e=>this.addDiveTrip(t,n.exports.toNumber(e.detail))})))),i("ion-col",{key:"4a504260067b6a23ddbba74fc6989f377c946c8c","size-sm":"12","size-md":"6","size-lg":"4"},i("ion-card",{key:"1510abb33d2f9f2eef0a5b3f5ed519d682cf339d",onClick:()=>this.addDiveTrip()},i("ion-card-content",{key:"617630204022ec826d62038e9b3d013d08f90b74",class:"ion-text-center"},i("ion-icon",{key:"b9e2b3033333b8e6a87e9c0cb345ceab1ad8b9f3",name:"add-circle-outline",style:{fontSize:"130px"}}))))))),i("swiper-slide",{key:"a54575e2619d6942fbff9bdbd808494fc67c5a0a",class:"swiper-slide"},i("app-users-list",{key:"75888d14f0f12a604d5985f6a71d7d4ed283b6cd",item:this.diveTrip,editable:true,show:["owner","divemaster","instructor"]})),i("swiper-slide",{key:"41130382563a24fad6652080d42edf0fe490c8ea",class:"swiper-slide"},i("ion-grid",{key:"997cbdb08d3080593a448d166d794e07587f2903"},i("ion-row",{key:"d33ca997cd7d43ec9257da0ff6f7d82382cf0997"},Object.keys(this.diveTrip.tripDives).map((e=>i("ion-col",{"size-sm":"12","size-md":"12","size-lg":"12"},i("app-dive-trip-bookings",{diveTrip:this.diveTrip,diveTripId:this.diveTripId,tripDiveIndex:n.exports.toNumber(e),editable:true})))))))))),i("app-modal-footer",{key:"c24b9cfcbda05a7bf7faad74a461de1ea3742161",disableSave:!this.validTrip,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return s(this)}};l.style=h;export{l as modal_dive_trip_update};
//# sourceMappingURL=p-ce9d264f.entry.js.map