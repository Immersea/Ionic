import{r as t,h as i}from"./p-cbe60c68.js";import{U as s}from"./p-a7a717b1.js";import"./p-c7ee7cfe.js";import{n as e}from"./p-5d4a8e1f.js";import{l as o}from"./p-1af05547.js";import"./p-694b8ade.js";import"./p-e9c4f463.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const r="app-users-list{width:100%}";const a=r;const n=class{constructor(i){t(this,i);this.isOwner=false;this.item=undefined;this.editable=false;this.show=undefined;this.owner=[];this.editor=[];this.instructor=[];this.divemaster=[]}async componentWillLoad(){this.groups={owner:{show:this.show.includes("owner"),tag:"admin",text:"Administrator"},editor:{show:this.show.includes("editor"),tag:"editor",text:"Editor"},instructor:{show:this.show.includes("instructor"),tag:"instructor",text:"Instructor"},divemaster:{show:this.show.includes("divemaster"),tag:"divemaster",text:"Divemaster"}};this.userProfile=s.userProfile;this.isOwner=o.exports.isArray(this.item.users[this.userProfile.uid])&&this.item.users[this.userProfile.uid].includes("owner");await this.setUsers()}async setUsers(){this.owner=[];this.editor=[];this.instructor=[];for(let t of Object.keys(this.item.users)){if(this.item.users[t].includes("owner")){this.owner.push(await s.getMapDataUserDetails(t))}if(this.item.users[t].includes("editor")){this.editor.push(await s.getMapDataUserDetails(t))}if(this.item.users[t].includes("instructor")){this.instructor.push(await s.getMapDataUserDetails(t))}if(this.item.users[t].includes("divemaster")){this.divemaster.push(await s.getMapDataUserDetails(t))}}this.owner=o.exports.orderBy(this.owner,"displayName");this.editor=o.exports.orderBy(this.editor,"displayName");this.instructor=o.exports.orderBy(this.instructor,"displayName");this.divemaster=o.exports.orderBy(this.divemaster,"displayName")}async addUser(t){const i=await e.create({component:"popover-search-user",translucent:true});i.onDidDismiss().then((i=>{const s=i.data;let e=this.item.users[s];if(e&&!this.item.users[s].includes(t)){this.item.users[s].push(t)}else if(!e){this.item.users[s]=[t]}this.setUsers()}));i.present()}removeUser(t,i){const s=this.item.users[t.uid].findIndex((t=>t==i));this.item.users[t.uid].splice(s,1);if(this.item.users[t.uid].length==0){delete this.item.users[t.uid]}this.setUsers()}render(){return[i("ion-list",{key:"187fd79ab3b00f980d009fd956450ca9dc840db2"},Object.keys(this.groups).map((t=>[this.groups[t].show&&(this[t].length>0||this.editable)?[i("ion-item",{lines:"full"},i("my-transl",{tag:this.groups[t].tag,text:this.groups[t].text,isLabel:true}),this.editable&&(this.isOwner||s.userRoles.isSuperAdmin())?i("ion-button",{color:"primary",fill:"clear",slot:"end",onClick:()=>this.addUser(t)},i("ion-icon",{name:"add-circle"})):undefined)]:undefined,this[t].length>0?[this[t].map((e=>i("ion-item",null,this.editable&&(this.isOwner||s.userRoles.isSuperAdmin())?i("ion-button",{"icon-only":true,slot:"end",color:"danger",fill:"clear",disabled:s.userRoles.uid==e.uid,onClick:()=>this.removeUser(e,t)},i("ion-icon",{name:"trash-bin-outline"})):undefined,e.photoURL?i("ion-avatar",{slot:"start"},i("ion-img",{src:e.photoURL})):undefined,i("ion-label",null,e.displayName))))]:undefined])))]}};n.style=a;export{n as app_users_list};
//# sourceMappingURL=p-eaac3595.entry.js.map