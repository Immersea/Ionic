{"file":"app-dragdrop-file.entry.esm.js","mappings":"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","names":["round"],"sources":["src/components/common/app/common/app-dragdrop-file/app-dragdrop-file.scss?tag=app-dragdrop-file","src/components/common/app/common/app-dragdrop-file/app-dragdrop-file.tsx"],"sourcesContent":["app-dragdrop-file {\n  #drop-area {\n    border: 2px dashed white;\n    border-radius: 20px;\n    width: 90%;\n    height: var(--coverHeight);\n    margin: 0 auto 0 auto;\n    padding: 20px;\n    text-align: center;\n    visibility: visible;\n  }\n  #drop-area.highlight {\n    border-color: var(--ion-color-primary) !important;\n    border-style: solid !important;\n    border-width: 5px !important;\n  }\n  p {\n    margin-top: 0;\n    color: white;\n  }\n  ion-note {\n    padding: 0;\n  }\n  .my-form {\n    text-align: center;\n  }\n  .button {\n    display: inline-block;\n    margin: 20px 0 20px 0;\n    padding: 20px;\n    background-color: var(--ion-color-primary);\n    color: var(--ion-color-primary-contrast);\n    cursor: pointer;\n    border-radius: 5px;\n  }\n  .button:hover {\n    background: var(--ion-color-tertiary);\n    color: var(--ion-color-tertiary-contrast);\n  }\n  #fileElem {\n    display: none;\n  }\n}\n","import {\n  Component,\n  h,\n  Element,\n  Event,\n  EventEmitter,\n  Prop,\n  State,\n} from \"@stencil/core\";\nimport {alertController} from \"@ionic/core\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\nimport {round} from \"lodash\";\n@Component({\n  tag: \"app-dragdrop-file\",\n  styleUrl: \"app-dragdrop-file.scss\",\n})\nexport class AppDragdropFile {\n  @Element() el: HTMLElement;\n  form: HTMLFormElement;\n  dropArea: any;\n  inputElement: HTMLInputElement;\n  @Event() fileSelected: EventEmitter<File>;\n  @Prop() fileType: string;\n  @Prop() fileTypes: string[];\n  @Prop() autoOpen = false; //open file box at startup\n  @Prop() file: File;\n  @State() selectedFile: File;\n\n  componentWillLoad() {\n    if (this.file) {\n      this.handleFiles([this.file]);\n    }\n  }\n  componentDidLoad() {\n    // ************************ Drag and drop ***************** //\n    this.dropArea = this.el.querySelector(\"#drop-area\");\n    this.inputElement = this.el.querySelector(\"#fileElem\");\n    this.autoOpen ? this.inputElement.click() : undefined;\n    // Prevent default drag behaviors\n    [\"dragenter\", \"dragover\", \"dragleave\", \"drop\"].forEach((eventName) => {\n      this.dropArea.addEventListener(eventName, this.preventDefaults, false);\n      document.body.addEventListener(eventName, this.preventDefaults, false);\n    });\n\n    // Highlight drop area when item is dragged over it\n    [\"dragenter\", \"dragover\"].forEach((eventName) => {\n      this.dropArea.addEventListener(\n        eventName,\n        () => {\n          this.dropArea.classList.add(\"highlight\");\n        },\n        false\n      );\n    });\n    [\"dragleave\", \"drop\"].forEach((eventName) => {\n      this.dropArea.addEventListener(\n        eventName,\n        () => {\n          this.dropArea.classList.remove(\"highlight\");\n        },\n        false\n      );\n    });\n\n    // Handle dropped files\n    this.dropArea.addEventListener(\n      \"drop\",\n      (e) => {\n        const dt = e.dataTransfer;\n        this.handleFiles(dt.files);\n      },\n      false\n    );\n  }\n\n  preventDefaults(e) {\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  async handleFiles(file) {\n    this.selectedFile = null;\n    if (file.target) {\n      //coming from button click\n      this.selectedFile = file.target.files[0];\n    } else {\n      this.selectedFile = file[0];\n    }\n\n    let test = false;\n\n    if (this.fileType) {\n      const regex = new RegExp(\"^\" + this.fileType + \"\\\\/\\\\w+\");\n      // /^image\\/\\w+/.test(uploadUrl.type)\n      test = regex.test(this.selectedFile.type);\n    } else {\n      test = this.fileTypes.includes(this.selectedFile.type);\n    }\n\n    if (test) {\n      this.fileSelected.emit(this.selectedFile);\n    } else {\n      this.selectedFile = null;\n      const alert = await alertController.create({\n        header: TranslationService.getTransl(\"select-file\", \"Select a File\"),\n        message:\n          TranslationService.getTransl(\n            \"select-file-message\",\n            \"Please select a file of type: \"\n          ) + (this.fileType ? this.fileType : this.fileTypes.join(\", \")),\n        buttons: [\n          {\n            text: TranslationService.getTransl(\"ok\", \"OK\"),\n            handler: async () => {\n              this.inputElement.click();\n            },\n          },\n        ],\n      });\n      alert.present();\n    }\n  }\n\n  render() {\n    return [\n      <div id=\"drop-area\">\n        <p>\n          {this.selectedFile ? (\n            [\n              <ion-note>{this.selectedFile.name}</ion-note>,\n              <br />,\n              <ion-note>\n                {round(this.selectedFile.size / 1024 / 1024, 1)}MB\n              </ion-note>,\n            ]\n          ) : (\n            <my-transl\n              tag=\"dragdrop-file\"\n              text=\"Upload a file with the file dialog or by dragging and\n            dropping the file onto the dashed region\"\n            />\n          )}\n        </p>\n      </div>,\n      <form class=\"my-form\">\n        <input\n          type=\"file\"\n          id=\"fileElem\"\n          accept={\n            this.fileType\n              ? this.fileType + \"/*\"\n              : this.fileTypes && this.fileTypes.length > 0\n                ? this.fileTypes.join(\",\")\n                : \"*/*\"\n          }\n          onClick={() => {\n            return false;\n          }}\n          onChange={(ev) => this.handleFiles(ev)}\n        />\n        <label id=\"labelElem\" class=\"button\" htmlFor=\"fileElem\">\n          <my-transl tag=\"select-file\" text=\"Select a File\" />\n        </label>\n      </form>,\n    ];\n  }\n}\n"],"version":3}