{"file":"modal-datasheet-qualitycolorcode.entry.esm.js","mappings":"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","names":["cloneDeep","isString"],"sources":["src/components/trasteel/modals/modal-datasheet-qualitycolorcode/modal-datasheet-qualitycolorcode.scss?tag=modal-datasheet-qualitycolorcode","src/components/trasteel/modals/modal-datasheet-qualitycolorcode/modal-datasheet-qualitycolorcode.tsx"],"sourcesContent":["modal-datasheet-qualitycolorcode {\n  ion-list {\n    width: 100%;\n  }\n}\n","import {Component, h, Host, State, Element} from \"@stencil/core\";\nimport {modalController} from \"@ionic/core\";\nimport {cloneDeep, isString} from \"lodash\";\nimport {TranslationService} from \"../../../../services/common/translations\";\nimport {Environment} from \"../../../../global/env\";\nimport {SystemService} from \"../../../../services/common/system\";\nimport {DatasheetQualityColorCode} from \"../../../../interfaces/trasteel/refractories/datasheets\";\nimport {DatasheetsService} from \"../../../../services/trasteel/refractories/datasheets\";\n\n@Component({\n  tag: \"modal-datasheet-qualitycolorcode\",\n  styleUrl: \"modal-datasheet-qualitycolorcode.scss\",\n})\nexport class ModalDatasheetQualityColorCode {\n  @Element() el: HTMLElement;\n  @State() index: number = 0;\n  @State() datasheetQualityColorCodes: DatasheetQualityColorCode[];\n  @State() datasheetQualityColorCode: DatasheetQualityColorCode;\n  @State() updateView = true;\n  @State() validDatasheetQualityColorCode = false;\n\n  async componentWillLoad() {\n    await this.loadDatasheetQualityColorCodes();\n  }\n\n  async loadDatasheetQualityColorCodes() {\n    await DatasheetsService.downloadDatasheetSettings();\n    this.datasheetQualityColorCodes = cloneDeep(\n      DatasheetsService.getDatasheetQualityColorCodes()\n    );\n    if (\n      this.datasheetQualityColorCodes &&\n      this.datasheetQualityColorCodes.length > 0\n    ) {\n      this.datasheetQualityColorCode = this.datasheetQualityColorCodes[0];\n    } else {\n      //create new and add to list\n      this.addDatasheetQualityColorCode();\n    }\n    this.validateDatasheet();\n  }\n\n  selectType(ev) {\n    this.datasheetQualityColorCode =\n      this.datasheetQualityColorCodes[ev.detail.value];\n    this.validateDatasheet();\n  }\n\n  handleChange(ev) {\n    const n = ev.detail.name;\n    let v = ev.detail.value;\n    if (n == \"qualityColorCodeId\") {\n      //remove spaces and lowercase\n      v = v.replace(/\\s+/g, \"-\").trim().toLowerCase();\n    }\n    this.datasheetQualityColorCode[n] = v;\n    this.validateDatasheet();\n  }\n\n  validateDatasheet() {\n    this.validDatasheetQualityColorCode =\n      isString(this.datasheetQualityColorCode.qualityColorCodeId) &&\n      isString(this.datasheetQualityColorCode.qualityColorCodePicture);\n    this.updateView = !this.updateView;\n  }\n\n  addDatasheetQualityColorCode() {\n    this.datasheetQualityColorCode = new DatasheetQualityColorCode();\n    this.datasheetQualityColorCodes.push(this.datasheetQualityColorCode);\n    this.index = this.datasheetQualityColorCodes.length - 1;\n  }\n\n  duplicateDatasheetQualityColorCode() {\n    this.datasheetQualityColorCode = cloneDeep(this.datasheetQualityColorCode);\n    this.datasheetQualityColorCode.qualityColorCodeId =\n      this.datasheetQualityColorCode.qualityColorCodeId + \"_rev.\";\n    this.datasheetQualityColorCodes.push(this.datasheetQualityColorCode);\n    this.index = this.datasheetQualityColorCodes.length - 1;\n  }\n\n  async deleteDatasheetQualityColorCode() {\n    try {\n      this.datasheetQualityColorCodes.splice(this.index, 1);\n      this.index = 0;\n      this.datasheetQualityColorCode = this.datasheetQualityColorCodes[0];\n      this.validateDatasheet();\n    } catch (error) {\n      if (error) SystemService.presentAlertError(error);\n    }\n  }\n\n  async save(dismiss = true) {\n    await DatasheetsService.uploadDatasheetSettings(\n      \"qualityColorCode\",\n      this.datasheetQualityColorCodes\n    );\n    return dismiss ? modalController.dismiss() : true;\n  }\n\n  async cancel() {\n    return modalController.dismiss();\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-content>\n          <ion-grid>\n            <ion-row>\n              <ion-col>\n                <ion-item lines=\"none\">\n                  <ion-select\n                    color=\"trasteel\"\n                    id=\"selectType\"\n                    interface=\"action-sheet\"\n                    label={TranslationService.getTransl(\n                      \"datasheet_qualityColorCode\",\n                      \"Datasheet QualityColorCode\"\n                    )}\n                    disabled={!this.validDatasheetQualityColorCode}\n                    label-placement=\"floating\"\n                    onIonChange={(ev) => this.selectType(ev)}\n                    value={this.index ? this.index : 0}\n                  >\n                    {this.datasheetQualityColorCodes.map(\n                      (datasheetQualityColorCode, index) => (\n                        <ion-select-option value={index}>\n                          {datasheetQualityColorCode.qualityColorCodeId +\n                            \" | \" +\n                            datasheetQualityColorCode.qualityColorCodePicture}\n                        </ion-select-option>\n                      )\n                    )}\n                  </ion-select>\n                </ion-item>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  disabled={!this.validDatasheetQualityColorCode}\n                  onClick={() => this.addDatasheetQualityColorCode()}\n                >\n                  <ion-icon name=\"add\" slot=\"start\" />\n                </ion-button>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  disabled={!this.validDatasheetQualityColorCode}\n                  onClick={() => this.duplicateDatasheetQualityColorCode()}\n                >\n                  <ion-icon slot=\"start\" name=\"duplicate\"></ion-icon>\n                </ion-button>\n              </ion-col>\n              <ion-col size=\"1\" class=\"ion-text-center\">\n                <ion-button\n                  fill=\"clear\"\n                  color=\"danger\"\n                  disabled={this.datasheetQualityColorCodes.length == 0}\n                  onClick={() => this.deleteDatasheetQualityColorCode()}\n                >\n                  <ion-icon slot=\"start\" name=\"trash\"></ion-icon>\n                </ion-button>\n              </ion-col>\n            </ion-row>\n          </ion-grid>\n          <app-form-item\n            label-text=\"ID\"\n            value={this.datasheetQualityColorCode.qualityColorCodeId}\n            name=\"qualityColorCodeId\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n            labelPosition=\"fixed\"\n            validator={[\n              \"required\",\n              {\n                name: \"uniqueid\",\n                options: {\n                  type: \"list\",\n                  index: \"qualityColorCodeId\",\n                  list: DatasheetsService.getDatasheetQualityColorCodes(),\n                },\n              },\n            ]}\n          ></app-form-item>\n          <app-form-item\n            label-text=\"Name\"\n            value={this.datasheetQualityColorCode.qualityColorCodePicture}\n            name=\"qualityColorCodePicture\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n            labelPosition=\"fixed\"\n            validator={[\"required\"]}\n          ></app-form-item>\n        </ion-content>\n        <app-modal-footer\n          color={Environment.getAppColor()}\n          disableSave={!this.validDatasheetQualityColorCode}\n          onCancelEmit={() => this.cancel()}\n          onSaveEmit={() => this.save()}\n        />\n      </Host>\n    );\n  }\n}\n"],"version":3}