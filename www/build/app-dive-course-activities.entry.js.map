{"file":"app-dive-course-activities.entry.esm.js","mappings":"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","names":["cloneDeep","orderBy","isValid","format"],"sources":["src/components/udive/app/diving-classes/app-dive-course-activities/app-dive-course-activities.scss?tag=app-dive-course-activities","src/components/udive/app/diving-classes/app-dive-course-activities/app-dive-course-activities.tsx"],"sourcesContent":["app-dive-course-activities {\n  /* Component styles go here */\n  width: 100%;\n}\n","import {Component, h, Prop, EventEmitter, Event, State} from \"@stencil/core\";\nimport {cloneDeep, orderBy} from \"lodash\";\nimport {Activity} from \"../../../../../interfaces/udive/diving-class/divingClass\";\nimport {popoverController} from \"@ionic/core\";\nimport {DivingCentersService} from \"../../../../../services/udive/divingCenters\";\nimport {DiveSitesService} from \"../../../../../services/udive/diveSites\";\nimport {format, isValid} from \"date-fns\";\n\n@Component({\n  tag: \"app-dive-course-activities\",\n  styleUrl: \"app-dive-course-activities.scss\",\n})\nexport class AppDiveCourseActivities {\n  @Prop() schedule: Activity[];\n  @Prop() showDiveLocation: boolean = true;\n  @Prop() editable: boolean = false;\n\n  @Event() scheduleEmit: EventEmitter<Activity[]>;\n  @State() updateView = false;\n\n  async reorderActivities(reorder) {\n    const schedule = cloneDeep(this.schedule);\n    const itemMove = schedule.splice(reorder.detail.from, 1)[0];\n    schedule.splice(reorder.detail.to, 0, itemMove);\n    schedule.forEach((cert, order) => {\n      cert.order = order;\n    });\n    reorder.detail.complete(schedule);\n    this.schedule = orderBy(schedule, [\"days\", \"order\"]);\n  }\n\n  async editActivity(key?) {\n    let activity = null;\n    let maxDay = 1;\n    let order = 0;\n    if (this.schedule) {\n      this.schedule.map((activity) => {\n        if (activity.day > maxDay) {\n          maxDay = activity.day;\n        }\n      });\n      order = this.schedule.length;\n    }\n    if (key === undefined) {\n      activity = {\n        order: order,\n        type: null, //theory, dry, dive\n        title: {\n          tag: null,\n          text: null,\n        },\n        day: maxDay,\n        completed: false,\n        divePlan: null,\n      };\n    } else {\n      activity = cloneDeep(this.schedule[key]);\n    }\n    const popover = await popoverController.create({\n      component: \"popover-new-class-activity\",\n      componentProps: {\n        activity: activity,\n        showDiveLocation: this.showDiveLocation,\n      },\n      translucent: true,\n    });\n    popover.onDidDismiss().then((ev) => {\n      const activity = ev.data;\n      //reset dive date to null\n      if (activity.divePlan) {\n        activity.divePlan.dives[0].date = null;\n      }\n      if (activity) {\n        if (key === undefined) {\n          !this.schedule ? (this.schedule = []) : undefined;\n          this.schedule.push(activity);\n        } else {\n          this.schedule[key] = activity;\n        }\n      }\n      this.scheduleEmit.emit(this.schedule);\n      this.updateView = !this.updateView;\n    });\n    popover.present();\n  }\n\n  render() {\n    return (\n      <ion-list>\n        <ion-list-header>\n          <ion-label>\n            <my-transl tag=\"activities\" text=\"Activities\" />\n          </ion-label>\n          {this.editable ? (\n            <ion-button icon-only onClick={() => this.editActivity()}>\n              <ion-icon name=\"add-circle-outline\"></ion-icon>\n            </ion-button>\n          ) : undefined}\n        </ion-list-header>\n        {this.schedule ? (\n          <ion-reorder-group\n            disabled={!this.editable}\n            onIonItemReorder={(ev) => this.reorderActivities(ev)}\n          >\n            {this.schedule.map((activity, i) => (\n              <ion-item>\n                <ion-reorder slot=\"end\"></ion-reorder>\n                <ion-label>\n                  <h5>Day {activity.day}</h5>\n                  <h2>\n                    <my-transl\n                      tag={activity.title.tag}\n                      text={activity.title.text}\n                    ></my-transl>\n                  </h2>\n\n                  {activity.divePlan\n                    ? [\n                        <p>\n                          {isValid(activity.divePlan.dives[0].date)\n                            ? [\n                                <my-transl tag=\"hour\" text=\"Hour\"></my-transl>,\n                                \": \" +\n                                  format(activity.divePlan.dives[0].date, \"p\"),\n                              ]\n                            : undefined}\n                        </p>,\n                        <p>\n                          {activity.divePlan.dives[0].divingCenterId\n                            ? [\n                                <my-transl\n                                  tag=\"diving-center\"\n                                  text=\"Diving Center\"\n                                ></my-transl>,\n                                \": \" +\n                                  DivingCentersService.getDivingCenterDetails(\n                                    activity.divePlan.dives[0].divingCenterId\n                                  ).displayName,\n                              ]\n                            : undefined}\n                        </p>,\n                        <p>\n                          {activity.divePlan.dives[0].diveSiteId\n                            ? [\n                                <my-transl\n                                  tag=\"dive-site\"\n                                  text=\"Dive Site\"\n                                ></my-transl>,\n                                \": \" +\n                                  DiveSitesService.getDiveSitesDetails(\n                                    activity.divePlan.dives[0].diveSiteId\n                                  ).displayName,\n                              ]\n                            : undefined}\n                        </p>,\n                      ]\n                    : undefined}\n                </ion-label>\n                {this.editable ? (\n                  <ion-button\n                    icon-only\n                    fill=\"clear\"\n                    onClick={() => this.editActivity(i)}\n                  >\n                    <ion-icon name=\"create-outline\"></ion-icon>\n                  </ion-button>\n                ) : undefined}\n              </ion-item>\n            ))}\n          </ion-reorder-group>\n        ) : undefined}\n      </ion-list>\n    );\n  }\n}\n"],"version":3}