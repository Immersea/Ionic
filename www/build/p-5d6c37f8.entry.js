import{r as e,h as t,H as a,f as i}from"./p-cbe60c68.js";import{U as s,n as d,q as o,a as n,a2 as r,a3 as h,D as l}from"./p-83f44900.js";import"./p-c7ee7cfe.js";import{o as p}from"./p-5d4a8e1f.js";import{l as m}from"./p-1af05547.js";import{S as c}from"./p-a75993af.js";import"./p-1819cfda.js";import"./p-e9c4f463.js";import"./p-46038295.js";import"./p-694b8ade.js";import"./p-7ee16e8d.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";const f="modal-dive-community-update ion-list{width:100%}";const b=f;const u=class{constructor(t){e(this,t);this.titles=[{tag:"map"},{tag:"position"},{tag:"information"},{tag:"team"}];this.stdConfigurations=[];this.diveCommunityId=undefined;this.diveCommunity=undefined;this.updateView=true;this.validDiveCommunity=false;this.tmpDiveCommunityId=undefined;this.slider=undefined;this.showDCId=false}async componentWillLoad(){this.userProfileSub$=s.userProfile$.subscribe((e=>{this.userProfile=new d(e)}));this.userSettingsSub$=s.userSettings$.subscribe((e=>{this.userSettings=new o(e);this.stdConfigurations=m.exports.cloneDeep(this.userSettings.userConfigurations)}));await this.loadDiveCommunity()}async loadDiveCommunity(){if(this.diveCommunityId){this.showDCId=false;this.tmpDiveCommunityId=this.diveCommunityId;this.diveCommunity=await n.getDiveCommunity(this.diveCommunityId);this.draggableMarkerPosition={lat:this.diveCommunity.position.geopoint.latitude,lon:this.diveCommunity.position.geopoint.longitude}}else{this.showDCId=true;this.diveCommunity=new r;this.diveCommunity.users={[s.userRoles.uid]:["owner"]};this.draggableMarkerPosition={}}}async componentDidLoad(){this.slider=new c(".slider-dive-community-modal",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true});await customElements.whenDefined("app-map");this.mapElement=this.el.querySelector("#map");const e=this.el.querySelector("#map-container");e.setAttribute("style","height: "+h(this.diveCommunity.coverURL,true)+"px");this.mapElement["mapLoaded"]().then((()=>{this.mapElement.triggerMapResize()}));this.mapElement.triggerMapResize();this.validateDiveCommunity()}disconnectedCallback(){this.userProfileSub$.unsubscribe();this.userSettingsSub$.unsubscribe()}updateLocation(e){this.draggableMarkerPosition={lat:m.exports.toNumber(e.detail.lat),lon:m.exports.toNumber(e.detail.lon)};this.diveCommunity.setPosition(e.detail.lat,e.detail.lon);this.validateDiveCommunity()}updateAddress(e){this.diveCommunity.setAddress(e.detail)}handleChange(e){if(e.detail.name=="facebook"||e.detail.name=="instagram"||e.detail.name=="twitter"||e.detail.name=="website"||e.detail.name=="email"){const t=m.exports.toLower(e.detail.value).split(" ").join("-");this.diveCommunity[e.detail.name]=t}else if(e.detail.name=="id"){this.setTmpId(e.detail.value)}else{this.diveCommunity[e.detail.name]=e.detail.value}this.updateView=!this.updateView;this.validateDiveCommunity()}setTmpId(e){this.tmpDiveCommunityId=m.exports.toLower(e).trim().split(" ").join("-").substring(0,16)}updateImageUrls(e){const t=e.detail.type;const a=e.detail.url;if(t=="photo"){this.diveCommunity.photoURL=a}else{this.diveCommunity.coverURL=a}}uniqueIdValid(e){if(e.detail){this.diveCommunityId=this.tmpDiveCommunityId}else{this.diveCommunityId=null}}validateDiveCommunity(){this.validDiveCommunity=this.diveCommunity.position&&m.exports.isNumber(this.diveCommunity.position.geopoint.latitude)&&m.exports.isNumber(this.diveCommunity.position.geopoint.longitude)&&m.exports.isString(this.diveCommunityId)&&m.exports.isString(this.diveCommunity.displayName)&&m.exports.isString(this.diveCommunity.description)}async save(){await n.updateDiveCommunity(this.diveCommunityId,this.diveCommunity,this.userProfile.uid);return p.dismiss()}async cancel(){return p.dismiss()}render(){return t(a,{key:"ebb47131b6aaa0c135bfe03686fa8894fca37b3d"},t("ion-header",{key:"e5c9bc45e699aa5f0e6dbf2a0c73f7dcb95db760"},t("app-upload-cover",{key:"f3dd52e10544b9c56581b50fb25e2fde218991d2",item:{collection:l,id:this.diveCommunityId,photoURL:this.diveCommunity.photoURL,coverURL:this.diveCommunity.coverURL},onCoverUploaded:e=>this.updateImageUrls(e)})),t("app-header-segment-toolbar",{key:"241c9d1fea9aab8b109162e87d0fbae07abff5cc",color:"divecommunities",swiper:this.slider,titles:this.titles}),t("ion-content",{key:"8335e1110aba1c6f4684d88535763d5a7eee3c36",class:"slides"},t("swiper-container",{key:"4e6a1cf285021aa4b46a469bee6cd06829310373",class:"slider-dive-community-modal swiper"},t("swiper-wrapper",{key:"d42098a6d0c596fe398e79bb67db566d97cbf115",class:"swiper-wrapper"},t("swiper-slide",{key:"b11b9e0fd8487b70b14ccef12163c260d8dc45d8",class:"swiper-slide"},t("div",{key:"db5bb01cbe834a761c840fdb3ebb4b2f983781ed",id:"map-container"},t("app-map",{key:"b2d7c708d8d12589570940be75e2852bfc5339b2",id:"map",pageId:"dive-community",draggableMarkerPosition:this.draggableMarkerPosition,onDragMarkerEnd:e=>this.updateLocation(e)}))),t("swiper-slide",{key:"3b3174e2cb830f9d6404f529a50f9a720248ef3a",class:"swiper-slide"},t("app-coordinates",{key:"dd9908f00fab913246f606421916a8691c7749bd",coordinates:this.draggableMarkerPosition,onCoordinatesEmit:e=>this.updateLocation(e),onAddressEmit:e=>this.updateAddress(e)})),t("swiper-slide",{key:"30280229986e7af65d9bef87b1f9b8a62160639f",class:"swiper-slide"},t("ion-list",{key:"62ddf2f564e6fdb1e6df2b8efb392b0b5e14faf0",class:"ion-no-padding"},t("ion-list-header",{key:"795b881521dcf32f0f4d0b7fddd72dccf87954d7"},t("my-transl",{key:"efc8498729e46d282dfedc589b897866f926c332",tag:"general-information",text:"General Information",isLabel:true})),t("app-form-item",{key:"26ae9898fc6e89d357a4e74a892f7e871851f0fb","label-tag":"name","label-text":"Name",value:this.diveCommunity.displayName,name:"displayName","input-type":"text",onFormItemChanged:e=>this.handleChange(e),onFormItemBlur:()=>this.setTmpId(this.diveCommunity.displayName),validator:["required"]}),this.showDCId?t("app-form-item",{"label-tag":"unique-id","label-text":"Unique ID",value:this.tmpDiveCommunityId,name:"id","input-type":"text",onFormItemChanged:e=>this.handleChange(e),onIsValid:e=>this.uniqueIdValid(e),validator:["required",{name:"uniqueid",options:{type:l}}]}):undefined,t("app-form-item",{key:"2ad2e05c0ed0132cb2a19aba8620ae6a2282a780","label-tag":"description","label-text":"Description",value:this.diveCommunity.description,name:"description",textRows:10,"input-type":"text",onFormItemChanged:e=>this.handleChange(e),validator:["required"]}),t("app-form-item",{key:"11a7552579c8d8a04ebe8dd08668bbc494d2a76e","label-tag":"phone","label-text":"Phone",value:this.diveCommunity.phoneNumber,name:"phoneNumber","input-type":"tel",onFormItemChanged:e=>this.handleChange(e),validator:[]}),t("app-form-item",{key:"92367a499cb685c68f98635e262722be9d32392b","label-tag":"email","label-text":"Email",value:this.diveCommunity.email,name:"email","input-type":"email",onFormItemChanged:e=>this.handleChange(e),validator:["email"]}),t("app-form-item",{key:"b3e67bf4463134fe68f4334eca9ffbe33990c6fb","label-tag":"website","label-text":"Website",value:this.diveCommunity.website,name:"website","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.diveCommunity.website?t("a",{class:"ion-padding-start",href:"http://"+this.diveCommunity.website,target:"_blank"},"http://"+this.diveCommunity.website):undefined,t("app-form-item",{key:"0594c794dfdf08670eb4e2d017112aa1eae3363d","label-tag":"facebook-id","label-text":"Facebook ID",value:this.diveCommunity.facebook,name:"facebook","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.diveCommunity.facebook?t("a",{class:"ion-padding-start",href:"https://www.facebook.com/"+this.diveCommunity.facebook,target:"_blank"},"https://www.facebook.com/"+this.diveCommunity.facebook):undefined,t("app-form-item",{key:"ab43d16f7cfd22bedaa6fae2e721475d51a90eb2","label-tag":"instagram-id","label-text":"Instagram ID",value:this.diveCommunity.instagram,name:"instagram","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.diveCommunity.instagram?t("a",{class:"ion-padding-start",href:"https://www.instagram.com/"+this.diveCommunity.instagram,target:"_blank"},"https://www.instagram.com/"+this.diveCommunity.instagram):undefined,t("app-form-item",{key:"1c42b4e35ddf7f3554a4bee19aae3c84ac162890","label-tag":"twitter id","label-text":"Twitter ID",value:this.diveCommunity.twitter,name:"twitter","input-type":"url",onFormItemChanged:e=>this.handleChange(e),validator:[]}),this.diveCommunity.twitter?t("a",{class:"ion-padding-start",href:"https://www.twitter.com/"+this.diveCommunity.twitter,target:"_blank"},"https://www.twitter.com/"+this.diveCommunity.twitter):undefined)),t("swiper-slide",{key:"3ea51aee31e7d33270e9deacd26c939698ee147a",class:"swiper-slide"},t("app-users-list",{key:"8afa2ebf7bf80864d1286385dbb1f7d36bc70e83",item:this.diveCommunity,editable:true,show:["owner","editor"]}))))),t("app-modal-footer",{key:"3a358e13ed6c11bfff0e41df63c449a49c63e3da",disableSave:!this.validDiveCommunity,onCancelEmit:()=>this.cancel(),onSaveEmit:()=>this.save()}))}get el(){return i(this)}};u.style=b;export{u as modal_dive_community_update};
//# sourceMappingURL=p-5d6c37f8.entry.js.map