{"file":"popover-datasheets-filter.entry.esm.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,0BAA0B,GAAG,iFAAiF;;MCiBvG,uBAAuB;;;;8BAGR,IAAI;6BACoB,EAAE;;kCAEtB,KAAK;0BACb,KAAK;;IAK3B,iBAAiB;QACf,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;QAC9C,IAAI,CAAC,sBAAsB,GAAG,iBAAiB,CAAC,yBAAyB,EAAE,CAAC;QAC5E,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC,oBAAoB,EAAE,CAAC;QAClE,IAAI,CAAC,aAAa,GAAG,iBAAiB,CAAC,yBAAyB,EAAE,CAAC;QACnE,IAAI,CAAC,uBAAuB,EAAE,CAAC;KAChC;IAED,uBAAuB;QACrB,IAAI,CAAC,kBAAkB,GAAG,IAAI,uBAAuB,CAAC;YACpD,KAAK,EAAE,YAAY;YACnB,SAAS,EAAE,MAAM;YACjB,SAAS,EAAE,KAAK;YAChB,eAAe,EAAE,OAAO;SACzB,CAAC,CAAC;QACH,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAED,eAAe,CAAC,KAAK;QACnB,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACxC,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC;KACpC;IAED,YAAY,CAAC,EAAE;QACb,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;KAC/C;IAED,uBAAuB,CAAC,EAAE;QACxB,IAAI,CAAC,MAAM,CAAC,aAAa,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;KAC7C;IAED,kBAAkB,CAAC,EAAE;QACnB,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;KACxC;IAED,cAAc,CAAC,EAAE;QACf,IAAI,EAAE,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,EAAE;YAC7B,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;SAC5B;aAAM;YACL,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;SAC7B;KACF;IAED,kBAAkB,CAAC,EAAE;QACnB,IAAI,CAAC,kBAAkB,CAAC,SAAS,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;QACpD,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAED,cAAc,CAAC,EAAE;QACf,IAAI,CAAC,kBAAkB,CAAC,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;QACnD,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAED,WAAW,CAAC,EAAE;QACZ,IAAI,CAAC,kBAAkB,CAAC,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;QAChD,IAAI,CAAC,gBAAgB,EAAE,CAAC;KACzB;IAED,cAAc;QACZ,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAACA,wBAAS,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC;QAChE,IAAI,CAAC,uBAAuB,EAAE,CAAC;KAChC;IAED,gBAAgB;QACd,IAAI,CAAC,kBAAkB;YACrBC,uBAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC;gBACvCA,uBAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC;gBAC3CA,uBAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC;gBAC1CA,uBAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC;gBAC3C,CAACC,qBAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;KAC1C;IAED,KAAK;QACH,iBAAiB,CAAC,OAAO,EAAE,CAAC;KAC7B;IAED,IAAI;QACF,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;KACxC;IAED,MAAM;QACJ,QACE,EAAC,IAAI,uDACH,mEAAY,WAAW,UACrB,sEACE,wFAAwC,CAC5B,CACH,EACb,sEACE,oEACE,IAAI,EAAC,KAAK,EACV,KAAK,EAAC,UAAU,EAChB,WAAW,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,EAC5C,KAAK,EAAC,MAAM,IAEZ,2EAAoB,KAAK,EAAC,MAAM,IAC9B,2EAA2B,CACR,EACrB,2EAAoB,KAAK,EAAC,UAAU,IAClC,+EAA+B,CACZ,CACT,EACd,mEACG,IAAI,CAAC,cAAc;cAChB;gBACE,oBACE,kBACE,KAAK,EAAC,UAAU,EAChB,SAAS,EAAC,cAAc,EACxB,KAAK,EAAE,kBAAkB,CAAC,SAAS,CACjC,aAAa,EACb,cAAc,CACf,qBACe,UAAU,EAC1B,WAAW,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,uBAAuB,CAAC,EAAE,CAAC,EACrD,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,aAAa,IAE/B,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,CAAC,IAAI,MACpC,yBAAmB,KAAK,EAAE,IAAI,CAAC,aAAa,IACzC,IAAI,CAAC,eAAe,CACH,CACrB,CAAC,CACS,CACJ;gBACX,oBACE,kBACE,KAAK,EAAC,UAAU,EAChB,SAAS,EAAC,cAAc,EACxB,KAAK,EAAE,kBAAkB,CAAC,SAAS,CAAC,QAAQ,EAAE,QAAQ,CAAC,qBACvC,UAAU,EAC1B,WAAW,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,EAChD,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ,IAE1B,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,IAAI,MAC/B,yBAAmB,KAAK,EAAE,IAAI,CAAC,QAAQ,IACpC,IAAI,CAAC,UAAU,CACE,CACrB,CAAC,CACS,CACJ;gBACX,mCACa,mBAAmB,EAC9B,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,UAAU,EAC7B,IAAI,EAAC,YAAY,gBACN,SAAS,EACpB,iBAAiB,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,GACjC;aAClB;cACD;gBACE,oBACE,mBACE,mBACE,yBACE,KAAK,EAAC,UAAU,EAChB,KAAK,EAAE,IAAI,CAAC,kBAAkB,CAAC,SAAS,EACxC,KAAK,EAAC,MAAM,EACZ,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,IAAI,CAAC,EACxC,QAAQ,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,EAC7C,aAAa,EAAE,IAAI,CAAC,aAAa,EACjC,aAAa,EAAC,QAAQ,EACtB,eAAe,EAAE,CAAC,UAAU,CAAC,GACV,CACb,EACV,eAAS,IAAI,EAAC,GAAG,IACf,gBAAU,KAAK,EAAC,MAAM,IACpB,kBACE,KAAK,EAAC,UAAU,EAChB,SAAS,EAAC,cAAc,EACxB,WAAW,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,EAC5C,KAAK,EAAE,IAAI,CAAC,kBAAkB,CAAC,QAAQ,IAEvC,yBAAmB,KAAK,EAAE,IAAI,IAC5B,qBAAY,IAAI,CAAa,CACX,EACpB,yBAAmB,KAAK,EAAE,GAAG,IAC3B,qBAAY,GAAG,CAAa,CACV,EACpB,yBAAmB,KAAK,EAAE,GAAG,IAC3B,qBAAY,GAAG,CAAa,CACV,EACpB,yBAAmB,KAAK,EAAE,GAAG,IAC3B,qBAAY,GAAG,CAAa,CACV,EACpB,yBAAmB,KAAK,EAAE,IAAI,IAC5B,qBAAY,IAAI,CAAa,CACX,CACT,CACJ,CACH,CACF,EACV,mBACE,mBACE,qBACE,KAAK,EAAE,IAAI,CAAC,kBAAkB,CAAC,KAAK,EACpC,IAAI,EAAC,SAAS,gBACH,QAAQ,EACnB,iBAAiB,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,GAChC,CACT,EAEV,eAAS,IAAI,EAAC,GAAG,IACf,qCAEE,IAAI,EAAC,SAAS,EACd,OAAO,EAAE,MAAM,IAAI,CAAC,cAAc,EAAE,EACpC,QAAQ,EAAE,CAAC,IAAI,CAAC,kBAAkB,IAElC,gBAAU,IAAI,EAAC,KAAK,EAAC,KAAK,EAAC,SAAS,GAAY,CACrC,CACL,CACF,CACD;gBACX,4BACE,kCAAiC,CAChB;gBACnB,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,KAAK,MACzC,oBACE,qBACG,iBAAiB,CAAC,yBAAyB,CAC1C,IAAI,EACJ,QAAQ,CAAC,SAAS,CACnB,CAAC,CAAC,CAAC,CAAC,QAAQ;oBACX,GAAG;oBACH,QAAQ,CAAC,QAAQ;oBACjB,GAAG;oBACH,QAAQ,CAAC,KAAK,CACN,EACZ,qCAEE,IAAI,EAAC,OAAO,EACZ,OAAO,EAAE,MAAM,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,IAE1C,gBAAU,IAAI,EAAC,OAAO,EAAC,KAAK,EAAC,QAAQ,GAAY,CACtC,CACJ,CACZ,CAAC;aACH,CACI,CACC,EACd,qEACE,yEACE,OAAO,EAAE,EAAC,GAAG,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAC,EACxC,YAAY,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,EAChC,UAAU,EAAE,MAAM,IAAI,CAAC,IAAI,EAAE,GAC7B,CACS,CACR,EACP;KACH;;;;;;;","names":["cloneDeep","isString","isNull"],"sources":["src/components/trasteel/popovers/popover-datasheets-filter/popover-datasheets-filter.scss?tag=popover-datasheets-filter","src/components/trasteel/popovers/popover-datasheets-filter/popover-datasheets-filter.tsx"],"sourcesContent":["popover-datasheets-filter {\n  /* Component styles go here */\n  ion-list {\n    min-height: 300px;\n  }\n}\n","import {Component, h, Host, Element, Prop, State} from \"@stencil/core\";\nimport {popoverController} from \"@ionic/core\";\nimport {TranslationService} from \"../../../../services/common/translations\";\nimport {\n  DatasheetFamily,\n  DatasheetFilter,\n  DatasheetMajorFamily,\n  DatasheetPropertyName,\n} from \"../../../../interfaces/trasteel/refractories/datasheets\";\nimport {DatasheetsService} from \"../../../../services/trasteel/refractories/datasheets\";\nimport {FirebaseFilterCondition} from \"../../../../interfaces/common/system/system\";\nimport {cloneDeep, isNull, isString} from \"lodash\";\n\n@Component({\n  tag: \"popover-datasheets-filter\",\n  styleUrl: \"popover-datasheets-filter.scss\",\n})\nexport class PopoverDatasheetsFilter {\n  @Element() el: HTMLElement;\n  @Prop() filter: DatasheetFilter;\n  @State() showBaseFilter = true;\n  @State() propertyNames: DatasheetPropertyName[] = [];\n  @State() newFilterCondition: FirebaseFilterCondition;\n  @State() showAddNewProperty = false;\n  @State() updateView = false;\n  popover: HTMLIonPopoverElement;\n  datasheetMajorFamilies: DatasheetMajorFamily[];\n  datasheetFamilies: DatasheetFamily[];\n\n  componentWillLoad() {\n    this.popover = this.el.closest(\"ion-popover\");\n    this.datasheetMajorFamilies = DatasheetsService.getDatasheetMajorFamilies();\n    this.datasheetFamilies = DatasheetsService.getDatasheetFamilies();\n    this.propertyNames = DatasheetsService.getDatasheetPropertyNames();\n    this.resetNewFilterCondition();\n  }\n\n  resetNewFilterCondition() {\n    this.newFilterCondition = new FirebaseFilterCondition({\n      field: \"properties\",\n      fieldName: \"name\",\n      valueName: \"mgo\",\n      comparisonField: \"lower\",\n    });\n    this.validateProperty();\n  }\n\n  deleteCondition(index) {\n    this.filter.properties.splice(index, 1);\n    this.updateView = !this.updateView;\n  }\n\n  handleFilter(ev) {\n    this.filter[ev.detail.name] = ev.detail.value;\n  }\n\n  handleMajorFamilySelect(ev) {\n    this.filter.majorFamilyId = ev.detail.value;\n  }\n\n  handleFamilySelect(ev) {\n    this.filter.familyId = ev.detail.value;\n  }\n\n  segmentChanged(ev) {\n    if (ev.detail.value == \"base\") {\n      this.showBaseFilter = true;\n    } else {\n      this.showBaseFilter = false;\n    }\n  }\n\n  selectPropertyName(ev) {\n    this.newFilterCondition.valueName = ev.detail.value;\n    this.validateProperty();\n  }\n\n  selectOperator(ev) {\n    this.newFilterCondition.operator = ev.detail.value;\n    this.validateProperty();\n  }\n\n  selectValue(ev) {\n    this.newFilterCondition.value = ev.detail.value;\n    this.validateProperty();\n  }\n\n  addNewProperty() {\n    this.filter.properties.push(cloneDeep(this.newFilterCondition));\n    this.resetNewFilterCondition();\n  }\n\n  validateProperty() {\n    this.showAddNewProperty =\n      isString(this.newFilterCondition.field) &&\n      isString(this.newFilterCondition.fieldName) &&\n      isString(this.newFilterCondition.operator) &&\n      isString(this.newFilterCondition.valueName) &&\n      !isNull(this.newFilterCondition.value);\n  }\n\n  close() {\n    popoverController.dismiss();\n  }\n\n  save() {\n    popoverController.dismiss(this.filter);\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-header translucent>\n          <ion-toolbar>\n            <ion-title>Filter Datasheets</ion-title>\n          </ion-toolbar>\n        </ion-header>\n        <ion-content>\n          <ion-segment\n            mode=\"ios\"\n            color=\"trasteel\"\n            onIonChange={(ev) => this.segmentChanged(ev)}\n            value=\"base\"\n          >\n            <ion-segment-button value=\"base\">\n              <ion-label>Base</ion-label>\n            </ion-segment-button>\n            <ion-segment-button value=\"advanced\">\n              <ion-label>Advanced</ion-label>\n            </ion-segment-button>\n          </ion-segment>\n          <ion-list>\n            {this.showBaseFilter\n              ? [\n                  <ion-item>\n                    <ion-select\n                      color=\"trasteel\"\n                      interface=\"action-sheet\"\n                      label={TranslationService.getTransl(\n                        \"majorFamily\",\n                        \"Major Family\"\n                      )}\n                      label-placement=\"floating\"\n                      onIonChange={(ev) => this.handleMajorFamilySelect(ev)}\n                      value={this.filter.majorFamilyId}\n                    >\n                      {this.datasheetMajorFamilies.map((type) => (\n                        <ion-select-option value={type.majorFamilyId}>\n                          {type.majorFamilyName}\n                        </ion-select-option>\n                      ))}\n                    </ion-select>\n                  </ion-item>,\n                  <ion-item>\n                    <ion-select\n                      color=\"trasteel\"\n                      interface=\"action-sheet\"\n                      label={TranslationService.getTransl(\"family\", \"Family\")}\n                      label-placement=\"floating\"\n                      onIonChange={(ev) => this.handleFamilySelect(ev)}\n                      value={this.filter.familyId}\n                    >\n                      {this.datasheetFamilies.map((type) => (\n                        <ion-select-option value={type.familyId}>\n                          {type.familyName}\n                        </ion-select-option>\n                      ))}\n                    </ion-select>\n                  </ion-item>,\n                  <app-form-item\n                    label-text=\"Show Old Products\"\n                    value={this.filter.oldProduct}\n                    name=\"oldProduct\"\n                    input-type=\"boolean\"\n                    onFormItemChanged={(ev) => this.handleFilter(ev)}\n                  ></app-form-item>,\n                ]\n              : [\n                  <ion-grid>\n                    <ion-row>\n                      <ion-col>\n                        <app-select-search\n                          color=\"trasteel\"\n                          value={this.newFilterCondition.valueName}\n                          lines=\"none\"\n                          disabled={this.propertyNames.length == 0}\n                          selectFn={(ev) => this.selectPropertyName(ev)}\n                          selectOptions={this.propertyNames}\n                          selectValueId=\"nameId\"\n                          selectValueText={[\"nameName\"]}\n                        ></app-select-search>\n                      </ion-col>\n                      <ion-col size=\"3\">\n                        <ion-item lines=\"none\">\n                          <ion-select\n                            color=\"trasteel\"\n                            interface=\"action-sheet\"\n                            onIonChange={(ev) => this.selectOperator(ev)}\n                            value={this.newFilterCondition.operator}\n                          >\n                            <ion-select-option value={\">=\"}>\n                              <ion-label>{\">=\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\">\"}>\n                              <ion-label>{\">\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\"=\"}>\n                              <ion-label>{\"=\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\"<\"}>\n                              <ion-label>{\"<\"}</ion-label>\n                            </ion-select-option>\n                            <ion-select-option value={\"<=\"}>\n                              <ion-label>{\"<=\"}</ion-label>\n                            </ion-select-option>\n                          </ion-select>\n                        </ion-item>\n                      </ion-col>\n                    </ion-row>\n                    <ion-row>\n                      <ion-col>\n                        <app-form-item\n                          value={this.newFilterCondition.value}\n                          name=\"typical\"\n                          input-type=\"number\"\n                          onFormItemChanged={(ev) => this.selectValue(ev)}\n                        ></app-form-item>\n                      </ion-col>\n\n                      <ion-col size=\"3\">\n                        <ion-button\n                          icon-only\n                          fill=\"outline\"\n                          onClick={() => this.addNewProperty()}\n                          disabled={!this.showAddNewProperty}\n                        >\n                          <ion-icon name=\"add\" color=\"primary\"></ion-icon>\n                        </ion-button>\n                      </ion-col>\n                    </ion-row>\n                  </ion-grid>,\n                  <ion-item-divider>\n                    <ion-label>Conditions</ion-label>\n                  </ion-item-divider>,\n                  this.filter.properties.map((property, index) => (\n                    <ion-item>\n                      <ion-label>\n                        {DatasheetsService.getDatasheetPropertyNames(\n                          \"id\",\n                          property.valueName\n                        )[0].nameName +\n                          \" \" +\n                          property.operator +\n                          \" \" +\n                          property.value}\n                      </ion-label>\n                      <ion-button\n                        icon-only\n                        fill=\"clear\"\n                        onClick={() => this.deleteCondition(index)}\n                      >\n                        <ion-icon name=\"trash\" color=\"danger\"></ion-icon>\n                      </ion-button>\n                    </ion-item>\n                  )),\n                ]}\n          </ion-list>\n        </ion-content>\n        <ion-footer>\n          <app-modal-footer\n            saveTag={{tag: \"filter\", text: \"Filter\"}}\n            onCancelEmit={() => this.close()}\n            onSaveEmit={() => this.save()}\n          />\n        </ion-footer>\n      </Host>\n    );\n  }\n}\n"],"version":3}