import{r as e,h as s,f as t}from"./p-cbe60c68.js";import{a6 as i,a7 as a,a4 as h,a8 as d,U as o}from"./p-364f0bff.js";import{l as n}from"./p-1af05547.js";import{E as r}from"./p-be6a132e.js";import{S as c}from"./p-a75993af.js";import"./p-66796388.js";import"./p-e9c4f463.js";import"./p-c7ee7cfe.js";import"./p-5d4a8e1f.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-7ee16e8d.js";const l="modal-dive-planner ion-segment-button{--color-checked:var(--ion-color-planner-contrast)}modal-dive-planner .nopaddingtop{padding-top:0px !important}";const p=l;const f=class{constructor(s){e(this,s);this.dive=new i;this.dive_less_time=new i;this.dive_more_time=new i;this.dive_less_depth=new i;this.dive_more_depth=new i;this.selectedChartModel="BUHL";this.selectedModelGasView="BUHL";this.isSaving=false;this.showLoadingTab=true;this.slider=undefined;this.stdConfigurations=[];this.index=0;this.userRoles=undefined;this.selectedConfiguration=undefined;this.diveTripData=undefined;this.divePlanModel=undefined;this.addDive=false;this.showDiveSite=false;this.showPositionTab=false;this.setDate=false;this.updateView=true;this.segment="plan";this.showProfiles=false;this.titles=[{tag:"plan",icon:"chevron-forward",slotIcon:"end"},{tag:"profile",disabled:true,icon:"chevron-forward",slotIcon:"end"},{tag:"gas",disabled:true,icon:"chevron-forward",slotIcon:"end"},{tag:"charts",disabled:true,icon:"chevron-forward",slotIcon:"end"},{tag:"settings",disabled:true}]}componentWillLoad(){this.divePlan=new a;let e=this.divePlanModel;if(!e){let e=this.selectedConfiguration;this.divePlan.setConfiguration(e);let s=this.divePlan.addDive();this.divePlan.resetDiveWithConfiguration(s,e);if(this.diveTripData){this.divePlan.dives[0].diveSiteId=this.diveTripData.diveSiteId?this.diveTripData.diveSiteId:null;this.divePlan.dives[0].divingCenterId=this.diveTripData.divingCenterId?this.diveTripData.divingCenterId:null;this.divePlan.dives[0].date=this.diveTripData.date?new Date(this.diveTripData.date):new Date}}else{this.divePlan.setConfiguration(e.configuration);this.divePlan.setWithDivePlanModel(e);if(this.addDive){let s=this.divePlan.addDive();this.divePlan.resetDiveWithConfiguration(s,e.configuration);this.index=this.divePlan.dives.length-1;if(this.index>0){this.divePlan.dives[this.index].diveSiteId=this.divePlan.dives[this.index-1].diveSiteId}}}if(this.setDate){this.divePlan.dives[this.index].date=new Date}this.stdGases=[];this.stdDecoGases=[];let s=[];h.getStdGases().forEach((e=>{s.push(e)}));this.stdGases=n.exports.filter(s,{deco:false});this.stdGases=n.exports.orderBy(this.stdGases,"fromDepth","asc");this.stdDecoGases=n.exports.filter(s,{deco:true});this.stdDecoGases=n.exports.orderBy(this.stdDecoGases,"fromDepth","desc");this.update();this.showLoadingTab=false}componentDidLoad(){this.slider=new c(".slider-dive-planner",{speed:400,spaceBetween:100,allowTouchMove:false,autoHeight:true});this.update()}setSliderHeight(){const e=Array.from(this.el.getElementsByClassName("slide-container"));e.map((e=>{e.setAttribute("style","height: "+d(null,3,true)+"px")}));this.slider?this.slider.updateAutoHeight():null;this.slider?this.slider.update():undefined}saveDoc(e=true){if(e)this.update()}updateParams(e){this.divePlan.setParams(e.detail,false);this.update()}async update(){this.divePlan.updateCalculations();this.dives=this.divePlan.dives;this.dive=this.divePlan.dives[this.index];this.selectedChartModel=this.dive.selectedModel;this.selectedModelGasView=this.dive.selectedModel;this.diveDataToShare={divePlan:this.divePlan,dive_less_time:this.dive_less_time,dive_more_time:this.dive_more_time,dive_less_depth:this.dive_less_depth,dive_more_depth:this.dive_more_depth,index:this.index,stdGases:this.stdGases,stdDecoGases:this.stdDecoGases,stdConfigurations:this.stdConfigurations,user:this.userRoles,showDiveSite:this.showDiveSite,showPositionTab:this.showPositionTab};if(this.dive.getDecoTime()>o.userRoles.licences.getUserLimitations().maxDecoTime){this.showProfiles=false;o.userRoles.licences.presentLicenceLimitation("decotime")}else{this.showProfiles=true}this.titles[1].disabled=!this.showProfiles;this.titles[2].disabled=!this.showProfiles;this.titles[3].disabled=!this.showProfiles;this.titles[4].disabled=!this.showProfiles;this.updateView=!this.updateView;this.setSliderHeight()}save(){this.el.closest("ion-modal").dismiss(this.divePlan.getDivePlanModel())}close(){this.el.closest("ion-modal").dismiss()}scrollToTop(){this.content?this.content.scrollToTop():undefined}logScrollStart(e){this.content=e.srcElement}render(){return[s("ion-header",{key:"beea4b5bdafd9ec2f2b6b6cb4dbc3266e1e7ac4b"},s("app-navbar",{key:"a5273f83423958339664ae92ec81381135a7004a",tag:"deco-planner",text:"Deco Planner","extra-title":this.divePlan.configuration.stdName,color:r.isDecoplanner()?"gue-blue":"planner",modal:true}),s("app-header-segment-toolbar",{key:"74522ae2c20d6c7429e0c3c5712837dabf904722",color:r.isDecoplanner()?"gue-blue":"planner",swiper:this.slider,titles:this.titles,noHeader:true,class:"nopaddingtop"})),s("ion-content",{key:"689d5799b6f8573cdb722eb5791a9b1df6cae319",class:"slides",scrollEvents:true,onIonScrollStart:e=>this.logScrollStart(e)},s("swiper-container",{key:"b46775216b3a46fcc581231d3ed17eab6c4d7488",class:"slider-dive-planner swiper"},s("swiper-wrapper",{key:"7d6bb6d607c7ae7d713e7e62d363c0995bb5fcf7",class:"swiper-wrapper"},s("swiper-slide",{key:"d24b14326775a7e2640fde78681e2fbea288909a",class:"swiper-slide"},s("app-decoplanner-plan",{key:"19f9bb32748c717ed07ec7fe1d14cc0e1dc5aef9",diveDataToShare:this.diveDataToShare,onUpdateParamsEvent:e=>this.updateParams(e)})),s("swiper-slide",{key:"519d3e4d151d35eb41cf28404771f126b11398e8",class:"swiper-slide"},s("app-decoplanner-profile",{key:"0917fcd468b4c386aae49e83466c727b27ed74d5",diveDataToShare:this.diveDataToShare})),s("swiper-slide",{key:"467d5f989af983d7cffd407dca98e6d241b30f49",class:"swiper-slide"},s("app-decoplanner-gas",{key:"abceaea4e4a163f5e99b1c2493a78dd5573c4bd0",diveDataToShare:this.diveDataToShare,isShown:this.segment=="gas"})),s("swiper-slide",{key:"a3771ff97aa43ab4a03473effed61d70494a22aa",class:"swiper-slide"},s("ion-content",{key:"6f7b686fb78fa9437dfba4f48a68ff1cd56c6436",class:"slide-container"},s("app-decoplanner-charts",{key:"af7f8897aa3dfca4f5d8b8ed3f52279ca2331212",diveDataToShare:this.diveDataToShare,isShown:this.segment=="charts"}))),s("swiper-slide",{key:"59d7d6e2efed60f287a5de35c97af9405abb7536",class:"swiper-slide"},s("app-decoplanner-settings",{key:"4ad13415f3225ea6ce9b4d28261474e211ec0434",diveDataToShare:this.diveDataToShare,onUpdateParamsEvent:e=>this.updateParams(e)}))))),s("app-modal-footer",{key:"4d0b2db5286dfe0422a04ccdc0173874dd0d4e70",onCancelEmit:()=>this.close(),onSaveEmit:()=>this.save()})]}get el(){return t(this)}};f.style=p;export{f as modal_dive_planner};
//# sourceMappingURL=p-b2fa44fe.entry.js.map