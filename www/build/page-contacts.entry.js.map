{"file":"page-contacts.entry.esm.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,eAAe,GAAG,iBAAiB;;MCe5B,YAAY;;;QACvB,iBAAY,GAAqB,EAAE,CAAC;oCACc,EAAE;uBACjC,IAAI;;IAEvB,iBAAiB;QACf,eAAe,CAAC,aAAa,CAAC,SAAS,CAAC,OAAO,IAAsB;;YAEnE,MAAM,aAAa,GAAG,EAAE,CAAC;YACzB,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI;gBACZ,MAAM,OAAO,GAAGA,wBAAS,CAAC,IAAI,CAAC,CAAC;gBAChC,MAAM,QAAQ,GAAG,gBAAgB,CAAC,mBAAmB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;gBACvE,IAAI,QAAQ,EAAE;oBACZ,OAAO,CAAC,UAAU,GAAG,QAAQ,CAAC,QAAQ,CAAC;oBACvC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;iBAC7B;aACF,CAAC,CAAC;YACH,IAAI,CAAC,YAAY,GAAG,aAAa,CAAC;YAClC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;SACtB,CAAC,CAAC;KACJ;IAED,gBAAgB,MAAK;IAErB,UAAU;QACR,eAAe,CAAC,oBAAoB,EAAE,CAAC;KACxC;IAED,MAAM;QACJ,OAAO;YACL,qEACE,mEACE,GAAG,EAAC,UAAU,EACd,IAAI,EAAC,UAAU,EACf,KAAK,EAAC,UAAU,GACJ,EACd,2EACE,WAAW,EAAC,UAAU,EACtB,IAAI,EAAE,IAAI,CAAC,YAAY,EACvB,WAAW,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC,EACtC,KAAK,EAAC,UAAU,EAChB,WAAW,EAAC,gBAAgB,EAC5B,QAAQ,EAAE,CAAC,UAAU,EAAE,WAAW,EAAE,YAAY,CAAC,EACjD,cAAc,EAAE,CAAC,EAAE,MAAM,IAAI,CAAC,oBAAoB,GAAG,EAAE,CAAC,MAAM,CAAC,GAC3C,CACX;YACb,sEACG,eAAe,CAAC,iBAAiB,EAAE,IAClC,eAAS,QAAQ,EAAC,KAAK,EAAC,UAAU,EAAC,KAAK,EAAC,IAAI,EAAC,OAAO,EAAC,IAAI,UACxD,sBAAgB,OAAO,EAAE,MAAM,IAAI,CAAC,UAAU,EAAE,EAAE,KAAK,EAAC,UAAU,IAChE,gBAAU,IAAI,EAAC,KAAK,GAAY,CACjB,CACT,IACR,SAAS,EACb,4EACE,IAAI,EAAE,IAAI,CAAC,oBAAoB,EAC/B,OAAO,EAAE,IAAI,CAAC,OAAO,EACrB,UAAU,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC,EACrC,WAAW,EAAC,IAAI,EAChB,OAAO,EAAE,CAAC,YAAY,CAAC,EACvB,IAAI,EAAE,qBAAqB,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC,IAAI,CAAC,IAAI,EACpE,aAAa,EAAE,CAAC,EAAE,KAChB,eAAe,CAAC,qBAAqB,CAAC,EAAE,CAAC,MAAM,CAAC,GAE7B,CACX;SACf,CAAC;KACH;;;;;;","names":["cloneDeep"],"sources":["src/components/trasteel/pages/crm/page-contacts/page-contacts.scss?tag=page-contacts","src/components/trasteel/pages/crm/page-contacts/page-contacts.tsx"],"sourcesContent":["page-contacts {\n  /* Component styles go here */\n}\n","import {Component, State, h} from \"@stencil/core\";\nimport {MapDataContact} from \"../../../../../interfaces/trasteel/contact/contact\";\nimport {\n  CONTACTSCOLLECTION,\n  ContactsService,\n} from \"../../../../../services/trasteel/crm/contacts\";\nimport {TrasteelFilterService} from \"../../../../../services/trasteel/common/trs-db-filter\";\nimport {CustomersService} from \"../../../../../services/trasteel/crm/customers\";\nimport {cloneDeep} from \"lodash\";\nimport {TrasteelService} from \"../../../../../services/trasteel/common/services\";\n\n@Component({\n  tag: \"page-contacts\",\n  styleUrl: \"page-contacts.scss\",\n})\nexport class PageContacts {\n  contactsList: MapDataContact[] = [];\n  @State() filteredContactsList: MapDataContact[] = [];\n  @State() loading = true;\n\n  componentWillLoad() {\n    ContactsService.contactsList$.subscribe(async (list: MapDataContact[]) => {\n      //replace name of customers\n      const customersList = [];\n      list.map((item) => {\n        const newItem = cloneDeep(item);\n        const customer = CustomersService.getCustomersDetails(item.customerId);\n        if (customer) {\n          newItem.customerId = customer.fullName;\n          customersList.push(newItem);\n        }\n      });\n      this.contactsList = customersList;\n      this.loading = false;\n    });\n  }\n\n  componentDidLoad() {}\n\n  addContact() {\n    ContactsService.presentContactUpdate();\n  }\n\n  render() {\n    return [\n      <ion-header>\n        <app-navbar\n          tag=\"contacts\"\n          text=\"Contacts\"\n          color=\"trasteel\"\n        ></app-navbar>\n        <app-search-toolbar\n          searchTitle=\"contacts\"\n          list={this.contactsList}\n          orderFields={[\"lastName\", \"firstName\"]}\n          color=\"trasteel\"\n          placeholder=\"Search by name\"\n          filterBy={[\"lastName\", \"firstName\", \"customerId\"]}\n          onFilteredList={(ev) => (this.filteredContactsList = ev.detail)}\n        ></app-search-toolbar>\n      </ion-header>,\n      <ion-content>\n        {TrasteelService.isCustomerDBAdmin() ? (\n          <ion-fab vertical=\"top\" horizontal=\"end\" slot=\"fixed\" edge>\n            <ion-fab-button onClick={() => this.addContact()} color=\"trasteel\">\n              <ion-icon name=\"add\"></ion-icon>\n            </ion-fab-button>\n          </ion-fab>\n        ) : undefined}\n        <app-infinite-scroll\n          list={this.filteredContactsList}\n          loading={this.loading}\n          showFields={[\"lastName\", \"firstName\"]}\n          returnField=\"id\"\n          groupBy={[\"customerId\"]}\n          icon={TrasteelFilterService.getMapDocs(CONTACTSCOLLECTION).icon.name}\n          onItemClicked={(ev) =>\n            ContactsService.presentContactDetails(ev.detail)\n          }\n        ></app-infinite-scroll>\n      </ion-content>,\n    ];\n  }\n}\n"],"version":3}