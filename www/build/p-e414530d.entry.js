import{r as e,h as i}from"./p-cbe60c68.js";import"./p-c7ee7cfe.js";import{n as s}from"./p-5d4a8e1f.js";import{E as t}from"./p-46038295.js";import{v as o,T as c}from"./p-83f44900.js";import"./p-3647f076.js";import"./p-9c77ce6f.js";import"./p-694b8ade.js";import"./p-ae1763fb.js";import"./p-c5936999.js";import"./p-6879854f.js";import"./p-1819cfda.js";import"./p-1af05547.js";import"./p-e9c4f463.js";import"./p-7ee16e8d.js";const a="";const d=a;const l=class{constructor(i){e(this,i);this.inProgress={};this.urls={};this.files=undefined;this.collectionId=undefined;this.itemId=undefined;this.updateView=false}uploadProgressHandler(e){const i=e.detail;if(i.state==="completed"){this.urls[this.uploadingId]=i.url;let e=true;Object.keys(this.inProgress).forEach((i=>{e=e&&this.inProgress[i].uploadProgress===100}));this.updateView=!this.updateView;if(e){s.dismiss(this.urls)}else{this.uploadMedia()}}else if(i.state==="error"){s.dismiss(false)}else{this.inProgress[this.uploadingId].uploadProgress=i.progress;this.updateView=!this.updateView}}componentDidLoad(){this.inProgress={};Object.keys(this.files).forEach((e=>{this.inProgress[e]={size:this.files[e].file.size,uploadProgress:0}}));this.uploadMedia()}async cancel(){s.dismiss(false)}uploadMedia(){let e=null;Object.keys(this.inProgress).forEach((i=>{if(this.inProgress[i].uploadProgress==0){e=i;return}}));this.uploadingId=e;const i=this.files[e].file;const s=this.files[e].media;o.uploadFile(this.collectionId,this.itemId,s,i)}render(){return[i("ion-header",{key:"556c0ad119bb89ce38f2590708bc4f354562f722"},i("ion-toolbar",{key:"c3def15671d32614439a4f59d3e83983463ec077",color:t.getAppColor()},i("ion-title",{key:"1fbbcc93ff5498c9152084f7d0d1bba14b923035"},c.getTransl("media-uploader","Media Uploader")))),i("ion-content",{key:"fbe89d377a42ca9031832f715ca26cdfaf2f69ed"},i("ion-list",{key:"c8ab66b5bb22e6857b92d8358f46bc957e759cc2"},Object.keys(this.files).map((e=>[i("ion-item",null,i("ion-label",null,i("h4",null,this.files[e].media.title),this.inProgress&&this.inProgress[e]?[i("h5",null,c.getTransl("file-size","File Size"),": ",this.inProgress[e].size),i("p",null,c.getTransl("uploaded","Uploaded"),":"," ",this.inProgress[e].uploadProgress,"%")]:undefined)),this.inProgress&&this.inProgress[e]?i("ion-progress-bar",{value:this.inProgress[e].uploadProgress}):undefined]))),i("ion-button",{key:"dadadf4f9c206e4514f300dd098cc1f9c0330e6e",expand:"block",fill:"outline",onClick:()=>this.cancel()},i("ion-label",{key:"9e176d74958a9af797ba87c97e6edc8255db9131"},c.getTransl("cancel","Cancel"))))]}};l.style=d;export{l as popover_media_uploader};
//# sourceMappingURL=p-e414530d.entry.js.map