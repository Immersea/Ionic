{"file":"app-dive-trip-bookings.entry.esm.js","mappings":"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","names":["orderBy","toNumber","isNumber","format"],"sources":["src/components/udive/app/dive-trips/app-dive-trip-bookings/app-dive-trip-bookings.scss?tag=app-dive-trip-bookings","src/components/udive/app/dive-trips/app-dive-trip-bookings/app-dive-trip-bookings.tsx"],"sourcesContent":["app-dive-trip-bookings {\n  /* Component styles go here */\n  width: 100%;\n  height: 100%;\n}\n","import {Component, h, Prop, State, Element} from \"@stencil/core\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\nimport {\n  TripDive,\n  TeamMember,\n  DiveTrip,\n} from \"../../../../../interfaces/udive/dive-trip/diveTrip\";\nimport {isNumber, orderBy, toNumber} from \"lodash\";\nimport {UserService} from \"../../../../../services/common/user\";\nimport {DiveTripsService} from \"../../../../../services/udive/diveTrips\";\nimport {Subscription} from \"rxjs\";\nimport {format} from \"date-fns\";\nimport {Environment} from \"../../../../../global/env\";\n\n@Component({\n  tag: \"app-dive-trip-bookings\",\n  styleUrl: \"app-dive-trip-bookings.scss\",\n})\nexport class AppDiveTripBookings {\n  @Element() el: HTMLElement;\n  @Prop() diveTrip: DiveTrip;\n  @Prop() diveTripId: string;\n  @Prop() tripDiveIndex: number;\n  @Prop() editable = false;\n  @State() isEditing = false;\n  @State() segment: number = 0;\n  @State() tripDive: TripDive;\n  @State() bookingsList: any[];\n  availableSpots = [];\n  @State() waitingRequest = false;\n  @State() updateView = false;\n  segmentTitles: {\n    notinterested: string;\n    interested: string;\n    attend: string;\n  };\n  @State() userBooking: TeamMember;\n  userSub: Subscription;\n  userId: string;\n  usersList: any[];\n  loogBookButton: boolean;\n\n  componentWillLoad() {\n    this.tripDive = this.diveTrip.tripDives[this.tripDiveIndex];\n    this.userSub = UserService.userProfile$.subscribe((user) => {\n      this.userId = user && user.uid ? user.uid : null;\n      this.updateBookingsList();\n    });\n    this.userId =\n      UserService.userProfile && UserService.userProfile.uid\n        ? UserService.userProfile.uid\n        : null;\n    this.updateBookingsList();\n    this.segmentTitles = {\n      notinterested: TranslationService.getTransl(\n        \"not-interested\",\n        \"Not Interested\"\n      ),\n      interested: TranslationService.getTransl(\"interested\", \"Interested\"),\n      attend: TranslationService.getTransl(\"attend\", \"Attend\"),\n    };\n  }\n\n  disconnectedCallback() {\n    this.userSub.unsubscribe();\n  }\n\n  async updateBookingsList() {\n    this.bookingsList = [];\n    this.availableSpots = [];\n    this.usersList = [];\n    let bookings = orderBy(this.tripDive.bookings, [\"team\"]);\n\n    //reset team numbers starting from 0\n    let teamCount = 0;\n    let currentTeam = bookings[0] && bookings[0].team ? bookings[0].team : 0; //normally 0 - if >0 then bring it back to 0\n    bookings.map((booking) => {\n      if (booking.team > currentTeam) {\n        teamCount++;\n        currentTeam = booking.team;\n      }\n      booking.team = teamCount;\n    });\n    //reset bookings\n    this.tripDive.bookings = bookings;\n\n    currentTeam = -1;\n    console.log(\"this.tripDive\", this.tripDive);\n    for (let booking of bookings) {\n      if (booking.team > currentTeam) {\n        this.bookingsList.push(booking.team);\n        currentTeam = booking.team;\n      }\n      let listItem = {\n        ...booking,\n        user: await UserService.getMapDataUserDetails(booking.uid),\n      };\n      this.bookingsList.push(listItem);\n      if (this.userId && booking.uid === this.userId) {\n        this.userBooking = booking;\n      }\n    }\n    let confirmedBookings = 0;\n    this.tripDive.bookings.map((booking) => {\n      if (booking.confirmedOrganiser) {\n        confirmedBookings++;\n      }\n    });\n    for (\n      let index = 0;\n      index < this.tripDive.numberOfParticipants - confirmedBookings;\n      index++\n    ) {\n      this.availableSpots.push(0);\n    }\n    this.updateView = !this.updateView;\n  }\n  segmentChanged(ev) {\n    if (ev.detail.value) {\n      this.segment = toNumber(ev.detail.value);\n    }\n  }\n\n  async addBooking(ev) {\n    const confirmedUser =\n      ev.detail.value == \"true\"\n        ? true\n        : ev.detail.value == \"false\"\n          ? false\n          : null;\n    let booking: TeamMember = this.userBooking\n      ? this.userBooking\n      : {\n          role: \"diver\",\n          team: 0,\n          uid: this.userId,\n          confirmedUser: confirmedUser,\n          confirmedOrganiser: false,\n        };\n    try {\n      this.waitingRequest = true;\n      const bookings = await DiveTripsService.sendBookingRequest(\n        this.diveTripId,\n        this.tripDiveIndex,\n        booking.role,\n        booking.team,\n        booking.uid,\n        confirmedUser,\n        booking.confirmedOrganiser\n      );\n      this.waitingRequest = false;\n      this.tripDive.bookings = bookings;\n      this.updateBookingsList();\n    } catch (error) {\n      this.waitingRequest = false;\n    }\n  }\n\n  updateBooking(i, ev) {\n    const search = this.bookingsList[i];\n    const item = this.tripDive.bookings.find(\n      (booking) => booking.uid === search.uid\n    );\n    item.confirmedOrganiser =\n      ev.detail.value == \"true\"\n        ? true\n        : ev.detail.value == \"false\"\n          ? false\n          : null;\n  }\n\n  editBookings() {\n    this.isEditing = true;\n  }\n\n  saveBookings() {\n    this.isEditing = false;\n    this.updateBookingsList();\n  }\n\n  addTeam() {\n    //count number of teams\n    let teams = 0;\n    this.bookingsList.map((booking) => {\n      if (isNumber(booking)) teams = booking;\n    });\n    this.bookingsList.push(teams + 1);\n    this.updateView = !this.updateView;\n  }\n\n  reorderTeams(ev) {\n    const from = ev.detail.from; //starting position\n    const to = ev.detail.to; //end position\n    //find original item\n    const search = this.bookingsList[from];\n    const item = this.tripDive.bookings.find(\n      (booking) => booking.uid === search.uid\n    );\n    //find new position on bookingsList\n    let found = false;\n    let team = 0;\n    this.bookingsList.map((booking, i) => {\n      //set current team number\n      if (isNumber(booking)) team = booking;\n      if (to <= i && !found) {\n        item.team = team;\n        found = true;\n      }\n    });\n    this.bookingsList = ev.detail.complete(this.bookingsList);\n  }\n\n  render() {\n    return (\n      <ion-card>\n        <ion-card-header>\n          <ion-card-title>\n            <ion-item class=\"ion-no-padding\" lines=\"none\">\n              <ion-label>\n                {format(this.tripDive.divePlan.dives[0].date, \"PP\")}\n              </ion-label>\n            </ion-item>\n          </ion-card-title>\n          <ion-card-subtitle>\n            <ion-item class=\"ion-no-padding\" lines=\"none\">\n              <ion-label>\n                {this.tripDive.divePlan.title +\n                  \" -> \" +\n                  TranslationService.getTransl(\n                    \"max-participants\",\n                    \"Max xxx participants\",\n                    {xxx: this.tripDive.numberOfParticipants}\n                  )}\n              </ion-label>\n              {this.editable &&\n              this.tripDive.bookings &&\n              this.tripDive.bookings.length > 0 ? (\n                !this.isEditing ? (\n                  <ion-button slot=\"end\" onClick={() => this.editBookings()}>\n                    <my-transl tag=\"edit\" text=\"Edit\" />\n                  </ion-button>\n                ) : (\n                  [\n                    <ion-button slot=\"end\" onClick={() => this.addTeam()}>\n                      <my-transl tag=\"add-team\" text=\"Add Team\" />\n                    </ion-button>,\n                    <ion-button slot=\"end\" onClick={() => this.saveBookings()}>\n                      <my-transl tag=\"save\" text=\"Save\" />\n                    </ion-button>,\n                  ]\n                )\n              ) : undefined}\n            </ion-item>\n          </ion-card-subtitle>\n        </ion-card-header>\n        <ion-card-content>\n          {!this.editable ? (\n            <ion-segment\n              mode=\"ios\"\n              color={Environment.getAppColor()}\n              disabled={this.waitingRequest}\n              onIonChange={(ev) => this.addBooking(ev)}\n              value={\n                this.userBooking\n                  ? this.userBooking.confirmedUser.toString()\n                  : \"\"\n              }\n            >\n              <ion-segment-button value=\"\" layout=\"icon-start\">\n                <ion-icon name=\"close-outline\"></ion-icon>\n                <ion-label>{this.segmentTitles.notinterested}</ion-label>\n              </ion-segment-button>\n              <ion-segment-button value=\"false\" layout=\"icon-start\">\n                <ion-icon name=\"help-outline\"></ion-icon>\n                <ion-label>{this.segmentTitles.interested}</ion-label>\n              </ion-segment-button>\n              <ion-segment-button value=\"true\" layout=\"icon-start\">\n                <ion-icon name=\"checkmark-outline\"></ion-icon>\n                <ion-label>{this.segmentTitles.attend}</ion-label>\n              </ion-segment-button>\n            </ion-segment>\n          ) : undefined}\n\n          <ion-list>\n            <ion-reorder-group\n              disabled={!this.isEditing}\n              onIonItemReorder={(ev) => this.reorderTeams(ev)}\n            >\n              {this.waitingRequest && !this.userBooking ? (\n                <app-skeletons skeleton=\"diveTripBooking\" />\n              ) : undefined}\n              {this.bookingsList.map((booking, k) =>\n                isNumber(booking) ? (\n                  <ion-item-divider>\n                    <ion-label>Team {booking + 1}</ion-label>\n                  </ion-item-divider>\n                ) : booking.uid == this.userId && this.waitingRequest ? (\n                  <app-skeletons skeleton=\"diveTripBooking\" />\n                ) : (\n                  <ion-item>\n                    {!this.isEditing && booking.user.photoURL ? (\n                      <ion-avatar slot=\"start\">\n                        <ion-img src={booking.user.photoURL} />\n                      </ion-avatar>\n                    ) : (\n                      <ion-reorder slot=\"start\"></ion-reorder>\n                    )}\n                    <ion-label>{booking.user.displayName}</ion-label>\n                    {booking.confirmedUser ? (\n                      <ion-icon\n                        slot=\"end\"\n                        color=\"success\"\n                        name=\"checkmark-outline\"\n                      ></ion-icon>\n                    ) : (\n                      <ion-icon\n                        slot=\"end\"\n                        color=\"warning\"\n                        name=\"help-outline\"\n                      ></ion-icon>\n                    )}\n                    {!this.isEditing ? (\n                      booking.confirmedOrganiser ? (\n                        <ion-icon\n                          slot=\"end\"\n                          color=\"success\"\n                          name=\"checkmark-outline\"\n                        ></ion-icon>\n                      ) : (\n                        <ion-icon\n                          slot=\"end\"\n                          color=\"warning\"\n                          name=\"help-outline\"\n                        ></ion-icon>\n                      )\n                    ) : (\n                      <ion-segment\n                        style={{\n                          maxWidth: \"40%\",\n                          marginLeft: \"15%\",\n                        }}\n                        slot=\"end\"\n                        mode=\"ios\"\n                        color={Environment.getAppColor()}\n                        onIonChange={(ev) => this.updateBooking(k, ev)}\n                        value={booking.confirmedOrganiser.toString()}\n                      >\n                        <ion-segment-button value=\"\">\n                          <ion-icon\n                            color=\"danger\"\n                            name=\"close-outline\"\n                          ></ion-icon>\n                        </ion-segment-button>\n                        <ion-segment-button value=\"false\">\n                          <ion-icon\n                            color=\"warning\"\n                            name=\"help-outline\"\n                          ></ion-icon>\n                        </ion-segment-button>\n                        <ion-segment-button value=\"true\">\n                          <ion-icon\n                            color=\"success\"\n                            name=\"checkmark-outline\"\n                          ></ion-icon>\n                        </ion-segment-button>\n                      </ion-segment>\n                    )}\n                  </ion-item>\n                )\n              )}\n            </ion-reorder-group>\n            {this.availableSpots.map(() => (\n              <ion-item>\n                <ion-icon slot=\"start\" name=\"person-add-outline\"></ion-icon>\n                <ion-label>\n                  <my-transl tag=\"available\" text=\"Available\" />\n                </ion-label>\n              </ion-item>\n            ))}\n          </ion-list>\n        </ion-card-content>\n      </ion-card>\n    );\n  }\n}\n"],"version":3}