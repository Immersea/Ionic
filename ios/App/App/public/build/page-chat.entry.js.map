{"file":"page-chat.entry.esm.js","mappings":"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","names":[],"sources":["src/components/common/pages/chat/page-chat/page-chat.scss?tag=page-chat","src/components/common/pages/chat/page-chat/page-chat.tsx"],"sourcesContent":["page-chat {\n    /* Component styles go here */\n}\n","import {Component, h, Prop, State} from \"@stencil/core\";\nimport {RouterService} from \"../../../../../services/common/router\";\nimport {ChatService} from \"../../../../../services/common/chat\";\nimport {Subscription} from \"rxjs\";\nimport {Chat} from \"../../../../../interfaces/common/chat/chat\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\nimport {\n  DIVETRIPSCOLLECTION,\n  DiveTripsService,\n} from \"../../../../../services/udive/diveTrips\";\n\n@Component({\n  tag: \"page-chat\",\n  styleUrl: \"page-chat.scss\",\n})\nexport class PageChat {\n  @Prop() chatId: string;\n  @State() participants: number;\n  @State() chat: Chat;\n  @State() title: string;\n  @State() subtitle: string;\n  chatApp: any;\n  chatSub: Subscription;\n  @State() additionalDataItem: {\n    title: string;\n    onclick: any;\n  };\n\n  componentWillLoad() {\n    this.chatSub = ChatService.loadedChat$.subscribe((chat) => {\n      if (chat && chat.participants) {\n        this.chat = chat;\n        this.participants = Object.keys(chat.participants).length;\n        let otherParticipants = [];\n        Object.keys(this.chat.participants).map((partId) => {\n          if (partId !== ChatService.chatUser.id) {\n            otherParticipants.push(this.chat.participants[partId]);\n          }\n        });\n\n        if (this.chat.name && this.chat.name.length > 0) {\n          this.title = this.chat.name;\n          this.subtitle = ChatService.getOtherChatParticipants(\n            \"names\",\n            this.chat\n          );\n        } else {\n          this.title = ChatService.getOtherChatParticipants(\"names\", this.chat);\n          this.subtitle = null;\n        }\n        if (this.chat.additionalData) {\n          this.loadAdditionalDataItem();\n        }\n      }\n    });\n  }\n  componentDidLoad() {\n    this.chatApp = document.getElementsByTagName(\"app-chat\")[0];\n  }\n\n  disconnectedCallback() {\n    this.chatSub.unsubscribe();\n  }\n\n  async loadAdditionalDataItem() {\n    if (this.chat.additionalData.collectionId === DIVETRIPSCOLLECTION) {\n      this.additionalDataItem = {\n        title: TranslationService.getTransl(\"dive-trip\", \"Dive Trip\"),\n        onclick: DiveTripsService.pushDiveTrip,\n      };\n    }\n  }\n\n  showAdditionalDataItem() {}\n\n  addParticipant(ev) {\n    this.chatApp.addParticipants(ev);\n  }\n\n  render() {\n    return [\n      <ion-header>\n        <ion-toolbar color=\"chat\">\n          <ion-buttons slot=\"start\">\n            <ion-button onClick={() => RouterService.goBack()} icon-only>\n              <ion-icon name=\"arrow-back\"></ion-icon>\n            </ion-button>\n          </ion-buttons>\n          <ion-title>{this.title}</ion-title>\n          {this.subtitle ? (\n            <ion-title size=\"small\">{this.subtitle}</ion-title>\n          ) : undefined}\n          <ion-buttons slot=\"end\">\n            {this.additionalDataItem ? (\n              <ion-button\n                fill=\"outline\"\n                onClick={() =>\n                  this.additionalDataItem.onclick(this.chat.additionalData.id)\n                }\n              >\n                {this.additionalDataItem.title}\n                <ion-icon name=\"open-outline\" slot=\"start\"></ion-icon>\n              </ion-button>\n            ) : undefined}\n            <ion-button\n              icon-only\n              slot=\"end\"\n              onClick={(ev) => this.addParticipant(ev)}\n            >\n              <ion-icon name=\"people-outline\"></ion-icon>\n              {this.participants ? (\n                <ion-badge color=\"secondary\">{this.participants}</ion-badge>\n              ) : undefined}\n            </ion-button>\n          </ion-buttons>\n        </ion-toolbar>\n      </ion-header>,\n      <ion-content>\n        <app-chat chatId={this.chatId} />\n      </ion-content>,\n    ];\n  }\n}\n"],"version":3}