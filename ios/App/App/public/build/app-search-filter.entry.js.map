{"file":"app-search-filter.entry.esm.js","mappings":"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","names":[],"sources":["src/components/common/app/map/app-search-filter/app-search-filter.scss?tag=app-search-filter","src/components/common/app/map/app-search-filter/app-search-filter.tsx"],"sourcesContent":["app-search-filter {\n  padding: env(safe-area-inset-top) env(safe-area-inset-right)\n    env(safe-area-inset-bottom) env(safe-area-inset-left);\n  .search-tags {\n    position: absolute;\n    top: calc(env(safe-area-inset-top) + 88px);\n    right: 0px;\n    z-index: 2;\n  }\n}\n","import {\n  Component,\n  h,\n  Host,\n  Method,\n  State,\n  Event,\n  EventEmitter,\n  Prop,\n} from \"@stencil/core\";\nimport {SearchTag, CollectionGroup} from \"../../../../../interfaces/interfaces\";\nimport {UDiveFilterService} from \"../../../../../services/udive/ud-db-filter\";\nimport {UserService} from \"../../../../../services/common/user\";\nimport {Subscription} from \"rxjs\";\nimport {Environment} from \"../../../../../global/env\";\n\n@Component({\n  tag: \"app-search-filter\",\n  styleUrl: \"app-search-filter.scss\",\n})\nexport class AppSearchFilter {\n  @Event() searchFilterEmit: EventEmitter<SearchTag[]>;\n  tags: SearchTag[] = [];\n  @State() updateView = true;\n  @State() hideSearch = false;\n  userSub: Subscription;\n  @Prop() hideToolbar = false;\n  types = {\n    search: {\n      color: \"light\",\n      icon: \"search-circle\",\n    },\n    filter: {\n      color: \"primary\",\n      icon: \"filter\",\n    },\n  };\n  @State() filterButtonTypes: CollectionGroup;\n\n  componentWillLoad() {\n    this.userSub = UserService.userRoles$.subscribe(() => {\n      //update after user is loaded\n      this.filterButtonTypes = UDiveFilterService.getMapDocs();\n    });\n    this.filterButtonTypes = UDiveFilterService.getMapDocs();\n  }\n  disconnectedCallback() {\n    this.userSub.unsubscribe();\n    this.tags = [];\n    this.searchFilterEmit.emit(this.tags);\n  }\n\n  @Method()\n  async addTag(tag: SearchTag) {\n    this.tags.push(tag);\n    this.searchFilterEmit.emit(this.tags);\n    if (tag.type == \"search\") this.hideSearch = true;\n    this.updateView = !this.updateView;\n  }\n  @Method()\n  async removeTag(i) {\n    if (this.tags[i].type == \"search\") this.hideSearch = false;\n    this.tags.splice(i, 1);\n    this.searchFilterEmit.emit(this.tags);\n    this.updateView = !this.updateView;\n  }\n\n  searchInputChange(str) {\n    const search = {name: str, type: \"search\"};\n    //pass search value to search filter\n    this.addTag(search);\n  }\n\n  checkButtonEnabled(button) {\n    return this.tags.find((el) => el.name == button) != null;\n  }\n\n  async removeFilterTag(button) {\n    const index = this.tags.findIndex(\n      (el) => el.name == button && el.type == \"filter\"\n    );\n    this.tags.splice(index, 1);\n    this.searchFilterEmit.emit(this.tags);\n    this.updateView = !this.updateView;\n  }\n\n  render() {\n    return (\n      <Host>\n        {!this.hideToolbar ? (\n          <ion-toolbar color={Environment.getAppColor()}>\n            <ion-grid>\n              <ion-row class=\"ion-text-center\">\n                <ion-col size=\"1\">\n                  <ion-menu-button />\n                </ion-col>\n                <ion-col>\n                  <my-transl\n                    tag=\"looking-for\"\n                    text=\"What are you looking for?\"\n                  />\n                </ion-col>\n                <ion-col size=\"1\"></ion-col>\n              </ion-row>\n              <ion-row>\n                {Object.keys(this.filterButtonTypes).map((button) => (\n                  <ion-col class=\"ion-no-padding\">\n                    <ion-tab-button\n                      color={Environment.getAppColor()}\n                      layout=\"icon-bottom\"\n                      onClick={() =>\n                        !this.checkButtonEnabled(button)\n                          ? this.addTag({type: \"filter\", name: button})\n                          : this.removeFilterTag(button)\n                      }\n                    >\n                      {this.filterButtonTypes[button].icon.type == \"ionicon\" ? (\n                        <ion-icon\n                          name={this.filterButtonTypes[button].icon.name}\n                          color={this.filterButtonTypes[button].icon.color}\n                        ></ion-icon>\n                      ) : (\n                        <ion-icon\n                          class={\n                            \"map-icon \" +\n                            this.filterButtonTypes[button].icon.name\n                          }\n                          color={this.filterButtonTypes[button].icon.color}\n                        ></ion-icon>\n                      )}\n                      <ion-label\n                        color={this.filterButtonTypes[button].icon.color}\n                      >\n                        {this.filterButtonTypes[button].name}\n                      </ion-label>\n                    </ion-tab-button>\n                  </ion-col>\n                ))}\n              </ion-row>\n            </ion-grid>\n          </ion-toolbar>\n        ) : (\n          [\n            <ion-fab vertical=\"top\" horizontal=\"end\" slot=\"fixed\">\n              <ion-fab-button class=\"fab-icon\">\n                <ion-icon name=\"filter\"></ion-icon>\n              </ion-fab-button>\n              <ion-fab-list side=\"start\">\n                {Object.keys(this.filterButtonTypes).map((button) => (\n                  <ion-fab-button\n                    style={{\n                      \"--background\": this.filterButtonTypes[button].icon.color,\n                    }}\n                    onClick={() => this.addTag({type: \"filter\", name: button})}\n                    disabled={this.tags.find((el) => el.name == button) != null}\n                  >\n                    {this.filterButtonTypes[button].icon.type == \"ionicon\" ? (\n                      <ion-icon\n                        name={this.filterButtonTypes[button].icon.name}\n                      ></ion-icon>\n                    ) : (\n                      <ion-icon\n                        class={\n                          \"map-icon \" + this.filterButtonTypes[button].icon.name\n                        }\n                      ></ion-icon>\n                    )}\n                  </ion-fab-button>\n                ))}\n              </ion-fab-list>\n            </ion-fab>,\n          ]\n        )}\n        {!this.hideSearch ? (\n          <app-searchbar\n            floating\n            onInputChanged={(ev) => this.searchInputChange(ev.detail)}\n          />\n        ) : undefined}\n\n        <div class=\"search-tags\">\n          <ion-grid class=\"ion-no-padding ion-no-margin ion-text-end\">\n            {this.tags.map((tag, i) => (\n              <ion-row>\n                <ion-col>\n                  <ion-chip\n                    outline={true}\n                    style={{\n                      background:\n                        tag.type == \"filter\"\n                          ? \"rgba(var(--ion-color-\" +\n                            this.filterButtonTypes[tag.name].icon.color +\n                            \"-contrast-rgb),0.3)\"\n                          : \"#00000050\",\n                    }}\n                    color={\n                      tag.type == \"filter\"\n                        ? this.filterButtonTypes[tag.name].icon.color\n                        : \"light\"\n                    }\n                  >\n                    {tag.type == \"search\" ? (\n                      <ion-icon name={this.types[tag.type].icon}></ion-icon>\n                    ) : this.filterButtonTypes[tag.name].icon.type ==\n                      \"ionicon\" ? (\n                      <ion-icon\n                        color={this.filterButtonTypes[tag.name].icon.color}\n                        name={this.filterButtonTypes[tag.name].icon.name}\n                      ></ion-icon>\n                    ) : (\n                      <ion-icon\n                        color={this.filterButtonTypes[tag.name].icon.color}\n                        class={\n                          \"map-icon \" +\n                          this.filterButtonTypes[tag.name].icon.name\n                        }\n                      ></ion-icon>\n                    )}\n                    <ion-label>\n                      {tag.type == \"search\"\n                        ? tag.name\n                        : this.filterButtonTypes[tag.name].name}\n                    </ion-label>\n                    <ion-icon\n                      name=\"close-circle\"\n                      color={\n                        tag.type == \"filter\"\n                          ? this.filterButtonTypes[tag.name].icon.color\n                          : \"light\"\n                      }\n                      onClick={() => this.removeTag(i)}\n                    ></ion-icon>\n                  </ion-chip>\n                </ion-col>\n              </ion-row>\n            ))}\n          </ion-grid>\n        </div>\n      </Host>\n    );\n  }\n}\n"],"version":3}