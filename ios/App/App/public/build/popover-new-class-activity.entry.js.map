{"file":"popover-new-class-activity.entry.esm.js","mappings":"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","names":["cloneDeep","isNumber","isString","forEach"],"sources":["src/components/udive/popovers/popover-new-class-activity/popover-new-class-activity.scss?tag=popover-new-class-activity","src/components/udive/popovers/popover-new-class-activity/popover-new-class-activity.tsx"],"sourcesContent":["popover-new-class-activity {\n  .validation-error {\n    text-align: center;\n    font-size: 0.7rem;\n    color: red;\n  }\n}\n","import {Component, h, Host, Prop, State, Element} from \"@stencil/core\";\nimport {cloneDeep, forEach, isNumber, isString} from \"lodash\";\nimport {popoverController, alertController} from \"@ionic/core\";\nimport {Activity} from \"../../../../interfaces/udive/diving-class/divingClass\";\nimport {TranslationService} from \"../../../../services/common/translations\";\nimport {DiveConfiguration} from \"../../../../interfaces/udive/planner/dive-configuration\";\nimport {UserService} from \"../../../../services/common/user\";\nimport {RouterService} from \"../../../../services/common/router\";\nimport {DivePlansService} from \"../../../../services/udive/divePlans\";\n\n@Component({\n  tag: \"popover-new-class-activity\",\n  styleUrl: \"popover-new-class-activity.scss\",\n})\nexport class PopoverNewClassActivity {\n  @Element() el: HTMLElement;\n  @Prop() activity: Activity;\n  @Prop() showDiveLocation: boolean = true;\n\n  @State() updateView = false;\n  @State() validActivity = false;\n  typeSelectOptions = [];\n  stdConfigurations: DiveConfiguration[] = [];\n\n  componentWillLoad() {\n    this.typeSelectOptions = [\n      {tag: \"theory\", text: TranslationService.getTransl(\"theory\", \"Theory\")},\n      {tag: \"dry\", text: TranslationService.getTransl(\"dry\", \"Dry\")},\n      {\n        tag: \"in-water\",\n        text: TranslationService.getTransl(\"in-water\", \"In Water\"),\n      },\n      {tag: \"dive\", text: TranslationService.getTransl(\"dive\", \"Dive\")},\n    ];\n    this.stdConfigurations = cloneDeep(\n      UserService.userSettings.userConfigurations\n    );\n    this.validateActivity();\n  }\n\n  validateActivity() {\n    this.validActivity =\n      isNumber(this.activity.day) &&\n      isString(this.activity.type) &&\n      isString(this.activity.title.tag) &&\n      isString(this.activity.title.text);\n    if (this.activity.type == \"dive\") {\n      this.validActivity =\n        this.validActivity && this.activity.divePlan !== null;\n    }\n    this.updateView = !this.updateView;\n  }\n\n  updateDay(day) {\n    this.activity.day = day;\n    this.validateActivity();\n  }\n  updateType(type) {\n    if (type != \"dive\" && this.activity.type == \"dive\") {\n      this.activity.divePlan = null;\n    }\n    this.activity.type = type;\n    this.validateActivity();\n  }\n  updateTitle(ev) {\n    let value = ev.detail.value;\n    if (ev.detail.name == \"tag\") {\n      value = value.toLowerCase().replace(\" \", \"-\").trim();\n    }\n    this.activity.title[ev.detail.name] = value;\n    this.validateActivity();\n  }\n\n  async addDivePlan() {\n    let inputs = [];\n    forEach(this.stdConfigurations, (conf, key) => {\n      inputs.push({\n        type: \"radio\",\n        label: conf.stdName,\n        value: key,\n        checked: key == 0 ? true : false,\n      });\n    });\n    const alert = await alertController.create({\n      header: TranslationService.getTransl(\n        \"select-standard-configuration\",\n        \"Select standard configuration\"\n      ),\n      buttons: [\n        {\n          text: TranslationService.getTransl(\"ok\", \"OK\"),\n          handler: async (data: any) => {\n            const openModal = await RouterService.openModal(\n              \"modal-dive-template\",\n              {\n                selectedConfiguration: this.stdConfigurations[data],\n                stdConfigurations: this.stdConfigurations,\n                dive: 0,\n                user: UserService.userProfile,\n              }\n            );\n            openModal.onDidDismiss().then((divePlan) => {\n              const dpModal = divePlan.data;\n              if (dpModal) {\n                this.activity.divePlan = dpModal;\n                this.validateActivity();\n                this.updateView = !this.updateView;\n              }\n            });\n          },\n        },\n        {\n          text: TranslationService.getTransl(\"cancel\", \"Cancel\"),\n          role: \"cancel\",\n          cssClass: \"secondary\",\n        },\n      ],\n      inputs: inputs,\n    });\n    alert.present();\n  }\n\n  async editDivePlan() {\n    const modal = await DivePlansService.presentDiveTemplateUpdate(\n      this.activity.divePlan,\n      0,\n      this.showDiveLocation\n    );\n    if (modal) {\n      this.activity.divePlan = modal;\n      this.updateView = !this.updateView;\n    }\n  }\n\n  async save() {\n    popoverController.dismiss(this.activity);\n  }\n\n  cancel() {\n    popoverController.dismiss();\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-toolbar>\n          <ion-title>\n            <my-transl tag=\"class-activity\" text=\"Class Activity\" />\n          </ion-title>\n        </ion-toolbar>\n        <ion-item>\n          <ion-label>\n            <my-transl tag=\"class-day\" text=\"Class Day\"></my-transl>\n          </ion-label>\n          <ion-select\n            value={this.activity.day}\n            onIonChange={(ev) => this.updateDay(ev.detail.value)}\n            interface=\"popover\"\n          >\n            <ion-select-option value={1}>1</ion-select-option>\n            <ion-select-option value={2}>2</ion-select-option>\n            <ion-select-option value={3}>3</ion-select-option>\n            <ion-select-option value={4}>4</ion-select-option>\n            <ion-select-option value={5}>5</ion-select-option>\n            <ion-select-option value={6}>6</ion-select-option>\n            <ion-select-option value={7}>7</ion-select-option>\n            <ion-select-option value={8}>8</ion-select-option>\n            <ion-select-option value={9}>9</ion-select-option>\n            <ion-select-option value={10}>10</ion-select-option>\n          </ion-select>\n        </ion-item>\n        <ion-item>\n          <ion-label>\n            <my-transl tag=\"type\" text=\"Type\"></my-transl>\n          </ion-label>\n          <ion-select\n            value={this.activity.type}\n            onIonChange={(ev) => this.updateType(ev.detail.value)}\n            interface=\"popover\"\n          >\n            {this.typeSelectOptions.map((option) => (\n              <ion-select-option value={option.tag}>\n                {option.text}\n              </ion-select-option>\n            ))}\n          </ion-select>\n        </ion-item>\n        <app-form-item\n          label-tag=\"unique-id\"\n          label-text=\"Unique ID\"\n          value={this.activity.title.tag}\n          name=\"tag\"\n          input-type=\"text\"\n          onFormItemChanged={(ev) => this.updateTitle(ev)}\n          validator={[\n            \"required\",\n            {\n              name: \"uniqueid\",\n              options: {type: null},\n            },\n          ]}\n        ></app-form-item>\n        <app-form-item\n          label-tag=\"title\"\n          label-text=\"Title\"\n          value={this.activity.title.text}\n          name=\"text\"\n          input-type=\"text\"\n          onFormItemChanged={(ev) => this.updateTitle(ev)}\n          validator={[\"required\"]}\n        ></app-form-item>\n        {this.activity.type == \"dive\" ? (\n          this.activity.divePlan ? (\n            <ion-item>\n              <ion-label>\n                {this.activity.divePlan.dives[0]\n                  .getDiveDetails()\n                  .map((detail) => (\n                    <p>{detail}</p>\n                  ))}\n              </ion-label>\n              <ion-button\n                icon-only\n                fill=\"clear\"\n                onClick={() => this.editDivePlan()}\n              >\n                <ion-icon name=\"create-outline\"></ion-icon>\n              </ion-button>\n            </ion-item>\n          ) : (\n            <ion-button expand=\"full\" onClick={() => this.addDivePlan()}>\n              Add Dive Plan\n            </ion-button>\n          )\n        ) : undefined}\n\n        <app-modal-footer\n          disableSave={!this.validActivity}\n          onCancelEmit={() => this.cancel()}\n          onSaveEmit={() => this.save()}\n        />\n      </Host>\n    );\n  }\n}\n"],"version":3}