{"file":"popover-edit-customer-owner.entry.esm.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAM,2BAA2B,GAAG,qFAAqF;;MCW5G,wBAAwB;;;;qBAEV,KAAK;0BAOR,KAAK;;IAE3B,iBAAiB;QACf,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;QAC9C,IAAI,CAAC,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;QACzC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC;QAC/C,IAAI,CAAC,UAAU,GAAG,gBAAgB,CAAC,iBAAiB,EAAE,CAAC;QACvD,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE;YACpC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CACvC,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CACvC,CAAC;YACF,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;;gBAEvB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;aAC1C;SACF;KACF;IAED,gBAAgB;QACd,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC;KACpC;IAED,eAAe;QACb,MAAM,kBAAkB,GACtB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;QACxC,MAAM,yBAAyB,GAAG;YAChC,MAAM,EAAE,kBAAkB,CAAC,SAAS,CAClC,IAAI,CAAC,KAAK,GAAG,gBAAgB,GAAG,gBAAgB,EAChD,IAAI,CAAC,KAAK,GAAG,gBAAgB,GAAG,gBAAgB,CACjD;SACF,CAAC;QACF,kBAAkB,CAAC,gBAAgB,GAAG,yBAAyB,CAAC;;QAEhE,MAAM,kBAAkB,GAAG,KAAK,CAAC,IAAI,CACnC,kBAAkB,CAAC,oBAAoB,CAAC,mBAAmB,CAAC,CAC7D,CAAC;QACF,kBAAkB,CAAC,GAAG,CAAC,CAAC,MAAM;YAC5B,kBAAkB,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;SACxC,CAAC,CAAC;QACH,kBAAkB,CAAC,WAAW,GAAG,kBAAkB,CAAC,SAAS,CAC3D,QAAQ,EACR,QAAQ,CACT,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,KAAK;YACxB,MAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;YACjE,YAAY,CAAC,KAAK,GAAG,KAAK,CAAC;YAC3B,YAAY,CAAC,WAAW,GAAG,KAAK,CAAC,SAAS,CAAC;YAC3C,kBAAkB,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;SAC9C,CAAC,CAAC;KACJ;IAED,YAAY,CAAC,EAAE;QACb,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;KACtC;IAED,YAAY,CAAC,EAAE;QACb,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;QACvC,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC;KACpC;IAED,KAAK;QACH,iBAAiB,CAAC,OAAO,EAAE,CAAC;KAC7B;IAED,IAAI;QACF,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAChD,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC;SAC1C;aAAM;YACL,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC;YAChD,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC;SACrD;QACD,IAAI,CAAC,KAAK,CAAC,kBAAkB,GAAG,IAAI,CAAC,SAAS,CAAC;QAC/C,iBAAiB,CAAC,OAAO,CAAC;YACxB,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,GAAG,EAAE,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC;SACvD,CAAC,CAAC;KACJ;IAED,MAAM;QACJ,QACE,EAAC,IAAI,uDACH,mEAAY,WAAW,UACrB,sEACE,yFAAyC,CAC7B,CACH,EACb,sEACE,iEAAU,KAAK,EAAC,MAAM,IACpB,mEACE,KAAK,EAAC,UAAU,EAChB,EAAE,EAAC,aAAa,EAChB,SAAS,EAAC,cAAc,EACxB,KAAK,EAAC,UAAU,qBACA,UAAU,EAC1B,QAAQ,EAAE,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAC3D,WAAW,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAC1C,KAAK,EAAE,IAAI,CAAC,aAAa,GACb,CACL,EACX,iGAAwD,EACxD,sEACE,KAAK,EAAC,MAAM,eACF,MAAM,gBACL,MAAM,EACjB,KAAK,EAAE,IAAI,CAAC,YAAY,EACxB,IAAI,EAAC,cAAc,gBACR,QAAQ,EACnB,iBAAiB,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,GACjC,EAChB,IAAI,CAAC,KAAK,IACT,qBACE,KAAK,EAAC,MAAM,eACF,YAAY,gBACX,kBAAkB,EAC7B,KAAK,EAAE,IAAI,CAAC,SAAS,EACrB,IAAI,EAAC,WAAW,gBACL,QAAQ,EACnB,iBAAiB,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,EAChD,SAAS,EAAE;gBACT;oBACE,IAAI,EAAE,aAAa;oBACnB,OAAO,EAAE,EAAC,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,EAAC;iBAC5B;aACF,GACc,IACf,SAAS,CACD,EACd,qEACE,yEACE,OAAO,EAAE,EAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAC,EAChC,YAAY,EAAE,MAAM,IAAI,CAAC,KAAK,EAAE,EAChC,UAAU,EAAE,MAAM,IAAI,CAAC,IAAI,EAAE,GAC7B,CACS,CACR,EACP;KACH;;;;;;;","names":[],"sources":["src/components/trasteel/popovers/popover-edit-customer-owner/popover-edit-customer-owner.scss?tag=popover-edit-customer-owner","src/components/trasteel/popovers/popover-edit-customer-owner/popover-edit-customer-owner.tsx"],"sourcesContent":["popover-edit-customer-owner {\n  /* Component styles go here */\n  ion-list {\n    min-height: 300px;\n  }\n}\n","import {Component, h, Host, Element, Prop, State} from \"@stencil/core\";\nimport {popoverController} from \"@ionic/core\";\nimport {CustomerGroup} from \"../../../../interfaces/trasteel/customer/customer\";\nimport {CustomersService} from \"../../../../services/trasteel/crm/customers\";\nimport {TranslationService} from \"../../../../services/common/translations\";\nimport {slugify} from \"../../../../helpers/utils\";\n\n@Component({\n  tag: \"popover-edit-customer-owner\",\n  styleUrl: \"popover-edit-customer-owner.scss\",\n})\nexport class PopoverEditCustomerEwner {\n  @Prop() owner: CustomerGroup;\n  @Prop() group: boolean = false;\n  @Element() el: HTMLElement;\n  selectedOwner: CustomerGroup;\n  newOwnerName: string;\n  sharePerc: number;\n  custGroups: CustomerGroup[];\n  popover: HTMLIonPopoverElement;\n  @State() updateView = false;\n\n  componentWillLoad() {\n    this.popover = this.el.closest(\"ion-popover\");\n    this.selectedOwner = new CustomerGroup();\n    this.sharePerc = this.owner.groupOwnershipPerc;\n    this.custGroups = CustomersService.getCustomerGroups();\n    if (this.owner && this.owner.groupId) {\n      this.selectedOwner = this.custGroups.find(\n        (x) => x.groupId == this.owner.groupId\n      );\n      if (!this.selectedOwner) {\n        //in case not found in the list\n        this.newOwnerName = this.owner.groupName;\n      }\n    }\n  }\n\n  componentDidLoad() {\n    this.setOwnersSelect();\n    this.updateView = !this.updateView;\n  }\n\n  setOwnersSelect() {\n    const selectOwnerElement: HTMLIonSelectElement =\n      this.el.querySelector(\"#selectOwner\");\n    const customOwnerPopoverOptions = {\n      header: TranslationService.getTransl(\n        this.group ? \"customer_group\" : \"customer_owner\",\n        this.group ? \"Customer Group\" : \"Customer Owner\"\n      ),\n    };\n    selectOwnerElement.interfaceOptions = customOwnerPopoverOptions;\n    //remove previously defined options\n    const selectOwnerOptions = Array.from(\n      selectOwnerElement.getElementsByTagName(\"ion-select-option\")\n    );\n    selectOwnerOptions.map((option) => {\n      selectOwnerElement.removeChild(option);\n    });\n    selectOwnerElement.placeholder = TranslationService.getTransl(\n      \"select\",\n      \"Select\"\n    );\n    this.custGroups.map((group) => {\n      const selectOption = document.createElement(\"ion-select-option\");\n      selectOption.value = group;\n      selectOption.textContent = group.groupName;\n      selectOwnerElement.appendChild(selectOption);\n    });\n  }\n\n  handleSelect(ev) {\n    this.selectedOwner = ev.detail.value;\n  }\n\n  handleChange(ev) {\n    this[ev.detail.name] = ev.detail.value;\n    this.updateView = !this.updateView;\n  }\n\n  close() {\n    popoverController.dismiss();\n  }\n\n  save() {\n    if (this.newOwnerName) {\n      this.owner.groupId = slugify(this.newOwnerName);\n      this.owner.groupName = this.newOwnerName;\n    } else {\n      this.owner.groupId = this.selectedOwner.groupId;\n      this.owner.groupName = this.selectedOwner.groupName;\n    }\n    this.owner.groupOwnershipPerc = this.sharePerc;\n    popoverController.dismiss({\n      owner: this.owner,\n      new: this.newOwnerName && this.newOwnerName.length > 0,\n    });\n  }\n\n  render() {\n    return (\n      <Host>\n        <ion-header translucent>\n          <ion-toolbar>\n            <ion-title>Select Owner/Group</ion-title>\n          </ion-toolbar>\n        </ion-header>\n        <ion-content>\n          <ion-item lines=\"none\">\n            <ion-select\n              color=\"trasteel\"\n              id=\"selectOwner\"\n              interface=\"action-sheet\"\n              label=\"Customer\"\n              label-placement=\"floating\"\n              disabled={this.newOwnerName && this.newOwnerName.length > 0}\n              onIonChange={(ev) => this.handleSelect(ev)}\n              value={this.selectedOwner}\n            ></ion-select>\n          </ion-item>\n          <ion-item-divider> - or insert new - </ion-item-divider>\n          <app-form-item\n            lines=\"none\"\n            label-tag=\"name\"\n            label-text=\"Name\"\n            value={this.newOwnerName}\n            name=\"newOwnerName\"\n            input-type=\"string\"\n            onFormItemChanged={(ev) => this.handleChange(ev)}\n          ></app-form-item>\n          {this.group ? (\n            <app-form-item\n              lines=\"full\"\n              label-tag=\"share_perc\"\n              label-text=\"Share Percentage\"\n              value={this.sharePerc}\n              name=\"sharePerc\"\n              input-type=\"number\"\n              onFormItemChanged={(ev) => this.handleChange(ev)}\n              validator={[\n                {\n                  name: \"minmaxvalue\",\n                  options: {min: 0, max: 100},\n                },\n              ]}\n            ></app-form-item>\n          ) : undefined}\n        </ion-content>\n        <ion-footer>\n          <app-modal-footer\n            saveTag={{tag: \"ok\", text: \"ok\"}}\n            onCancelEmit={() => this.close()}\n            onSaveEmit={() => this.save()}\n          />\n        </ion-footer>\n      </Host>\n    );\n  }\n}\n"],"version":3}