{"file":"page-diving-class-details.entry.esm.js","mappings":"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","names":[],"sources":["src/components/udive/pages/diving-class/page-diving-class-details/page-diving-class-details.scss?tag=page-diving-class-details","src/components/udive/pages/diving-class/page-diving-class-details/page-diving-class-details.tsx"],"sourcesContent":["page-diving-class-details {\n  ion-list {\n    width: 100%;\n  }\n  app-diving-class-schedule {\n    width: 100%;\n  }\n  ion-segment-button {\n    --color-checked: var(--ion-color-divingclass-contrast);\n  }\n}\n","import {Component, h, Prop, State, Element} from \"@stencil/core\";\nimport {Marker} from \"../../../../../interfaces/interfaces\";\nimport {RouterService} from \"../../../../../services/common/router\";\nimport {Subscription} from \"rxjs\";\nimport {UserService} from \"../../../../../services/common/user\";\nimport {\n  DivingClass,\n  Agency,\n} from \"../../../../../interfaces/udive/diving-class/divingClass\";\nimport {DivingClassesService} from \"../../../../../services/udive/divingClasses\";\nimport {SystemService} from \"../../../../../services/common/system\";\nimport {fabButtonTopMarginString} from \"../../../../../helpers/utils\";\nimport {MapDataDivingSchool} from \"../../../../../interfaces/udive/diving-school/divingSchool\";\nimport {\n  DivingSchoolsService,\n  DIVESCHOOLSSCOLLECTION,\n} from \"../../../../../services/udive/divingSchools\";\nimport {MapDataUserPubicProfile} from \"../../../../../interfaces/common/user/user-public-profile\";\nimport Swiper from \"swiper\";\nimport {TranslationService} from \"../../../../../services/common/translations\";\n\n@Component({\n  tag: \"page-diving-class-details\",\n  styleUrl: \"page-diving-class-details.scss\",\n})\nexport class PageDivingClassDetails {\n  @Element() el: HTMLElement;\n  @Prop() classid: string;\n  @State() divingClass: DivingClass;\n  @State() titles = [{tag: \"details\"}, {tag: \"schedule\"}, {tag: \"bookings\"}];\n  @State() slider: Swiper;\n  markers: Marker[] = [];\n  mapElement: HTMLAppMapElement;\n  userSub: Subscription;\n  @State() userId: string;\n  @State() selectedCourse: any;\n  @State() selectedAgency: Agency;\n  @State() selectedDivingSchool: MapDataDivingSchool;\n  @State() instructors: MapDataUserPubicProfile[];\n  statusTitles: {\n    active: string;\n    closed: string;\n    cancelled: string;\n  };\n\n  async componentWillLoad() {\n    this.userSub = UserService.userProfile$.subscribe((user) => {\n      this.userId = user && user.uid ? user.uid : null;\n    });\n    this.divingClass = await DivingClassesService.getDivingClass(this.classid);\n    this.userId =\n      UserService.userProfile && UserService.userProfile.uid\n        ? UserService.userProfile.uid\n        : null;\n\n    this.statusTitles = {\n      active: TranslationService.getTransl(\"active\", \"Active\"),\n      closed: TranslationService.getTransl(\"closed\", \"Closed\"),\n      cancelled: TranslationService.getTransl(\"cancelled\", \"Cancelled\"),\n    };\n\n    const divingCourses = await SystemService.getDivingCoursesForSchool();\n    //select diving class course\n    if (this.divingClass && this.divingClass.course) {\n      this.selectedCourse = divingCourses.find(\n        (course) =>\n          course.agencyId === this.divingClass.course.agencyId &&\n          course.id === this.divingClass.course.certificationId\n      );\n    }\n    this.selectedAgency = (await SystemService.getDivingAgencies())[\n      this.selectedCourse.agencyId\n    ];\n    if (this.divingClass.organiser.collectionId === DIVESCHOOLSSCOLLECTION)\n      this.selectedDivingSchool = DivingSchoolsService.getDivingSchoolDetails(\n        this.divingClass.organiser.id\n      );\n    this.instructors = [];\n    for (let userId of Object.keys(this.divingClass.users)) {\n      if (this.divingClass.users[userId].includes(\"instructor\")) {\n        this.instructors.push(await UserService.getMapDataUserDetails(userId));\n      }\n    }\n  }\n\n  async componentDidLoad() {\n    this.slider = new Swiper(\".slider-diving-class\", {\n      speed: 400,\n      spaceBetween: 100,\n      allowTouchMove: true,\n      autoHeight: true,\n    });\n  }\n\n  disconnectedCallback() {\n    this.userSub.unsubscribe();\n  }\n\n  render() {\n    return [\n      this.selectedCourse && this.selectedCourse.photoURL ? (\n        <ion-header>\n          <app-item-cover item={this.selectedCourse} />\n        </ion-header>\n      ) : undefined,\n      <ion-header>\n        <ion-toolbar\n          color=\"divingclass\"\n          class={\n            this.selectedCourse && this.selectedCourse.photoURL\n              ? \"no-safe-padding\"\n              : undefined\n          }\n        >\n          <ion-buttons slot=\"start\">\n            {!this.selectedCourse ? (\n              <ion-button onClick={() => RouterService.goBack()} icon-only>\n                <ion-icon name=\"arrow-back\"></ion-icon>\n              </ion-button>\n            ) : undefined}\n          </ion-buttons>\n          <ion-title>{this.divingClass.name}</ion-title>\n        </ion-toolbar>\n      </ion-header>,\n\n      <app-header-segment-toolbar\n        color=\"divingclass\"\n        swiper={this.slider}\n        titles={this.titles}\n      ></app-header-segment-toolbar>,\n      <ion-content class=\"slides\">\n        {this.selectedCourse && this.selectedCourse.coverURL ? (\n          <ion-fab\n            vertical=\"top\"\n            horizontal=\"start\"\n            slot=\"fixed\"\n            style={{marginTop: fabButtonTopMarginString(2)}}\n          >\n            <ion-fab-button\n              onClick={() => RouterService.goBack()}\n              class=\"fab-icon\"\n            >\n              <ion-icon name=\"arrow-back-circle-outline\"></ion-icon>\n            </ion-fab-button>\n          </ion-fab>\n        ) : undefined}\n        <swiper-container class=\"slider-diving-class swiper\">\n          <swiper-wrapper class=\"swiper-wrapper\">\n            <swiper-slide class=\"swiper-slide\">\n              <ion-list>\n                {this.selectedDivingSchool ? (\n                  <ion-item>\n                    <ion-avatar slot=\"start\">\n                      <img src={this.selectedDivingSchool.photoURL}></img>\n                    </ion-avatar>\n                    <ion-label>\n                      {this.selectedDivingSchool.displayName}\n                    </ion-label>\n                  </ion-item>\n                ) : undefined}\n                {this.selectedAgency ? (\n                  <ion-item>\n                    <ion-avatar slot=\"start\">\n                      <img src={this.selectedAgency.photoURL}></img>\n                    </ion-avatar>\n                    <ion-label>{this.selectedAgency.name}</ion-label>\n                  </ion-item>\n                ) : undefined}\n                {this.selectedCourse ? (\n                  <ion-item>\n                    <ion-avatar slot=\"start\">\n                      <img src={this.selectedCourse.photoURL}></img>\n                    </ion-avatar>\n                    <ion-label>{this.selectedCourse.name}</ion-label>\n                  </ion-item>\n                ) : undefined}\n                <ion-item>\n                  <ion-icon slot=\"start\" name=\"navigate-outline\"></ion-icon>\n                  <ion-label>\n                    {this.divingClass.location.display_name}\n                  </ion-label>\n                </ion-item>\n                <ion-item>\n                  <ion-icon slot=\"start\" name=\"scan-outline\"></ion-icon>\n                  <ion-label>\n                    <my-transl tag=\"status\" text=\"Status\"></my-transl>\n                  </ion-label>\n                  <ion-note slot=\"end\">\n                    {this.statusTitles[this.divingClass.status]}\n                  </ion-note>\n                </ion-item>\n                <ion-list-header>\n                  <my-transl tag=\"instructor\" text=\"Instructor\" />\n                </ion-list-header>\n                {this.instructors.map((instructor) => (\n                  <ion-item>\n                    {instructor.photoURL ? (\n                      <ion-avatar slot=\"start\">\n                        <img src={instructor.photoURL}></img>\n                      </ion-avatar>\n                    ) : (\n                      <ion-icon slot=\"start\" name=\"person\"></ion-icon>\n                    )}\n                    <ion-label>{instructor.displayName}</ion-label>\n                  </ion-item>\n                ))}\n                {this.divingClass.comments\n                  ? [\n                      <ion-list-header>\n                        <my-transl tag=\"comments\" text=\"Comments\" />\n                      </ion-list-header>,\n                      <ion-item>\n                        <ion-label class=\"ion-text-wrap\">\n                          {this.divingClass.comments}\n                        </ion-label>\n                      </ion-item>,\n                    ]\n                  : undefined}\n              </ion-list>\n            </swiper-slide>\n            <swiper-slide class=\"swiper-slide\">\n              <app-diving-class-schedule divingClass={this.divingClass} />\n            </swiper-slide>\n            <swiper-slide class=\"swiper-slide\">\n              <ion-grid>\n                <ion-row class=\"ion-text-start\">\n                  {!this.userId ? (\n                    <div\n                      style={{\n                        marginTop: \"10%\",\n                        marginLeft: \"auto\",\n                        marginRight: \"auto\",\n                      }}\n                    >\n                      <ion-card>\n                        <ion-card-header>\n                          <ion-card-title>\n                            <my-transl\n                              tag=\"please-login\"\n                              text=\"Please login to view this page\"\n                            />\n                          </ion-card-title>\n                        </ion-card-header>\n                      </ion-card>\n                    </div>\n                  ) : (\n                    <app-dive-class-bookings\n                      divingClass={this.divingClass}\n                      divingClassId={this.classid}\n                    />\n                  )}\n                </ion-row>\n              </ion-grid>\n            </swiper-slide>\n          </swiper-wrapper>\n        </swiper-container>\n      </ion-content>,\n    ];\n  }\n}\n"],"version":3}